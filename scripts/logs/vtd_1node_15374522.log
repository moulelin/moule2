+ source /anvil/scratch/x-qlan1/moule/train-env/bin/activate
++ '[' -z '' ']'
++ '[' -n x ']'
++ SCRIPT_PATH=/anvil/scratch/x-qlan1/moule/train-env/bin/activate
++ '[' /anvil/scratch/x-qlan1/moule/train-env/bin/activate = /var/spool/slurm/job15374522/slurm_script ']'
++ deactivate nondestructive
++ unset -f pydoc
++ '[' -z '' ']'
++ '[' -z '' ']'
++ hash -r
++ '[' -z '' ']'
++ unset VIRTUAL_ENV
++ unset VIRTUAL_ENV_PROMPT
++ '[' '!' nondestructive = nondestructive ']'
++ VIRTUAL_ENV=/anvil/scratch/x-qlan1/moule/train-env
++ '[' linux-gnu = cygwin ']'
++ '[' linux-gnu = msys ']'
++ export VIRTUAL_ENV
++ '[' -z '' ']'
++ unset SCRIPT_PATH
++ _OLD_VIRTUAL_PATH=/home/x-qlan1/.vscode-server/data/User/globalStorage/github.copilot-chat/debugCommand:/home/x-qlan1/.vscode-server/data/User/globalStorage/github.copilot-chat/copilotCli:/home/x-qlan1/.vscode-server/cli/servers/Stable-c3a26841a84f20dfe0850d0a5a9bd01da4f003ea/server/bin/remote-cli:/home/x-qlan1/miniconda3/bin:/home/x-qlan1/miniconda3/condabin:/apps/anvil/external/apps/xalt2/xalt/xalt/bin:/apps/spack/anvil/apps/openmpi/4.0.6-gcc-11.2.0-3navcwb/bin:/apps/spack/anvil/apps/numactl/2.0.14-gcc-11.2.0-wrjotmv/bin:/apps/spack/anvil/apps/libfabric/1.12.0-gcc-8.4.1-xj6lmd4/bin:/apps/spack/anvil/apps/gcc/11.2.0-gcc-8.4.1-qjtdkvs/bin:/home/x-qlan1/bin:/home/x-qlan1/.local/bin:/usr/libexec/gsissh/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/usr/site/rcac/sbin:/usr/site/rcac/bin:/usr/site/rcac/scripts:/opt/thinlinc/bin:/opt/thinlinc/sbin:/home/x-qlan1/.vscode-server/extensions/ms-python.debugpy-2025.18.0-linux-x64/bundled/scripts/noConfigScripts
++ PATH=/anvil/scratch/x-qlan1/moule/train-env/bin:/home/x-qlan1/.vscode-server/data/User/globalStorage/github.copilot-chat/debugCommand:/home/x-qlan1/.vscode-server/data/User/globalStorage/github.copilot-chat/copilotCli:/home/x-qlan1/.vscode-server/cli/servers/Stable-c3a26841a84f20dfe0850d0a5a9bd01da4f003ea/server/bin/remote-cli:/home/x-qlan1/miniconda3/bin:/home/x-qlan1/miniconda3/condabin:/apps/anvil/external/apps/xalt2/xalt/xalt/bin:/apps/spack/anvil/apps/openmpi/4.0.6-gcc-11.2.0-3navcwb/bin:/apps/spack/anvil/apps/numactl/2.0.14-gcc-11.2.0-wrjotmv/bin:/apps/spack/anvil/apps/libfabric/1.12.0-gcc-8.4.1-xj6lmd4/bin:/apps/spack/anvil/apps/gcc/11.2.0-gcc-8.4.1-qjtdkvs/bin:/home/x-qlan1/bin:/home/x-qlan1/.local/bin:/usr/libexec/gsissh/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/puppetlabs/bin:/usr/site/rcac/sbin:/usr/site/rcac/bin:/usr/site/rcac/scripts:/opt/thinlinc/bin:/opt/thinlinc/sbin:/home/x-qlan1/.vscode-server/extensions/ms-python.debugpy-2025.18.0-linux-x64/bundled/scripts/noConfigScripts
++ export PATH
++ '[' x '!=' x ']'
+++ basename /anvil/scratch/x-qlan1/moule/train-env
++ VIRTUAL_ENV_PROMPT=train-env
++ export VIRTUAL_ENV_PROMPT
++ '[' -z '' ']'
++ '[' -z '' ']'
++ _OLD_VIRTUAL_PS1=
++ PS1='(train-env) '
++ export PS1
++ alias pydoc
++ true
++ hash -r
+ PROJECT_DIR=/home/x-qlan1/code/moule2
+ OPENRLHF_DIR=/home/x-qlan1/code/moule2/OpenRLHF
+ SCRATCH=/anvil/scratch/x-qlan1/moule
+ export HF_HOME=/anvil/scratch/x-qlan1/moule/hf_cache
+ HF_HOME=/anvil/scratch/x-qlan1/moule/hf_cache
+ export HF_DATASETS_CACHE=/anvil/scratch/x-qlan1/moule/hf_cache/datasets
+ HF_DATASETS_CACHE=/anvil/scratch/x-qlan1/moule/hf_cache/datasets
+ export TRANSFORMERS_CACHE=/anvil/scratch/x-qlan1/moule/hf_cache
+ TRANSFORMERS_CACHE=/anvil/scratch/x-qlan1/moule/hf_cache
+ export TORCH_HOME=/anvil/scratch/x-qlan1/moule/torch_cache
+ TORCH_HOME=/anvil/scratch/x-qlan1/moule/torch_cache
+ export WANDB_DIR=/anvil/scratch/x-qlan1/moule/wandb
+ WANDB_DIR=/anvil/scratch/x-qlan1/moule/wandb
+ export WANDB_CACHE_DIR=/anvil/scratch/x-qlan1/moule/wandb/.cache
+ WANDB_CACHE_DIR=/anvil/scratch/x-qlan1/moule/wandb/.cache
+ export LD_PRELOAD=/home/x-qlan1/miniconda3/lib/libstdc++.so.6
+ LD_PRELOAD=/home/x-qlan1/miniconda3/lib/libstdc++.so.6
+ export NCCL_SOCKET_IFNAME=ib1
+ NCCL_SOCKET_IFNAME=ib1
+ TRAIN_DATA=/home/x-qlan1/code/moule2/teacher_uncertainty_each-sample/dataset_output/evolved_with_se.jsonl
+ ray stop --force
2026-02-21 20:54:43,097	INFO scripts.py:1334 -- Did not find any active Ray processes.
+ sleep 3
+ ray start --head --num-gpus=4
2026-02-21 20:54:47,486	INFO usage_lib.py:472 -- Usage stats collection is enabled. To disable this, add `--disable-usage-stats` to the command that starts the cluster, or run the following command: `ray disable-usage-stats` before starting the cluster. See https://docs.ray.io/en/master/cluster/usage-stats.html for more details.
2026-02-21 20:54:47,486	INFO scripts.py:913 -- [37mLocal node IP[39m: [1m172.18.92.74[22m
2026-02-21 20:54:55,161	SUCC scripts.py:949 -- [32m--------------------[39m
2026-02-21 20:54:55,162	SUCC scripts.py:950 -- [32mRay runtime started.[39m
2026-02-21 20:54:55,162	SUCC scripts.py:951 -- [32m--------------------[39m
2026-02-21 20:54:55,162	INFO scripts.py:953 -- [36mNext steps[39m
2026-02-21 20:54:55,162	INFO scripts.py:956 -- To add another node to this Ray cluster, run
2026-02-21 20:54:55,162	INFO scripts.py:959 -- [1m  ray start --address='172.18.92.74:6379'[22m
2026-02-21 20:54:55,162	INFO scripts.py:968 -- To connect to this Ray cluster:
2026-02-21 20:54:55,162	INFO scripts.py:970 -- [35mimport[39m[26m ray
2026-02-21 20:54:55,162	INFO scripts.py:971 -- ray[35m.[39m[26minit()
2026-02-21 20:54:55,162	INFO scripts.py:983 -- To submit a Ray job using the Ray Jobs CLI:
2026-02-21 20:54:55,162	INFO scripts.py:984 -- [1m  RAY_ADDRESS='http://127.0.0.1:8265' ray job submit --working-dir . -- python my_script.py[22m
2026-02-21 20:54:55,162	INFO scripts.py:993 -- See https://docs.ray.io/en/latest/cluster/running-applications/job-submission/index.html 
2026-02-21 20:54:55,162	INFO scripts.py:997 -- for more information on submitting Ray jobs to the Ray cluster.
2026-02-21 20:54:55,162	INFO scripts.py:1002 -- To terminate the Ray runtime, run
2026-02-21 20:54:55,162	INFO scripts.py:1003 -- [1m  ray stop[22m
2026-02-21 20:54:55,162	INFO scripts.py:1006 -- To view the status of the cluster, use
2026-02-21 20:54:55,162	INFO scripts.py:1007 --   [1mray status[22m[26m
2026-02-21 20:54:55,162	INFO scripts.py:1011 -- To monitor and debug Ray, view the dashboard at 
2026-02-21 20:54:55,162	INFO scripts.py:1012 --   [1m127.0.0.1:8265[22m[26m
2026-02-21 20:54:55,162	INFO scripts.py:1019 -- [4mIf connection to the dashboard fails, check your firewall settings and network configuration.[24m
+ sleep 10
++ seq 1 30
+ for i in $(seq 1 30)
+ ray status
+ echo 'Ray is ready.'
Ray is ready.
+ break
+ ray status
======== Autoscaler status: 2026-02-21 20:55:03.652973 ========
Node status
---------------------------------------------------------------
Active:
 1 node_58c985c54cc8dd76d1a3569c36dc2174236aa61aab89e20372a6b9a3
Pending:
 (no pending nodes)
Recent failures:
 (no failures)

Resources
---------------------------------------------------------------
Total Usage:
 0.0/96.0 CPU
 0.0/4.0 GPU
 0B/794.10GiB memory
 0B/186.26GiB object_store_memory

Total Constraints:
 (no request_resources() constraints)
Total Demands:
 (no resource demands)
+ ray job submit --address=http://127.0.0.1:8265 '--runtime-env-json={"working_dir": "/home/x-qlan1/code/moule2/OpenRLHF", "excludes": ["/checkpoints/", "/.git/", "/logs/"], "env_vars": {"TOKENIZERS_PARALLELISM": "true", "LD_PRELOAD": "/home/x-qlan1/miniconda3/lib/libstdc++.so.6", "HF_HOME": "/anvil/scratch/x-qlan1/moule/hf_cache", "HF_DATASETS_CACHE": "/anvil/scratch/x-qlan1/moule/hf_cache/datasets", "TRANSFORMERS_CACHE": "/anvil/scratch/x-qlan1/moule/hf_cache", "TORCH_HOME": "/anvil/scratch/x-qlan1/moule/torch_cache", "WANDB_DIR": "/anvil/scratch/x-qlan1/moule/wandb", "WANDB_CACHE_DIR": "/anvil/scratch/x-qlan1/moule/wandb/.cache", "VLLM_TARGET_DEVICE": "cuda"}}' -- python3 -m openrlhf.cli.train_vtd_ray --pretrain Qwen/Qwen3-1.7B --teacher_model Qwen/Qwen3-8B --student_num_nodes 1 --student_num_gpus_per_node 4 --teacher_num_nodes 1 --teacher_num_gpus_per_node 4 --colocate_all_models --vllm_num_engines 4 --vllm_tensor_parallel_size 1 --vllm_gpu_memory_utilization 0.8 --vllm_enable_sleep --vllm_sync_backend nccl --prompt_data /home/x-qlan1/code/moule2/teacher_uncertainty_each-sample/dataset_output/evolved_with_se.jsonl --prompt_split train --input_key question --se_weight_key se_weight --apply_chat_template --enable_thinking --num_shots 0 --max_input_len 1024 --generate_max_len 2048 --max_samples 50000 --n_samples_per_prompt 4 --distill_topk 512 --temperature 0.9 --top_p 0.95 --zero_stage 1 --deepspeed_enable_sleep --packing_samples --param_dtype bf16 --attn_implementation flash_attention_2 --gradient_checkpointing --micro_train_batch_size 4 --train_batch_size 128 --rollout_batch_size 256 --num_episodes 1 --max_epochs 1 --actor_learning_rate 3e-6 --lr_warmup_ratio 0.05 --lr_scheduler cosine_with_min_lr --adam_betas 0.9 0.95 --max_norm 1.0 --save_path /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved --ckpt_path /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints --save_steps 3 --eval_batch_size 660 --save_hf_ckpt --logging_steps 1 --eval_steps 1 --eval_dataset openai/gsm8k --eval_split test --eval_input_key question --eval_num_shots 4 --eval_max_tokens 2048 --use_wandb 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 --wandb_project vtd_reasoning --wandb_run_name vtd_1node_qwen3_1.7b --log_dir ./logs/vtd_ray_1node --seed 42
2026-02-21 20:55:09,504	INFO dashboard_sdk.py:338 -- Uploading package gcs://_ray_pkg_70f881c00ed1028c.zip.
2026-02-21 20:55:09,504	INFO packaging.py:588 -- Creating a file package for local module '/home/x-qlan1/code/moule2/OpenRLHF'.
2026-02-21 20:55:09,426	INFO cli.py:41 -- [37mJob submission server address[39m: [1mhttp://127.0.0.1:8265[22m
2026-02-21 20:55:40,079	SUCC cli.py:65 -- [32m-------------------------------------------------------[39m
2026-02-21 20:55:40,079	SUCC cli.py:66 -- [32mJob 'raysubmit_JAwrBx2JJpMXybW1' submitted successfully[39m
2026-02-21 20:55:40,079	SUCC cli.py:67 -- [32m-------------------------------------------------------[39m
2026-02-21 20:55:40,079	INFO cli.py:291 -- [36mNext steps[39m
2026-02-21 20:55:40,079	INFO cli.py:292 -- Query the logs of the job:
2026-02-21 20:55:40,079	INFO cli.py:294 -- [1mray job logs raysubmit_JAwrBx2JJpMXybW1[22m
2026-02-21 20:55:40,079	INFO cli.py:296 -- Query the status of the job:
2026-02-21 20:55:40,079	INFO cli.py:298 -- [1mray job status raysubmit_JAwrBx2JJpMXybW1[22m
2026-02-21 20:55:40,079	INFO cli.py:300 -- Request the job to be stopped:
2026-02-21 20:55:40,079	INFO cli.py:302 -- [1mray job stop raysubmit_JAwrBx2JJpMXybW1[22m
2026-02-21 20:55:40,084	INFO cli.py:312 -- Tailing logs until the job exits (disable with --no-wait):
2026-02-21 20:55:39,538	INFO job_manager.py:531 -- Runtime env is setting up.
/tmp/ray/session_2026-02-21_20-54-47_487652_831283/runtime_resources/working_dir_files/_ray_pkg_70f881c00ed1028c/openrlhf/utils/math_utils.py:92: SyntaxWarning: invalid escape sequence '\%'
  string = string.replace("\%", "")
/anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
/anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
Warning: The cache directory for DeepSpeed Triton autotune, /home/x-qlan1/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
/tmp/ray/session_2026-02-21_20-54-47_487652_831283/runtime_resources/working_dir_files/_ray_pkg_70f881c00ed1028c/openrlhf/trainer/vtd_trainer_ray.py:134: SyntaxWarning: invalid escape sequence '\%'
  string = string.replace("\\%", "").replace("\%", "").replace("%", "")
2026-02-21 20:56:13,394	INFO worker.py:1606 -- Using address 172.18.92.74:6379 set in the environment variable RAY_ADDRESS
2026-02-21 20:56:13,405	INFO worker.py:1747 -- Connecting to existing Ray cluster at address: 172.18.92.74:6379...
2026-02-21 20:56:13,513	INFO worker.py:1918 -- Connected to Ray cluster. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
Namespace(student_num_nodes=1, student_num_gpus_per_node=4, teacher_num_nodes=1, teacher_num_gpus_per_node=4, colocate_all_models=True, vllm_num_engines=4, vllm_tensor_parallel_size=1, vllm_sync_backend='nccl', vllm_sync_with_ray=False, enable_prefix_caching=False, enforce_eager=False, vllm_enable_sleep=True, vllm_gpu_memory_utilization=0.8, save_path='/anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved', save_steps=3, save_hf_ckpt=True, disable_ds_ckpt=False, logging_steps=1, eval_steps=1, eval_batch_size=660, ckpt_path='/anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints', max_ckpt_num=3, max_ckpt_mem=100000000.0, load_checkpoint=False, use_ds_universal_ckpt=False, local_rank=-1, zero_stage=1, gradient_checkpointing=True, deepcompile=False, param_dtype='bf16', zpg=1, adam_offload=False, attn_implementation='flash_attention_2', use_liger_kernel=False, aux_loss_coef=0, grad_accum_dtype=None, overlap_comm=False, gradient_checkpointing_use_reentrant=False, disable_fast_tokenizer=False, deepspeed_enable_sleep=True, ds_tensor_parallel_size=1, ref_reward_offload=False, seed=42, full_determinism=False, load_in_4bit=False, lora_rank=0, lora_alpha=16, target_modules='all-linear', lora_dropout=0, pretrain='Qwen/Qwen3-1.7B', teacher_model='Qwen/Qwen3-8B', normalize_reward=False, value_head_prefix='score', num_episodes=1, max_epochs=1, rollout_batch_size=256, micro_train_batch_size=4, train_batch_size=128, max_norm=1.0, l2=0.0, actor_learning_rate=3e-06, lr_warmup_ratio=0.05, lr_scheduler='cosine_with_min_lr', adam_betas=[0.9, 0.95], max_input_len=1024, generate_max_len=2048, temperature=0.9, top_p=0.95, n_samples_per_prompt=4, max_samples=50000, vtd_distill_alpha=5.0, vtd_distill_tau=1.0, se_n_samples=8, se_cluster_model='Qwen/Qwen2.5-0.5B-Instruct', se_weight_key='se_weight', teacher_micro_batch_size=2, distill_topk=512, prompt_data='/home/x-qlan1/code/moule2/teacher_uncertainty_each-sample/dataset_output/evolved_with_se.jsonl', prompt_data_probs=None, prompt_split='train', eval_dataset='openai/gsm8k', eval_split='test', eval_input_key='question', eval_num_shots=4, eval_max_tokens=2048, input_key='question', label_key='answer', output_key=None, input_template=None, apply_chat_template=True, enable_thinking=True, packing_samples=True, num_shots=0, use_wandb='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', wandb_org=None, wandb_group=None, wandb_project='vtd_reasoning', wandb_run_name='vtd_1node_qwen3_1.7b', use_tensorboard=None, log_dir='./logs/vtd_ray_1node', use_ms=False)
[36m(pid=842165)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=842165)[0m   import pynvml  # type: ignore[import]
[36m(pid=842165)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
[36m(pid=842165)[0m   warnings.warn(
[36m(pid=842166)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=842166)[0m   import pynvml  # type: ignore[import][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m INFO 02-21 20:56:51 [__init__.py:216] Automatically detected platform cuda.
[36m(LLMRayActor pid=842165)[0m INFO 02-21 20:57:12 [utils.py:233] non-default args: {'trust_remote_code': True, 'dtype': 'bfloat16', 'seed': 42, 'max_model_len': 6144, 'distributed_executor_backend': 'uni', 'enable_prefix_caching': False, 'gpu_memory_utilization': 0.8, 'disable_log_stats': True, 'worker_extension_cls': 'openrlhf.trainer.ray.vllm_worker_wrap.WorkerWrap', 'generation_config': 'vllm', 'enable_sleep_mode': True, 'model': 'Qwen/Qwen3-1.7B'}
[36m(LLMRayActor pid=842166)[0m INFO 02-21 20:56:51 [__init__.py:216] Automatically detected platform cuda.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
[36m(pid=842166)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.[32m [repeated 3x across cluster][0m
[36m(pid=842166)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m INFO 02-21 20:57:13 [model.py:547] Resolved architecture: Qwen3ForCausalLM
[36m(LLMRayActor pid=842165)[0m INFO 02-21 20:57:13 [model.py:1510] Using max model len 6144
[36m(LLMRayActor pid=842165)[0m INFO 02-21 20:57:13 [arg_utils.py:1215] Using ray runtime env: {'working_dir': 'gcs://_ray_pkg_70f881c00ed1028c.zip', 'env_vars': {'HF_DATASETS_CACHE': '/anvil/scratch/x-qlan1/moule/hf_cache/datasets', 'HF_HOME': '/anvil/scratch/x-qlan1/moule/hf_cache', 'LD_PRELOAD': '/home/x-qlan1/miniconda3/lib/libstdc++.so.6', 'TOKENIZERS_PARALLELISM': 'true', 'TORCH_HOME': '/anvil/scratch/x-qlan1/moule/torch_cache', 'TRANSFORMERS_CACHE': '/anvil/scratch/x-qlan1/moule/hf_cache', 'VLLM_TARGET_DEVICE': 'cuda', 'WANDB_CACHE_DIR': '/anvil/scratch/x-qlan1/moule/wandb/.cache', 'WANDB_DIR': '/anvil/scratch/x-qlan1/moule/wandb'}}
[36m(LLMRayActor pid=842165)[0m INFO 02-21 20:57:13 [scheduler.py:205] Chunked prefill is enabled with max_num_batched_tokens=16384.
[36m(LLMRayActor pid=842165)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(LLMRayActor pid=842165)[0m WARNING 02-21 20:57:15 [serial_utils.py:51] Allowing insecure serialization using pickle due to VLLM_ALLOW_INSECURE_SERIALIZATION=1
[36m(LLMRayActor pid=842165)[0m WARNING 02-21 20:57:15 [__init__.py:3036] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/usage/troubleshooting.html#python-multiprocessing for more information. Reasons: In a Ray actor and can only be spawned; CUDA is initialized
[36m(LLMRayActor pid=842165)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(LLMRayActor pid=842165)[0m   import pynvml  # type: ignore[import]
[36m(LLMRayActor pid=842166)[0m The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
[36m(LLMRayActor pid=842165)[0m   warnings.warn(
[36m(LLMRayActor pid=842166)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m   import pynvml  # type: ignore[import][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m INFO 02-21 20:57:12 [utils.py:233] non-default args: {'trust_remote_code': True, 'dtype': 'bfloat16', 'seed': 45, 'max_model_len': 6144, 'distributed_executor_backend': 'uni', 'enable_prefix_caching': False, 'gpu_memory_utilization': 0.8, 'disable_log_stats': True, 'worker_extension_cls': 'openrlhf.trainer.ray.vllm_worker_wrap.WorkerWrap', 'generation_config': 'vllm', 'enable_sleep_mode': True, 'model': 'Qwen/Qwen3-1.7B'}[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m INFO 02-21 20:57:56 [__init__.py:216] Automatically detected platform cuda.
[36m(LLMRayActor pid=842166)[0m INFO 02-21 20:57:13 [model.py:547] Resolved architecture: Qwen3ForCausalLM[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m INFO 02-21 20:57:13 [model.py:1510] Using max model len 6144[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m INFO 02-21 20:57:13 [arg_utils.py:1215] Using ray runtime env: {'working_dir': 'gcs://_ray_pkg_70f881c00ed1028c.zip', 'env_vars': {'HF_DATASETS_CACHE': '/anvil/scratch/x-qlan1/moule/hf_cache/datasets', 'HF_HOME': '/anvil/scratch/x-qlan1/moule/hf_cache', 'LD_PRELOAD': '/home/x-qlan1/miniconda3/lib/libstdc++.so.6', 'TOKENIZERS_PARALLELISM': 'true', 'TORCH_HOME': '/anvil/scratch/x-qlan1/moule/torch_cache', 'TRANSFORMERS_CACHE': '/anvil/scratch/x-qlan1/moule/hf_cache', 'VLLM_TARGET_DEVICE': 'cuda', 'WANDB_CACHE_DIR': '/anvil/scratch/x-qlan1/moule/wandb/.cache', 'WANDB_DIR': '/anvil/scratch/x-qlan1/moule/wandb'}}[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m INFO 02-21 20:57:13 [scheduler.py:205] Chunked prefill is enabled with max_num_batched_tokens=16384.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m WARNING 02-21 20:57:15 [serial_utils.py:51] Allowing insecure serialization using pickle due to VLLM_ALLOW_INSECURE_SERIALIZATION=1[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m WARNING 02-21 20:57:15 [__init__.py:3036] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/usage/troubleshooting.html#python-multiprocessing for more information. Reasons: In a Ray actor and can only be spawned; CUDA is initialized[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m INFO 02-21 20:57:56 [__init__.py:216] Automatically detected platform cuda.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:04 [core.py:644] Waiting for init message from front-end.
[36m(LLMRayActor pid=842166)[0m INFO 02-21 20:57:56 [__init__.py:216] Automatically detected platform cuda.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:05 [core.py:77] Initializing a V1 LLM engine (v0.11.0) with config: model='Qwen/Qwen3-1.7B', speculative_config=None, tokenizer='Qwen/Qwen3-1.7B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=42, served_model_name=Qwen/Qwen3-1.7B, enable_prefix_caching=False, chunked_prefill_enabled=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2","vllm.mamba_mixer","vllm.short_conv","vllm.linear_attention","vllm.plamo2_mamba_mixer","vllm.gdn_attention","vllm.sparse_attn_indexer"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"cudagraph_mode":[2,1],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"use_inductor_graph_partition":false,"pass_config":{},"max_capture_size":512,"local_cache_dir":null}
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m W0221 20:58:14.047000 842698 torch/utils/cpp_extension.py:2425] TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m W0221 20:58:14.047000 842698 torch/utils/cpp_extension.py:2425] If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'] to specific architectures.
[36m(LLMRayActor pid=842166)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:17 [worker_base.py:243] Injected <class 'openrlhf.trainer.ray.vllm_worker_wrap.WorkerWrap'> into <class 'vllm.v1.worker.gpu_worker.Worker'> for extended collective_rpc calls ['init_process_group', 'update_weight', 'update_weight_cuda_ipc']
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:04 [core.py:644] Waiting for init message from front-end.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:05 [core.py:77] Initializing a V1 LLM engine (v0.11.0) with config: model='Qwen/Qwen3-1.7B', speculative_config=None, tokenizer='Qwen/Qwen3-1.7B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=45, served_model_name=Qwen/Qwen3-1.7B, enable_prefix_caching=False, chunked_prefill_enabled=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2","vllm.mamba_mixer","vllm.short_conv","vllm.linear_attention","vllm.plamo2_mamba_mixer","vllm.gdn_attention","vllm.sparse_attn_indexer"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"cudagraph_mode":[2,1],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"use_inductor_graph_partition":false,"pass_config":{},"max_capture_size":512,"local_cache_dir":null}[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(LLMRayActor pid=842165)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(LLMRayActor pid=842165)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(LLMRayActor pid=842165)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(LLMRayActor pid=842165)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(LLMRayActor pid=842165)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:18 [parallel_state.py:1208] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:19 [topk_topp_sampler.py:55] Using FlashInfer for top-p & top-k sampling.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:20 [gpu_model_runner.py:2602] Starting to load model Qwen/Qwen3-1.7B...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:22 [gpu_model_runner.py:2634] Loading model from scratch...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:17 [worker_base.py:243] Injected <class 'openrlhf.trainer.ray.vllm_worker_wrap.WorkerWrap'> into <class 'vllm.v1.worker.gpu_worker.Worker'> for extended collective_rpc calls ['init_process_group', 'update_weight', 'update_weight_cuda_ipc'][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:22 [cuda.py:366] Using Flash Attention backend on V1 engine.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:23 [weight_utils.py:392] Using model weights format ['*.safetensors']
[36m(LLMRayActor pid=842166)[0m [Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0[32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:18 [parallel_state.py:1208] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m W0221 20:58:14.049000 842704 torch/utils/cpp_extension.py:2425] TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. [32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m W0221 20:58:14.049000 842704 torch/utils/cpp_extension.py:2425] If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'] to specific architectures.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:10<00:00,  5.12s/it]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:10<00:00,  5.12s/it]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 20:58:34 [default_loader.py:267] Loading weights took 10.25 seconds
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:19 [topk_topp_sampler.py:55] Using FlashInfer for top-p & top-k sampling.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:20 [gpu_model_runner.py:2602] Starting to load model Qwen/Qwen3-1.7B...[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:22 [gpu_model_runner.py:2634] Loading model from scratch...[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 20:58:22 [cuda.py:366] Using Flash Attention backend on V1 engine.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:24 [weight_utils.py:392] Using model weights format ['*.safetensors'][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 20:58:37 [gpu_model_runner.py:2653] Model loading took 3.2152 GiB and 12.030462 seconds
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:07 [backends.py:548] Using cache directory: /home/x-qlan1/.cache/vllm/torch_compile_cache/25ed2ce094/rank_0_0/backbone for vLLM's torch.compile
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:07 [backends.py:559] Dynamo bytecode transform time: 28.98 s
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:58:34 [default_loader.py:267] Loading weights took 10.42 seconds[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:58:37 [gpu_model_runner.py:2653] Model loading took 3.2152 GiB and 12.039701 seconds[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:19 [backends.py:164] Directly load the compiled graph(s) for dynamic shape from the cache, took 8.460 s
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:07 [backends.py:548] Using cache directory: /home/x-qlan1/.cache/vllm/torch_compile_cache/25ed2ce094/rank_0_0/backbone for vLLM's torch.compile[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:08 [backends.py:559] Dynamo bytecode transform time: 28.98 s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:23 [monitor.py:34] torch.compile takes 28.98 s in total
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:25 [gpu_worker.py:298] Available KV cache memory: 57.86 GiB
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:19 [backends.py:164] Directly load the compiled graph(s) for dynamic shape from the cache, took 8.479 s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:27 [kv_cache_utils.py:1087] GPU KV cache size: 541,712 tokens
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:27 [kv_cache_utils.py:1091] Maximum concurrency for 6,144 tokens per request: 88.17x
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 2026-02-21 20:59:28,029 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:09<00:00,  4.95s/it][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 2026-02-21 20:59:28,130 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:23 [monitor.py:34] torch.compile takes 28.98 s in total[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m All deep_gemm operations loaded successfully!
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/67 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   1%|â–         | 1/67 [00:00<00:14,  4.69it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   3%|â–Ž         | 2/67 [00:00<00:10,  6.32it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   4%|â–         | 3/67 [00:00<00:10,  5.88it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   6%|â–Œ         | 4/67 [00:00<00:09,  6.51it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   7%|â–‹         | 5/67 [00:00<00:09,  6.66it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   9%|â–‰         | 6/67 [00:00<00:09,  6.76it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  10%|â–ˆ         | 7/67 [00:01<00:08,  7.01it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  12%|â–ˆâ–        | 8/67 [00:01<00:09,  6.32it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  13%|â–ˆâ–Ž        | 9/67 [00:01<00:09,  6.16it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  15%|â–ˆâ–        | 10/67 [00:01<00:10,  5.42it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  16%|â–ˆâ–‹        | 11/67 [00:01<00:09,  5.90it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  18%|â–ˆâ–Š        | 12/67 [00:01<00:08,  6.23it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  19%|â–ˆâ–‰        | 13/67 [00:02<00:09,  5.93it/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:28 [gpu_worker.py:298] Available KV cache memory: 57.86 GiB[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  21%|â–ˆâ–ˆ        | 14/67 [00:02<00:08,  6.06it/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:30 [kv_cache_utils.py:1087] GPU KV cache size: 541,712 tokens[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:30 [kv_cache_utils.py:1091] Maximum concurrency for 6,144 tokens per request: 88.17x[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 2026-02-21 20:59:30,955 - INFO - autotuner.py:256 - flashinfer.jit: [Autotuner]: Autotuning process starts ...[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 2026-02-21 20:59:31,046 - INFO - autotuner.py:262 - flashinfer.jit: [Autotuner]: Autotuning process ends[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):   0%|          | 0/67 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  22%|â–ˆâ–ˆâ–       | 15/67 [00:02<00:08,  5.96it/s][32m [repeated 61x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 44/67 [00:08<00:04,  5.09it/s][32m [repeated 108x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 62/67 [00:11<00:00,  5.12it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:12<00:00,  5.19it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 64/67 [00:12<00:00,  5.38it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:12<00:00,  5.86it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 66/67 [00:12<00:00,  5.91it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:12<00:00,  5.27it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:12<00:00,  5.27it/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/67 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):   1%|â–         | 1/67 [00:00<00:15,  4.34it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):   3%|â–Ž         | 2/67 [00:00<00:11,  5.57it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):   4%|â–         | 3/67 [00:00<00:10,  6.29it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):   7%|â–‹         | 5/67 [00:00<00:08,  7.22it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):   9%|â–‰         | 6/67 [00:00<00:08,  7.61it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  10%|â–ˆ         | 7/67 [00:01<00:08,  7.37it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  12%|â–ˆâ–        | 8/67 [00:01<00:07,  7.54it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  13%|â–ˆâ–Ž        | 9/67 [00:01<00:07,  7.44it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  15%|â–ˆâ–        | 10/67 [00:01<00:13,  4.08it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  16%|â–ˆâ–‹        | 11/67 [00:01<00:12,  4.61it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  18%|â–ˆâ–Š        | 12/67 [00:02<00:10,  5.07it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  19%|â–ˆâ–‰        | 13/67 [00:02<00:09,  5.47it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  21%|â–ˆâ–ˆ        | 14/67 [00:02<00:08,  6.08it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  22%|â–ˆâ–ˆâ–       | 15/67 [00:02<00:08,  6.21it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  24%|â–ˆâ–ˆâ–       | 16/67 [00:02<00:08,  6.24it/s]
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 61/67 [00:11<00:01,  3.23it/s][32m [repeated 61x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE):  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 66/67 [00:12<00:00,  4.84it/s][32m [repeated 15x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:13<00:00,  4.70it/s]
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:13<00:00,  5.08it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
Capturing CUDA graphs (decode, FULL):   0%|          | 0/67 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (decode, FULL):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:02<00:06,  7.28it/s][32m [repeated 70x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 62/67 [00:09<00:00,  7.16it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:09<00:00,  6.35it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 64/67 [00:10<00:00,  7.07it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:10<00:00,  7.04it/s]
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL):  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 66/67 [00:10<00:00,  7.09it/s]
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (decode, FULL):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 49/67 [00:07<00:02,  7.12it/s][32m [repeated 122x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Capturing CUDA graphs (decode, FULL): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:10<00:00,  7.17it/s]
Capturing CUDA graphs (decode, FULL): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:10<00:00,  6.43it/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:55 [gpu_model_runner.py:3480] Graph capturing finished in 28 secs, took -0.51 GiB
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m All deep_gemm operations loaded successfully![32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 20:59:55 [core.py:210] init engine (profile, create kv cache, warmup model) took 78.32 seconds
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m WARNING 02-21 20:59:58 [serial_utils.py:51] Allowing insecure serialization using pickle due to VLLM_ALLOW_INSECURE_SERIALIZATION=1
[36m(LLMRayActor pid=842166)[0m INFO 02-21 21:00:00 [llm.py:306] Supported_tasks: ('generate',)
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:00:00 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:58 [gpu_model_runner.py:3480] Graph capturing finished in 27 secs, took -0.51 GiB[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 20:59:58 [core.py:210] init engine (profile, create kv cache, warmup model) took 80.87 seconds[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:00:08 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m WARNING 02-21 21:00:01 [serial_utils.py:51] Allowing insecure serialization using pickle due to VLLM_ALLOW_INSECURE_SERIALIZATION=1[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m INFO 02-21 21:00:03 [llm.py:306] Supported_tasks: ('generate',)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:00:03 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:00:08 [gpu_worker.py:117] Sleep mode freed 63.27 GiB memory, 1.44 GiB memory is still in use.
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:00:08 [executor_base.py:189] It took 8.421281 seconds to fall asleep.
[36m(pid=843942)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=843942)[0m   import pynvml  # type: ignore[import]
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (decode, FULL):  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 66/67 [00:10<00:00,  5.63it/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (decode, FULL):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 61/67 [00:09<00:01,  3.62it/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Capturing CUDA graphs (decode, FULL): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:10<00:00,  6.19it/s]
Capturing CUDA graphs (decode, FULL): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:10<00:00,  6.32it/s][32m [repeated 3x across cluster][0m
[36m(pid=843942)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
[36m(pid=843942)[0m   warnings.warn(
[36m(pid=843942)[0m Warning: The cache directory for DeepSpeed Triton autotune, /home/x-qlan1/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:00:10 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:00:10 [gpu_worker.py:117] Sleep mode freed 63.27 GiB memory, 1.44 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:00:10 [executor_base.py:189] It took 7.545168 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(pid=844391)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=844391)[0m   import pynvml  # type: ignore[import]
[36m(pid=844392)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=844392)[0m   import pynvml  # type: ignore[import]
[36m(pid=844391)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
[36m(pid=844391)[0m   warnings.warn(
[36m(pid=844393)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 2x across cluster][0m
[36m(pid=844393)[0m   import pynvml  # type: ignore[import][32m [repeated 2x across cluster][0m
[36m(pid=844391)[0m Warning: The cache directory for DeepSpeed Triton autotune, /home/x-qlan1/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
[36m(pid=844392)[0m Warning: The cache directory for DeepSpeed Triton autotune, /home/x-qlan1/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.
[36m(pid=844393)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.[32m [repeated 3x across cluster][0m
[36m(pid=844393)[0m   warnings.warn([32m [repeated 3x across cluster][0m
[36m(pid=845749)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=845749)[0m   import pynvml  # type: ignore[import]
[36m(pid=845751)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
[36m(pid=845751)[0m   import pynvml  # type: ignore[import]
[36m(pid=845749)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
[36m(pid=845749)[0m   warnings.warn(
[36m(pid=845750)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/cuda/__init__.py:63: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.[32m [repeated 2x across cluster][0m
[36m(pid=845750)[0m   import pynvml  # type: ignore[import][32m [repeated 2x across cluster][0m
[36m(pid=845751)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
[36m(pid=845751)[0m   warnings.warn(
[36m(pid=845750)[0m [2026-02-21 21:02:08,198] [WARNING] [real_accelerator.py:209:get_accelerator] Setting accelerator to CPU. If you have GPU or other accelerator, we were unable to detect it.
[36m(pid=844393)[0m Warning: The cache directory for DeepSpeed Triton autotune, /home/x-qlan1/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:02:32 vtd_trainer_ray.py:646] [SE] Using precomputed se_weight from dataset â€” skipping online SE sampling
[36m(pid=845748)[0m Warning: The cache directory for DeepSpeed Triton autotune, /home/x-qlan1/.triton/autotune, appears to be on an NFS system. While this is generally acceptable, if you experience slowdowns or hanging when DeepSpeed exits, it is recommended to set the TRITON_CACHE_DIR environment variable to a non-NFS path.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m dataset: /home/x-qlan1/code/moule2/teacher_uncertainty_each-sample/dataset_output/evolved_with_se.jsonl
[36m(VtDRayTrainer pid=845750)[0m loaded /home/x-qlan1/code/moule2/teacher_uncertainty_each-sample/dataset_output/evolved_with_se.jsonl with data_files=/home/x-qlan1/code/moule2/teacher_uncertainty_each-sample/dataset_output/evolved_with_se.jsonl
[36m(VtDRayTrainer pid=845750)[0m [Dataset({
[36m(VtDRayTrainer pid=845750)[0m     features: ['question', 'source', 'difficulty', 'strategy', 'round', 'se', 'se_weight', 'se_raw', 'n_valid_responses'],
[36m(VtDRayTrainer pid=845750)[0m     num_rows: 45628
[36m(VtDRayTrainer pid=845750)[0m })]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   0%|          | 0/45628 [00:00<?, ?it/s]
[36m(pid=845750)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.[32m [repeated 2x across cluster][0m
[36m(pid=845750)[0m   warnings.warn([32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   1%|          | 395/45628 [00:00<00:11, 3949.02it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   2%|â–         | 1040/45628 [00:00<00:08, 5417.74it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   4%|â–Ž         | 1661/45628 [00:00<00:07, 5738.31it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   5%|â–Œ         | 2290/45628 [00:00<00:07, 5953.68it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   6%|â–‹         | 2925/45628 [00:00<00:07, 6094.74it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   8%|â–Š         | 3535/45628 [00:00<00:06, 6041.05it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   9%|â–‰         | 4207/45628 [00:00<00:06, 6261.02it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  11%|â–ˆ         | 4834/45628 [00:00<00:06, 6177.13it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  12%|â–ˆâ–        | 5457/45628 [00:00<00:06, 6191.26it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  13%|â–ˆâ–Ž        | 6077/45628 [00:01<00:06, 6095.47it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  15%|â–ˆâ–        | 6687/45628 [00:01<00:06, 5836.33it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  16%|â–ˆâ–Œ        | 7297/45628 [00:01<00:06, 5911.69it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  17%|â–ˆâ–‹        | 7891/45628 [00:01<00:06, 5844.26it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  19%|â–ˆâ–Š        | 8541/45628 [00:01<00:06, 6034.30it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  20%|â–ˆâ–ˆ        | 9146/45628 [00:01<00:06, 6007.60it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  21%|â–ˆâ–ˆâ–       | 9763/45628 [00:01<00:05, 6053.79it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  23%|â–ˆâ–ˆâ–Ž       | 10370/45628 [00:02<00:11, 3043.23it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  24%|â–ˆâ–ˆâ–Ž       | 10836/45628 [00:02<00:11, 3044.75it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  25%|â–ˆâ–ˆâ–       | 11391/45628 [00:02<00:09, 3511.73it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  26%|â–ˆâ–ˆâ–‹       | 11982/45628 [00:02<00:08, 4015.66it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  28%|â–ˆâ–ˆâ–Š       | 12626/45628 [00:02<00:07, 4575.66it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  29%|â–ˆâ–ˆâ–‰       | 13205/45628 [00:02<00:06, 4876.75it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  30%|â–ˆâ–ˆâ–ˆ       | 13846/45628 [00:02<00:06, 5278.03it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  32%|â–ˆâ–ˆâ–ˆâ–      | 14507/45628 [00:02<00:05, 5639.97it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15111/45628 [00:02<00:05, 5690.09it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  35%|â–ˆâ–ˆâ–ˆâ–      | 15757/45628 [00:03<00:05, 5907.80it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16384/45628 [00:03<00:04, 5993.28it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 16999/45628 [00:03<00:04, 5919.81it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 17602/45628 [00:03<00:04, 5753.43it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  40%|â–ˆâ–ˆâ–ˆâ–‰      | 18186/45628 [00:03<00:04, 5772.50it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18770/45628 [00:03<00:04, 5767.07it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19378/45628 [00:03<00:04, 5858.02it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20012/45628 [00:03<00:04, 5999.58it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 20644/45628 [00:03<00:04, 6094.06it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21256/45628 [00:03<00:04, 5907.81it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 21884/45628 [00:04<00:03, 6015.42it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22514/45628 [00:04<00:03, 6098.00it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23168/45628 [00:04<00:03, 6227.74it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 23793/45628 [00:04<00:03, 5809.23it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24381/45628 [00:04<00:03, 5729.80it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 24959/45628 [00:04<00:03, 5585.13it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25559/45628 [00:04<00:03, 5702.47it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 26192/45628 [00:04<00:03, 5881.95it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26783/45628 [00:04<00:03, 5795.72it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27433/45628 [00:05<00:03, 5981.86it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28043/45628 [00:05<00:02, 6006.61it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 28680/45628 [00:05<00:02, 6082.99it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29290/45628 [00:05<00:02, 6086.08it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 29900/45628 [00:05<00:02, 5962.01it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30498/45628 [00:05<00:02, 5811.35it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 31081/45628 [00:05<00:02, 5772.31it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31685/45628 [00:05<00:02, 5849.04it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32296/45628 [00:05<00:02, 5924.65it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 32890/45628 [00:05<00:02, 5822.35it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33548/45628 [00:06<00:01, 6043.05it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 34175/45628 [00:06<00:01, 6091.02it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34785/45628 [00:06<00:01, 5844.55it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35372/45628 [00:06<00:01, 5814.29it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 35960/45628 [00:06<00:01, 5831.77it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36545/45628 [00:06<00:01, 5765.29it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37123/45628 [00:06<00:01, 5003.79it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37642/45628 [00:06<00:01, 4962.06it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 38205/45628 [00:06<00:01, 5128.80it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 38860/45628 [00:07<00:01, 5416.07it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39500/45628 [00:07<00:01, 5635.97it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 40070/45628 [00:07<00:02, 2672.87it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40612/45628 [00:07<00:01, 3115.42it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41079/45628 [00:07<00:01, 3263.13it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41561/45628 [00:07<00:01, 3580.42it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 42151/45628 [00:08<00:00, 4102.24it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42776/45628 [00:08<00:00, 4625.04it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43369/45628 [00:08<00:00, 4960.92it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 43966/45628 [00:08<00:00, 5220.73it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44552/45628 [00:08<00:00, 5396.82it/s]
[36m(VtDRayTrainer pid=845750)[0m dataset: openai/gsm8k
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 45125/45628 [00:08<00:00, 5490.58it/s]
Preprocessing VtD data: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45628/45628 [00:08<00:00, 5288.80it/s]
[36m(VtDRayTrainer pid=845750)[0m loaded openai/gsm8k (config: main)
[36m(VtDRayTrainer pid=845750)[0m [Dataset({
[36m(VtDRayTrainer pid=845750)[0m     features: ['question', 'answer'],
[36m(VtDRayTrainer pid=845750)[0m     num_rows: 1319
[36m(VtDRayTrainer pid=845750)[0m })]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:   0%|          | 0/1319 [00:00<?, ?it/s]
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 495/1319 [00:00<00:00, 4862.27it/s]
[36m(VtDRayTrainer pid=845750)[0m Eval dataset: openai/gsm8k (test), input_key=question, samples=1319
[36m(VtDRayTrainer pid=845750)[0m 
Preprocessing VtD data:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 982/1319 [00:00<00:00, 4642.04it/s]
Preprocessing VtD data: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1319/1319 [00:00<00:00, 4762.97it/s]
[36m(VtDRayTrainer pid=845750)[0m wandb: Currently logged in as: moule (moule-trinity-college-dublin) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(VtDRayTrainer pid=845750)[0m wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
[36m(VtDRayTrainer pid=845750)[0m wandb: setting up run ud5hm7em
[36m(VtDRayTrainer pid=845750)[0m wandb: Tracking run with wandb version 0.23.1
[36m(VtDRayTrainer pid=845750)[0m wandb: Run data is saved locally in /anvil/scratch/x-qlan1/moule/wandb/wandb/run-20260221_210244-ud5hm7em
[36m(VtDRayTrainer pid=845750)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(VtDRayTrainer pid=845750)[0m wandb: Syncing run vtd_1node_qwen3_1.7b
[36m(VtDRayTrainer pid=845750)[0m wandb: â­ï¸ View project at https://wandb.ai/moule-trinity-college-dublin/vtd_reasoning
[36m(VtDRayTrainer pid=845750)[0m wandb: ðŸš€ View run at https://wandb.ai/moule-trinity-college-dublin/vtd_reasoning/runs/ud5hm7em
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:02:47 vtd_trainer_ray.py:684] Metrics log file: /home/x-qlan1/code/moule2/vtd_metrics.txt
[36m(VtDTeacherActor pid=844393)[0m `torch_dtype` is deprecated! Use `dtype` instead!
[36m(VtDTeacherActor pid=844393)[0m 
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]
[36m(VtDTeacherActor pid=844393)[0m 
Loading checkpoint shards:  20%|â–ˆâ–ˆ        | 1/5 [00:00<00:01,  2.58it/s]
[36m(VtDTeacherActor pid=844393)[0m 
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:02<00:00,  2.48it/s]
[36m(VtDTeacherActor pid=844393)[0m Teacher model: Actor(
[36m(VtDTeacherActor pid=844393)[0m   (model): Qwen3ForCausalLM(
[36m(VtDTeacherActor pid=844393)[0m     (model): Qwen3Model(
[36m(VtDTeacherActor pid=844393)[0m       (embed_tokens): Embedding(151936, 4096)
[36m(VtDTeacherActor pid=844393)[0m       (layers): ModuleList(
[36m(VtDTeacherActor pid=844393)[0m         (0-35): 36 x Qwen3DecoderLayer(
[36m(VtDTeacherActor pid=844393)[0m           (self_attn): Qwen3Attention(
[36m(VtDTeacherActor pid=844393)[0m             (q_proj): Linear(in_features=4096, out_features=4096, bias=False)
[36m(VtDTeacherActor pid=844393)[0m             (k_proj): Linear(in_features=4096, out_features=1024, bias=False)
[36m(VtDTeacherActor pid=844393)[0m             (v_proj): Linear(in_features=4096, out_features=1024, bias=False)
[36m(VtDTeacherActor pid=844393)[0m             (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
[36m(VtDTeacherActor pid=844393)[0m             (q_norm): Qwen3RMSNorm((128,), eps=1e-06)
[36m(VtDTeacherActor pid=844393)[0m             (k_norm): Qwen3RMSNorm((128,), eps=1e-06)
[36m(VtDTeacherActor pid=844393)[0m           )
[36m(VtDTeacherActor pid=844393)[0m           (mlp): Qwen3MLP(
[36m(VtDTeacherActor pid=844393)[0m             (gate_proj): Linear(in_features=4096, out_features=12288, bias=False)
[36m(VtDTeacherActor pid=844393)[0m             (up_proj): Linear(in_features=4096, out_features=12288, bias=False)
[36m(VtDTeacherActor pid=844393)[0m             (down_proj): Linear(in_features=12288, out_features=4096, bias=False)
[36m(VtDTeacherActor pid=844393)[0m             (act_fn): SiLU()
[36m(VtDTeacherActor pid=844393)[0m           )
[36m(VtDTeacherActor pid=844393)[0m           (input_layernorm): Qwen3RMSNorm((4096,), eps=1e-06)
[36m(VtDTeacherActor pid=844393)[0m           (post_attention_layernorm): Qwen3RMSNorm((4096,), eps=1e-06)
[36m(VtDTeacherActor pid=844393)[0m         )
[36m(VtDTeacherActor pid=844393)[0m       )
[36m(VtDTeacherActor pid=844393)[0m       (norm): Qwen3RMSNorm((4096,), eps=1e-06)
[36m(VtDTeacherActor pid=844393)[0m       (rotary_emb): Qwen3RotaryEmbedding()
[36m(VtDTeacherActor pid=844393)[0m     )
[36m(VtDTeacherActor pid=844393)[0m     (lm_head): Linear(in_features=4096, out_features=151936, bias=False)
[36m(VtDTeacherActor pid=844393)[0m   )
[36m(VtDTeacherActor pid=844393)[0m )
[36m(VtDStudentActor pid=844391)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 4x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m 
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m 
Loading checkpoint shards:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:01<00:00,  2.04it/s][32m [repeated 15x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m 
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:02<00:00,  2.48it/s][32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m 
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  2.95it/s]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.31it/s]
[36m(VtDStudentActor pid=843942)[0m Actor(
[36m(VtDStudentActor pid=843942)[0m     (model): Qwen3Model([32m [repeated 2x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m       (embed_tokens): Embedding(151936, 2048)
[36m(VtDStudentActor pid=843942)[0m       (layers): ModuleList(
[36m(VtDStudentActor pid=843942)[0m         (0-27): 28 x Qwen3DecoderLayer(
[36m(VtDStudentActor pid=843942)[0m           (self_attn): Qwen3Attention(
[36m(VtDStudentActor pid=843942)[0m             (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
[36m(VtDStudentActor pid=843942)[0m             (k_proj): Linear(in_features=2048, out_features=1024, bias=False)
[36m(VtDStudentActor pid=843942)[0m             (v_proj): Linear(in_features=2048, out_features=1024, bias=False)
[36m(VtDStudentActor pid=843942)[0m             (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
[36m(VtDStudentActor pid=843942)[0m             (q_norm): Qwen3RMSNorm((128,), eps=1e-06)
[36m(VtDStudentActor pid=843942)[0m             (k_norm): Qwen3RMSNorm((128,), eps=1e-06)
[36m(VtDStudentActor pid=843942)[0m )[32m [repeated 7x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m           (mlp): Qwen3MLP(
[36m(VtDStudentActor pid=843942)[0m             (gate_proj): Linear(in_features=2048, out_features=6144, bias=False)
[36m(VtDStudentActor pid=843942)[0m             (up_proj): Linear(in_features=2048, out_features=6144, bias=False)
[36m(VtDStudentActor pid=843942)[0m             (down_proj): Linear(in_features=6144, out_features=2048, bias=False)
[36m(VtDStudentActor pid=843942)[0m             (act_fn): SiLU()
[36m(VtDStudentActor pid=843942)[0m           (input_layernorm): Qwen3RMSNorm((2048,), eps=1e-06)
[36m(VtDStudentActor pid=843942)[0m           (post_attention_layernorm): Qwen3RMSNorm((2048,), eps=1e-06)
[36m(VtDStudentActor pid=843942)[0m       (norm): Qwen3RMSNorm((2048,), eps=1e-06)
[36m(VtDStudentActor pid=843942)[0m       (rotary_emb): Qwen3RotaryEmbedding()
[36m(VtDStudentActor pid=843942)[0m     (lm_head): Linear(in_features=2048, out_features=151936, bias=False)
[36m(VtDStudentActor pid=844394)[0m [rank1]:W0221 21:03:26.150000 844394 torch/utils/cpp_extension.py:2425] TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
[36m(VtDStudentActor pid=844394)[0m [rank1]:W0221 21:03:26.150000 844394 torch/utils/cpp_extension.py:2425] If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'] to specific architectures.
[36m(VtDStudentActor pid=843942)[0m Before initializing optimizer states
[36m(VtDStudentActor pid=843942)[0m MA 4.81 GB         Max_MA 4.81 GB         CA 4.81 GB         Max_CA 5 GB 
[36m(VtDStudentActor pid=843942)[0m CPU Virtual Memory:  used = 87.72 GB, percent = 8.7%
[36m(VtDStudentActor pid=843942)[0m After initializing optimizer states
[36m(VtDStudentActor pid=843942)[0m MA 4.81 GB         Max_MA 6.41 GB         CA 6.41 GB         Max_CA 6 GB 
[36m(VtDStudentActor pid=843942)[0m CPU Virtual Memory:  used = 90.23 GB, percent = 9.0%
[36m(VtDStudentActor pid=843942)[0m After initializing ZeRO optimizer
[36m(VtDStudentActor pid=843942)[0m MA 4.81 GB         Max_MA 4.81 GB         CA 6.41 GB         Max_CA 6 GB 
[36m(VtDStudentActor pid=843942)[0m CPU Virtual Memory:  used = 92.66 GB, percent = 9.2%
[36m(VtDTeacherActor pid=844393)[0m begin bf16_optimizer
[36m(VtDTeacherActor pid=844393)[0m MA 15.26 GB         Max_MA 15.26 GB         CA 15.4 GB         Max_CA 15 GB 
[36m(VtDTeacherActor pid=844393)[0m CPU Virtual Memory:  used = 95.84 GB, percent = 9.5%
[36m(VtDTeacherActor pid=844393)[0m end bf16_ optimizer
[36m(VtDTeacherActor pid=844393)[0m MA 15.26 GB         Max_MA 15.26 GB         CA 15.4 GB         Max_CA 15 GB 
[36m(VtDTeacherActor pid=844393)[0m CPU Virtual Memory:  used = 95.87 GB, percent = 9.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:04:58 vtd_trainer_ray.py:831] ========== Baseline evaluation (before training) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:05:23 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 0, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m /anvil/scratch/x-qlan1/moule/train-env/lib/python3.12/site-packages/torch/utils/data/dataloader.py:666: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
[36m(VtDRayTrainer pid=845750)[0m   warnings.warn(warn_msg)
[36m(VtDStudentActor pid=843942)[0m `torch_dtype` is deprecated! Use `dtype` instead![32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m 
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 4x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m 
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  4.88it/s]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  8.30it/s][32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:05:23 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:05:24 [executor_base.py:205] It took 0.816802 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:05:24 [executor_base.py:205] It took 0.856440 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:02, 65.26it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 79.72it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 68.52it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 75.69it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:07<19:23,  7.09s/it, est. speed input: 66.40 toks/s, output: 34.26 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [00:01<00:00, 79.98it/s][32m [repeated 61x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 74.88it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:02<00:00, 72.96it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 75.61it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/165 [00:07<08:22,  3.08s/it, est. speed input: 124.69 toks/s, output: 65.94 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  12%|â–ˆâ–        | 19/165 [00:12<00:34,  4.20it/s, est. speed input: 725.91 toks/s, output: 504.34 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  28%|â–ˆâ–ˆâ–Š       | 46/165 [00:17<00:17,  6.79it/s, est. speed input: 1245.44 toks/s, output: 1060.63 toks/s][32m [repeated 68x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 97/165 [00:22<00:08,  8.08it/s, est. speed input: 2059.26 toks/s, output: 2273.14 toks/s][32m [repeated 82x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [00:27<00:09,  4.60it/s, est. speed input: 2062.87 toks/s, output: 2535.09 toks/s][32m [repeated 62x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 120/165 [00:32<00:19,  2.31it/s, est. speed input: 1773.40 toks/s, output: 2307.52 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 134/165 [00:37<00:12,  2.53it/s, est. speed input: 1723.04 toks/s, output: 2510.63 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 144/165 [00:42<00:19,  1.10it/s, est. speed input: 1605.19 toks/s, output: 2385.10 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:46<00:01,  6.18it/s, est. speed input: 1607.46 toks/s, output: 2767.24 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:46<00:00,  6.18it/s, est. speed input: 1678.00 toks/s, output: 3069.25 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:46<00:00,  3.51it/s, est. speed input: 1678.00 toks/s, output: 3069.25 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/165 [00:48<00:19,  1.16it/s, est. speed input: 1429.06 toks/s, output: 2361.40 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:48<00:01,  4.91it/s, est. speed input: 1574.71 toks/s, output: 2860.48 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  4.91it/s, est. speed input: 1644.19 toks/s, output: 3154.84 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  3.40it/s, est. speed input: 1644.19 toks/s, output: 3154.84 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:06:15 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:05:24 [executor_base.py:205] It took 0.849846 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:06:16 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:06:16 [gpu_worker.py:117] Sleep mode freed 62.10 GiB memory, 11.82 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:06:16 [executor_base.py:189] It took 0.446457 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:06:16 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 575/660 = 87.1%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:06:16 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:06:17 [executor_base.py:205] It took 0.292287 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842167)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 69.82it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:01<00:00, 83.63it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:01<00:00, 83.59it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.62it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:08<21:59,  8.04s/it, est. speed input: 56.56 toks/s, output: 30.71 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:48<00:00,  9.60it/s, est. speed input: 1548.18 toks/s, output: 2913.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  9.60it/s, est. speed input: 1627.80 toks/s, output: 3247.07 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  3.37it/s, est. speed input: 1627.80 toks/s, output: 3247.07 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 142/164 [00:01<00:00, 79.79it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 82.63it/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 13/165 [00:13<00:51,  2.94it/s, est. speed input: 464.64 toks/s, output: 348.02 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 63/165 [00:18<00:17,  5.88it/s, est. speed input: 1634.06 toks/s, output: 1544.99 toks/s][32m [repeated 76x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 86/165 [00:23<00:27,  2.91it/s, est. speed input: 1727.45 toks/s, output: 1813.74 toks/s][32m [repeated 69x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 121/165 [00:28<00:14,  2.95it/s, est. speed input: 2006.27 toks/s, output: 2471.48 toks/s][32m [repeated 64x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 135/165 [00:33<00:09,  3.23it/s, est. speed input: 1902.19 toks/s, output: 2577.33 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 137/164 [00:39<00:21,  1.25it/s, est. speed input: 1680.53 toks/s, output: 2440.21 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [00:44<00:16,  1.01s/it, est. speed input: 1612.54 toks/s, output: 2457.22 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:47<00:03,  2.55it/s, est. speed input: 1602.64 toks/s, output: 2660.61 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:47<00:00,  2.55it/s, est. speed input: 1689.50 toks/s, output: 3005.49 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:47<00:00,  3.50it/s, est. speed input: 1689.50 toks/s, output: 3005.49 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 158/164 [00:47<00:01,  5.05it/s, est. speed input: 1599.19 toks/s, output: 2838.88 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:47<00:00,  5.05it/s, est. speed input: 1662.00 toks/s, output: 3095.82 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:47<00:00,  3.45it/s, est. speed input: 1662.00 toks/s, output: 3095.82 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:07:07 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:06:17 [executor_base.py:205] It took 0.307953 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:06:16 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:06:16 [gpu_worker.py:117] Sleep mode freed 62.10 GiB memory, 11.52 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:06:16 [executor_base.py:189] It took 0.484272 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:48<00:09,  1.97it/s, est. speed input: 1470.55 toks/s, output: 2420.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  1.97it/s, est. speed input: 1654.77 toks/s, output: 3180.51 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  3.41it/s, est. speed input: 1654.77 toks/s, output: 3180.51 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:07:08 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1166/1319 = 88.4%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:07:08 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 0 å®Œæˆ: å‡†ç¡®çŽ‡ 88.4% (1166/1319), è€—æ—¶ 104.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:07:08 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_0.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:07:20 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:07:07 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:07:08 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:07:08 [gpu_worker.py:117] Sleep mode freed 62.42 GiB memory, 11.82 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:07:08 [executor_base.py:189] It took 0.551712 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   0%|          | 0/89 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 146/165 [00:47<00:09,  1.94it/s, est. speed input: 1474.62 toks/s, output: 2402.74 toks/s][32m [repeated 15x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:48<00:05,  2.10it/s, est. speed input: 1528.51 toks/s, output: 2708.83 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  2.10it/s, est. speed input: 1653.21 toks/s, output: 3214.36 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:48<00:00,  3.42it/s, est. speed input: 1653.21 toks/s, output: 3214.36 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:07:46 [executor_base.py:205] It took 0.317790 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:07:46 [executor_base.py:205] It took 0.320040 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  22%|â–ˆâ–ˆâ–       | 14/64 [00:00<00:00, 97.55it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [00:00<00:00, 128.09it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 135.44it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [00:00<00:00, 144.15it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 140.54it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:13<13:40,  3.26s/it, est. speed input: 27.63 toks/s, output: 97.32 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [00:00<00:00, 122.86it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:00<00:00, 135.62it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 148.38it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:22<23:23,  5.57s/it, est. speed input: 14.19 toks/s, output: 89.39 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:24<11:00,  2.66s/it, est. speed input: 26.31 toks/s, output: 168.13 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:31<33:08,  7.89s/it, est. speed input: 14.32 toks/s, output: 81.05 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–‹         | 16/256 [00:37<06:11,  1.55s/it, est. speed input: 37.25 toks/s, output: 295.11 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [00:42<02:34,  1.42it/s, est. speed input: 73.30 toks/s, output: 598.74 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–‹         | 16/256 [00:49<10:10,  2.55s/it, est. speed input: 30.39 toks/s, output: 252.93 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   9%|â–‰         | 24/256 [00:57<07:03,  1.83s/it, est. speed input: 42.34 toks/s, output: 369.19 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:03<06:47,  1.79s/it, est. speed input: 52.59 toks/s, output: 421.95 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [01:08<02:27,  1.43it/s, est. speed input: 74.67 toks/s, output: 689.40 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 56/256 [01:13<01:30,  2.21it/s, est. speed input: 83.52 toks/s, output: 880.18 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [01:20<04:18,  1.22s/it, est. speed input: 49.60 toks/s, output: 597.28 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 144/256 [01:23<00:17,  6.54it/s, est. speed input: 212.16 toks/s, output: 2624.25 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:24<00:00,  6.54it/s, est. speed input: 385.65 toks/s, output: 5310.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:24<00:00,  3.05it/s, est. speed input: 385.65 toks/s, output: 5310.78 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  28%|â–ˆâ–ˆâ–Š       | 72/256 [01:25<01:38,  1.87it/s, est. speed input: 98.62 toks/s, output: 1090.22 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:25<00:00,  1.11it/s, est. speed input: 405.75 toks/s, output: 5463.06 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:25<00:00,  2.98it/s, est. speed input: 405.75 toks/s, output: 5463.06 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:09:13 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:07:46 [executor_base.py:205] It took 0.309126 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:09:14 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:09:14 [gpu_worker.py:117] Sleep mode freed 62.40 GiB memory, 11.82 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:09:14 [executor_base.py:189] It took 0.884135 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:09:14 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:09:14 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:09:26 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.252, å¹³å‡æƒé‡=0.748
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:09:13 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:09:14 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:09:14 [gpu_worker.py:117] Sleep mode freed 62.52 GiB memory, 11.52 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:09:14 [executor_base.py:189] It took 1.019258 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:09:37 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:09:37 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:09:37 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:09:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:09:37 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:09:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 10/128 å®Œæˆ (20/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:09:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 19/128 å®Œæˆ (38/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:09:55 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 28/128 å®Œæˆ (56/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:10:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 36/128 å®Œæˆ (72/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:10:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 45/128 å®Œæˆ (90/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:10:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 53/128 å®Œæˆ (106/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:10:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 62/128 å®Œæˆ (124/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:10:21 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:10:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 81/128 å®Œæˆ (162/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:10:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 90/128 å®Œæˆ (180/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:10:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 98/128 å®Œæˆ (196/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:10:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 107/128 å®Œæˆ (214/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:10:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 115/128 å®Œæˆ (230/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:10:51 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 124/128 å®Œæˆ (248/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:11:18 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:10:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 20x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:11:20 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:11:23 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:11:25 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:11:31 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 125.3s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:11:31 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:11:55 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:44 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4552)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4534)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4575)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4645)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4335)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4322)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:12:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4317)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:40 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.5106)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4954)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4963)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4901)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4579)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4652)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:13:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4572)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:03 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4946)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4739)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4935)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4837)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4534)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4594)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:15:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4534)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:29 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.5017)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.5045)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4808)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4804)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4545)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4710)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4609)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:16:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.4252)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.4538)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.4611)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:16:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.4477)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.4417)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.4403)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:17:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.4491)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.4550)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.4508)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 31/64 å®Œæˆ (124/256 æ¡æ ·æœ¬, loss=0.4448)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 34/64 å®Œæˆ (136/256 æ¡æ ·æœ¬, loss=0.4437)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.4578)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:17:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.4430)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:17:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.4587)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:18:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.4535)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:18:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.4410)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:18:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.4548)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:18:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.4577)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:18:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 58/64 å®Œæˆ (232/256 æ¡æ ·æœ¬, loss=0.4538)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:18:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 60/64 å®Œæˆ (240/256 æ¡æ ·æœ¬, loss=0.4501)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:18:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 63/64 å®Œæˆ (252/256 æ¡æ ·æœ¬, loss=0.4488)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:18:40 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=6.67e-07, è€—æ—¶ 356.0s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:18:57 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:18:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.4416)[32m [repeated 7x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:18:40 vtd_actor.py:330] [è®­ç»ƒ rank=2] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=6.67e-07, è€—æ—¶ 217.0s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:18:57 [executor_base.py:205] It took 0.340137 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:18:57 [executor_base.py:205] It took 0.362798 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:18:57 [executor_base.py:205] It took 0.337216 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:19:23 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:19:24 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:19:24 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:19:24 [executor_base.py:189] It took 0.460317 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:19:24 vtd_trainer_ray.py:1123] æ­¥éª¤ 1: {'vtd_loss': 0.4383617585990578, 'distill_loss': 0.4383617585990578, 'avg_se_weight': 0.74839921875, 'actor_lr': 6.666666666666666e-07, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.25160078125, 'step_time': 723.3350827693939, 'phase1_generate_time': 113.57070899009705, 'phase2_collect_time': 125.28063368797302, 'phase3_train_time': 445.563978433609} [é‡‡æ ·=113.6s æ”¶é›†=125.3s è®­ç»ƒ=445.6s æ€»è®¡=723.3s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:19:24 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 1, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:19:24 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:19:24 [executor_base.py:205] It took 0.341140 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 164/256 [01:25<00:04, 19.75it/s, est. speed input: 244.63 toks/s, output: 3268.38 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:25<00:00, 19.75it/s, est. speed input: 419.38 toks/s, output: 5463.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:25<00:00,  2.99it/s, est. speed input: 419.38 toks/s, output: 5463.43 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  16%|â–ˆâ–Œ        | 40/256 [01:26<05:20,  1.48s/it, est. speed input: 48.18 toks/s, output: 565.75 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:26<00:00,  1.48s/it, est. speed input: 409.06 toks/s, output: 5551.61 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:26<00:00,  2.96it/s, est. speed input: 409.06 toks/s, output: 5551.61 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:19:24 [executor_base.py:205] It took 0.380062 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:01, 89.21it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:03<00:00, 79.35it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 51.48it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:03<00:00, 84.82it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:07<21:27,  7.85s/it, est. speed input: 60.00 toks/s, output: 30.96 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:03<00:00, 77.17it/s][32m [repeated 70x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 49.96it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:08<23:07,  8.46s/it, est. speed input: 52.97 toks/s, output: 30.50 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 21/165 [00:13<00:17,  8.17it/s, est. speed input: 722.34 toks/s, output: 538.23 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  29%|â–ˆâ–ˆâ–‰       | 48/165 [00:18<00:17,  6.70it/s, est. speed input: 1206.37 toks/s, output: 1064.77 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:23<00:27,  3.62it/s, est. speed input: 1302.47 toks/s, output: 1358.68 toks/s][32m [repeated 66x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [00:28<00:09,  5.20it/s, est. speed input: 1860.34 toks/s, output: 2222.45 toks/s][32m [repeated 64x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [00:33<00:12,  2.93it/s, est. speed input: 1787.10 toks/s, output: 2311.38 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [00:38<00:23,  1.99it/s, est. speed input: 1465.47 toks/s, output: 2071.38 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 137/165 [00:43<00:11,  2.51it/s, est. speed input: 1495.13 toks/s, output: 2259.05 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/165 [00:49<00:41,  1.88s/it, est. speed input: 1380.25 toks/s, output: 2147.27 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:53<00:00,  6.03it/s, est. speed input: 1457.64 toks/s, output: 2597.89 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:53<00:00,  6.03it/s, est. speed input: 1484.54 toks/s, output: 2712.48 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:53<00:00,  3.11it/s, est. speed input: 1484.54 toks/s, output: 2712.48 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 142/165 [00:53<00:25,  1.11s/it, est. speed input: 1269.11 toks/s, output: 2147.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:53<00:00,  1.11s/it, est. speed input: 1478.60 toks/s, output: 3019.94 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:53<00:00,  3.06it/s, est. speed input: 1478.60 toks/s, output: 3019.94 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:20:21 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:19:24 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:19:24 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:19:24 [executor_base.py:189] It took 0.448701 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:19:24 [executor_base.py:205] It took 0.373817 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:20:22 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 579/660 = 87.7%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:20:22 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:20:23 [executor_base.py:205] It took 0.948783 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 141/165 [00:53<00:35,  1.48s/it, est. speed input: 1265.42 toks/s, output: 2117.93 toks/s][32m [repeated 15x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:06, 23.45it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:02<00:00, 87.10it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:02<00:00, 85.98it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 68.16it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:53<00:00, 12.09it/s, est. speed input: 1473.43 toks/s, output: 2824.02 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:53<00:00, 12.09it/s, est. speed input: 1482.43 toks/s, output: 2862.02 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:53<00:00,  3.08it/s, est. speed input: 1482.43 toks/s, output: 2862.02 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 68.62it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:08<22:27,  8.27s/it, est. speed input: 54.80 toks/s, output: 29.52 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 145/164 [00:02<00:00, 81.39it/s][32m [repeated 63x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 67.70it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:08<22:59,  8.41s/it, est. speed input: 54.08 toks/s, output: 30.90 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 13/165 [00:13<00:42,  3.56it/s, est. speed input: 451.55 toks/s, output: 330.61 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 22/165 [00:14<00:25,  5.58it/s, est. speed input: 696.27 toks/s, output: 534.78 toks/s]
Processed prompts:  15%|â–ˆâ–        | 24/165 [00:14<00:19,  7.42it/s, est. speed input: 757.69 toks/s, output: 586.65 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–       | 40/165 [00:18<00:27,  4.59it/s, est. speed input: 1027.99 toks/s, output: 896.85 toks/s][32m [repeated 64x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 67/165 [00:23<00:25,  3.92it/s, est. speed input: 1346.07 toks/s, output: 1433.46 toks/s][32m [repeated 69x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 100/165 [00:29<00:10,  6.24it/s, est. speed input: 1644.03 toks/s, output: 2047.73 toks/s][32m [repeated 69x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [00:33<00:10,  4.75it/s, est. speed input: 1603.48 toks/s, output: 2161.56 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [00:39<00:12,  3.13it/s, est. speed input: 1553.15 toks/s, output: 2265.73 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 137/165 [00:44<00:16,  1.66it/s, est. speed input: 1488.39 toks/s, output: 2321.08 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 144/165 [00:49<00:20,  1.04it/s, est. speed input: 1402.63 toks/s, output: 2309.53 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:53<00:01,  5.71it/s, est. speed input: 1380.87 toks/s, output: 2420.07 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:54<00:00,  5.71it/s, est. speed input: 1474.11 toks/s, output: 2796.02 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:54<00:00,  3.06it/s, est. speed input: 1474.11 toks/s, output: 2796.02 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/164 [00:54<00:09,  1.52it/s, est. speed input: 1321.51 toks/s, output: 2289.73 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/164 [00:55<00:00,  8.38it/s, est. speed input: 1420.48 toks/s, output: 2759.73 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:55<00:00,  8.38it/s, est. speed input: 1430.10 toks/s, output: 2796.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:55<00:00,  2.97it/s, est. speed input: 1430.10 toks/s, output: 2796.77 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:21:21 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:20:22 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:20:22 [gpu_worker.py:117] Sleep mode freed 62.34 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:20:22 [executor_base.py:189] It took 0.497065 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:20:23 [executor_base.py:205] It took 1.131591 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:21:22 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1163/1319 = 88.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:21:22 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 1 å®Œæˆ: å‡†ç¡®çŽ‡ 88.2% (1163/1319), è€—æ—¶ 118.1s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:21:22 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_1.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:21:22 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   1%|          | 1/89 [14:01<20:34:06, 841.44s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:21:22 [executor_base.py:205] It took 0.347238 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  19%|â–ˆâ–‰        | 12/64 [00:00<00:00, 94.71it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:00<00:00, 140.56it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 133.89it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:00<00:00, 122.06it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 140.47it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 144.99it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:55<00:00,  7.38it/s, est. speed input: 1406.90 toks/s, output: 2675.72 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:55<00:00,  1.73s/it, est. speed input: 1437.83 toks/s, output: 2833.28 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:55<00:00,  2.96it/s, est. speed input: 1437.83 toks/s, output: 2833.28 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:15<16:41,  3.98s/it, est. speed input: 21.13 toks/s, output: 87.40 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:55<00:00, 10.11it/s, est. speed input: 1431.00 toks/s, output: 2780.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:55<00:00, 10.11it/s, est. speed input: 1439.93 toks/s, output: 2817.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:55<00:00,  2.98it/s, est. speed input: 1439.93 toks/s, output: 2817.05 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [00:00<00:00, 125.16it/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:00<00:00, 122.70it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 140.03it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:25<26:27,  6.30s/it, est. speed input: 13.02 toks/s, output: 82.88 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:30<13:51,  3.35s/it, est. speed input: 24.38 toks/s, output: 144.93 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:31<15:23,  3.72s/it, est. speed input: 29.40 toks/s, output: 130.75 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–‹         | 16/256 [00:41<08:22,  2.09s/it, est. speed input: 41.85 toks/s, output: 248.07 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [00:47<06:02,  1.54s/it, est. speed input: 46.30 toks/s, output: 311.30 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:53<29:28,  7.13s/it, est. speed input: 14.20 toks/s, output: 109.52 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [00:59<04:48,  1.31s/it, est. speed input: 66.00 toks/s, output: 488.01 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:04<13:11,  3.30s/it, est. speed input: 26.25 toks/s, output: 228.67 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [01:10<04:41,  1.33s/it, est. speed input: 66.92 toks/s, output: 548.51 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:15<08:47,  2.27s/it, est. speed input: 28.77 toks/s, output: 358.83 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [01:21<04:01,  1.10s/it, est. speed input: 40.51 toks/s, output: 547.42 toks/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  20%|â–ˆâ–ˆ        | 52/256 [01:27<01:40,  2.04it/s, est. speed input: 55.95 toks/s, output: 782.57 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 148/256 [01:33<00:08, 12.21it/s, est. speed input: 214.82 toks/s, output: 2522.33 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 240/256 [01:33<00:00, 30.19it/s, est. speed input: 360.29 toks/s, output: 4485.69 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:33<00:00, 30.19it/s, est. speed input: 381.03 toks/s, output: 4835.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:33<00:00,  2.74it/s, est. speed input: 381.03 toks/s, output: 4835.93 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:34<00:00, 10.26it/s, est. speed input: 387.13 toks/s, output: 4855.25 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:34<00:00,  2.72it/s, est. speed input: 387.13 toks/s, output: 4855.25 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:22:59 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:21:22 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:21:22 [gpu_worker.py:117] Sleep mode freed 61.77 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:21:22 [executor_base.py:189] It took 0.506711 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:21:22 [executor_base.py:205] It took 0.350169 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:22:59 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:22:59 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:23:13 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.231, å¹³å‡æƒé‡=0.769
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:22:59 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:22:59 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:22:59 [gpu_worker.py:117] Sleep mode freed 62.46 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:22:59 [executor_base.py:189] It took 0.498793 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:23:26 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:23:27 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:23:28 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:23:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:23:28 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:23:33 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 10/128 å®Œæˆ (20/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:23:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 19/128 å®Œæˆ (38/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:23:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 27/128 å®Œæˆ (54/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:23:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 34/128 å®Œæˆ (68/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:23:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 43/128 å®Œæˆ (86/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:23:59 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 52/128 å®Œæˆ (104/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:24:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 61/128 å®Œæˆ (122/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:24:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 69/128 å®Œæˆ (138/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:24:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 77/128 å®Œæˆ (154/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:24:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 85/128 å®Œæˆ (170/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:24:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 94/128 å®Œæˆ (188/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:24:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 104/128 å®Œæˆ (208/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:24:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 115/128 å®Œæˆ (230/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:24:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 125/128 å®Œæˆ (250/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:25:06 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:24:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 16x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:25:07 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:25:10 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:25:12 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:25:18 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 125.8s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:25:18 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:25:45 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:11 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4008)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4067)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4426)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4550)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4753)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4541)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:26:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4404)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:40 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3816)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3763)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4329)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4437)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4578)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4387)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:26:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4238)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:19 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4143)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3816)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4155)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4298)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4540)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4270)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:27:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4140)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:27:58 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4281)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4193)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4453)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4472)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4524)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4286)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4163)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:28:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.4465)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.4233)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:28:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.4471)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:28:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.4339)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:28:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.4266)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:28:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.4263)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.4290)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 26/64 å®Œæˆ (104/256 æ¡æ ·æœ¬, loss=0.4221)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:28:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.4199)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:29:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 31/64 å®Œæˆ (124/256 æ¡æ ·æœ¬, loss=0.4223)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:29:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 34/64 å®Œæˆ (136/256 æ¡æ ·æœ¬, loss=0.4243)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:29:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.4174)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:29:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.4312)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:29:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.4275)[32m [repeated 15x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:29:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.4196)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:29:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.4255)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:29:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.4290)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:29:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.4254)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:29:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 58/64 å®Œæˆ (232/256 æ¡æ ·æœ¬, loss=0.4325)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:30:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 60/64 å®Œæˆ (240/256 æ¡æ ·æœ¬, loss=0.4369)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:30:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 63/64 å®Œæˆ (252/256 æ¡æ ·æœ¬, loss=0.4238)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:30:09 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=1.33e-06, è€—æ—¶ 237.1s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:30:18 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:30:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.4282)[32m [repeated 7x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:30:09 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=1.33e-06, è€—æ—¶ 208.5s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:30:18 [executor_base.py:205] It took 0.343827 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:30:18 [executor_base.py:205] It took 0.369712 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:30:19 [executor_base.py:205] It took 0.379647 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 481x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:30:46 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:30:46 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:30:46 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:30:46 [executor_base.py:189] It took 0.480473 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:30:46 vtd_trainer_ray.py:1123] æ­¥éª¤ 2: {'vtd_loss': 0.43092492897994816, 'distill_loss': 0.43092492897994816, 'avg_se_weight': 0.769491015625, 'actor_lr': 1.3333333333333332e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.230508984375, 'step_time': 564.4064831733704, 'phase1_generate_time': 97.59149742126465, 'phase2_collect_time': 125.84819602966309, 'phase3_train_time': 299.6958885192871} [é‡‡æ ·=97.6s æ”¶é›†=125.8s è®­ç»ƒ=299.7s æ€»è®¡=564.4s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:30:46 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 2, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:30:46 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:30:46 [executor_base.py:205] It took 0.331833 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:30:46 [executor_base.py:205] It took 0.321995 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  16%|â–ˆâ–Œ        | 40/256 [01:36<06:14,  1.73s/it, est. speed input: 46.13 toks/s, output: 516.49 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:36<00:00,  1.73s/it, est. speed input: 361.02 toks/s, output: 5039.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:36<00:00,  2.66it/s, est. speed input: 361.02 toks/s, output: 5039.63 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:02, 52.62it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:02<00:00, 28.61it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:03<00:00, 20.02it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 48.71it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:08<23:51,  8.73s/it, est. speed input: 53.72 toks/s, output: 30.24 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:02<00:00, 27.85it/s][32m [repeated 61x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 48.41it/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:03<00:00, 22.80it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 49.14it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:09<24:58,  9.14s/it, est. speed input: 48.93 toks/s, output: 30.98 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–Œ         | 10/165 [00:14<01:29,  1.74it/s, est. speed input: 324.33 toks/s, output: 248.78 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 32/165 [00:19<00:55,  2.38it/s, est. speed input: 766.29 toks/s, output: 701.27 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 62/165 [00:24<00:24,  4.24it/s, est. speed input: 1174.26 toks/s, output: 1308.81 toks/s][32m [repeated 62x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 88/165 [00:29<00:12,  6.34it/s, est. speed input: 1397.79 toks/s, output: 1797.92 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 89/165 [00:34<00:33,  2.24it/s, est. speed input: 1211.29 toks/s, output: 1587.19 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [00:40<00:12,  4.43it/s, est. speed input: 1292.77 toks/s, output: 1933.29 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 124/165 [00:45<00:28,  1.46it/s, est. speed input: 1296.60 toks/s, output: 2083.53 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 130/165 [00:50<00:18,  1.86it/s, est. speed input: 1229.97 toks/s, output: 2171.47 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 134/165 [00:55<00:21,  1.41it/s, est. speed input: 1150.97 toks/s, output: 2074.66 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:56<00:00, 15.29it/s, est. speed input: 1370.29 toks/s, output: 2963.45 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:56<00:00, 15.29it/s, est. speed input: 1387.30 toks/s, output: 3035.58 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:56<00:00,  2.91it/s, est. speed input: 1387.30 toks/s, output: 3035.58 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:58<00:02,  4.80it/s, est. speed input: 1241.14 toks/s, output: 2583.84 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:58<00:00,  4.80it/s, est. speed input: 1360.46 toks/s, output: 3071.10 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:58<00:00,  2.81it/s, est. speed input: 1360.46 toks/s, output: 3071.10 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:31:49 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:30:46 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:30:46 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:30:46 [executor_base.py:189] It took 0.484522 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:30:47 [executor_base.py:205] It took 0.352262 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:31:50 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 562/660 = 85.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:31:50 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:31:51 [executor_base.py:205] It took 0.401253 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 132/165 [00:59<00:37,  1.12s/it, est. speed input: 1069.35 toks/s, output: 1997.28 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:02, 59.16it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:58<00:00, 13.58it/s, est. speed input: 1308.41 toks/s, output: 2865.04 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:58<00:00, 13.58it/s, est. speed input: 1349.03 toks/s, output: 3038.39 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:58<00:00,  2.80it/s, est. speed input: 1349.03 toks/s, output: 3038.39 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:01<00:00, 81.82it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 81.48it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.12it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:59<00:00,  1.12s/it, est. speed input: 1340.34 toks/s, output: 3132.36 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:59<00:00,  2.78it/s, est. speed input: 1340.34 toks/s, output: 3132.36 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:09<27:10,  9.94s/it, est. speed input: 45.47 toks/s, output: 27.36 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/164 [00:01<00:00, 83.93it/s][32m [repeated 59x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 158/164 [00:01<00:00, 82.84it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 82.94it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:10<28:34, 10.52s/it, est. speed input: 43.07 toks/s, output: 26.53 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   7%|â–‹         | 11/165 [00:15<01:10,  2.18it/s, est. speed input: 325.14 toks/s, output: 261.19 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 36/165 [00:21<00:57,  2.26it/s, est. speed input: 798.63 toks/s, output: 722.83 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 64/164 [00:26<00:11,  8.74it/s, est. speed input: 1158.63 toks/s, output: 1369.58 toks/s][32m [repeated 71x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 81/165 [00:31<00:33,  2.50it/s, est. speed input: 1228.86 toks/s, output: 1548.43 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 85/165 [00:36<00:28,  2.84it/s, est. speed input: 1104.64 toks/s, output: 1582.76 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 111/165 [00:41<00:23,  2.31it/s, est. speed input: 1272.81 toks/s, output: 1927.51 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [00:47<00:24,  1.74it/s, est. speed input: 1238.53 toks/s, output: 2032.45 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [00:53<00:29,  1.29it/s, est. speed input: 1142.95 toks/s, output: 1911.00 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:58<00:03,  4.16it/s, est. speed input: 1247.41 toks/s, output: 2552.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:58<00:00,  4.16it/s, est. speed input: 1364.94 toks/s, output: 3041.16 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:58<00:00,  2.83it/s, est. speed input: 1364.94 toks/s, output: 3041.16 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 148/164 [00:58<00:03,  4.17it/s, est. speed input: 1217.04 toks/s, output: 2446.99 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:32:54 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:31:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:31:50 [gpu_worker.py:117] Sleep mode freed 62.11 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:31:50 [executor_base.py:189] It took 0.493305 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:31:51 [executor_base.py:205] It took 0.376635 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:00<00:00,  2.00it/s, est. speed input: 1309.93 toks/s, output: 3141.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:00<00:00,  2.71it/s, est. speed input: 1309.93 toks/s, output: 3141.23 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:32:54 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1141/1319 = 86.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:32:54 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 2 å®Œæˆ: å‡†ç¡®çŽ‡ 86.5% (1141/1319), è€—æ—¶ 128.0s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:32:54 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_2.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:32:54 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   2%|â–         | 2/89 [25:33<18:12:58, 753.78s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:32:55 [executor_base.py:205] It took 0.335997 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  23%|â–ˆâ–ˆâ–Ž       | 15/64 [00:00<00:00, 107.33it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 147.09it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:00<00:00, 150.06it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 143.41it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [01:00<00:00, 12.62it/s, est. speed input: 1263.19 toks/s, output: 2718.62 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:00<00:00, 12.62it/s, est. speed input: 1319.85 toks/s, output: 2954.69 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:00<00:00,  2.72it/s, est. speed input: 1319.85 toks/s, output: 2954.69 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:27<28:26,  6.77s/it, est. speed input: 15.80 toks/s, output: 73.44 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [00:00<00:00, 139.36it/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:00<00:00, 152.47it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 146.25it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:37<38:57,  9.27s/it, est. speed input: 9.38 toks/s, output: 79.90 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:40<17:41,  4.28s/it, est. speed input: 18.39 toks/s, output: 146.92 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:46<49:03, 11.68s/it, est. speed input: 9.08 toks/s, output: 70.65 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [00:47<12:41,  3.12s/it, est. speed input: 22.21 toks/s, output: 193.85 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [00:52<09:45,  2.44s/it, est. speed input: 29.94 toks/s, output: 248.25 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:58<27:12,  6.58s/it, est. speed input: 13.14 toks/s, output: 128.73 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:05<06:06,  1.61s/it, est. speed input: 42.40 toks/s, output: 390.50 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [01:12<04:29,  1.22s/it, est. speed input: 50.99 toks/s, output: 496.73 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:23<09:08,  2.36s/it, est. speed input: 26.33 toks/s, output: 363.25 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 56/256 [01:31<03:22,  1.01s/it, est. speed input: 70.99 toks/s, output: 716.77 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:36<11:13,  2.90s/it, est. speed input: 24.46 toks/s, output: 298.87 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 152/256 [01:37<00:11,  9.26it/s, est. speed input: 217.72 toks/s, output: 2660.84 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:37<00:00,  9.26it/s, est. speed input: 367.33 toks/s, output: 4832.40 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:37<00:00,  2.63it/s, est. speed input: 367.33 toks/s, output: 4832.40 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 248/256 [01:38<00:00, 12.24it/s, est. speed input: 347.73 toks/s, output: 4827.26 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00, 12.24it/s, est. speed input: 360.91 toks/s, output: 4992.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  2.59it/s, est. speed input: 360.91 toks/s, output: 4992.93 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:34:35 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:32:54 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:32:54 [gpu_worker.py:117] Sleep mode freed 62.16 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:32:54 [executor_base.py:189] It took 0.485092 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:32:55 [executor_base.py:205] It took 0.318920 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:34:36 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:34:36 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:34:50 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.212, å¹³å‡æƒé‡=0.788
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:34:35 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:34:36 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:34:36 [gpu_worker.py:117] Sleep mode freed 62.66 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:34:36 [executor_base.py:189] It took 0.738300 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:35:04 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:35:04 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:35:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:35:05 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:35:05 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:35:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:35:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 16/128 å®Œæˆ (32/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:35:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 24/128 å®Œæˆ (48/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:35:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 35/128 å®Œæˆ (70/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:35:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 43/128 å®Œæˆ (86/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:35:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 52/128 å®Œæˆ (104/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:35:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 59/128 å®Œæˆ (118/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:35:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 67/128 å®Œæˆ (134/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:35:53 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 77/128 å®Œæˆ (154/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:35:59 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 87/128 å®Œæˆ (174/256 æ¡åºåˆ—)[32m [repeated 43x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:36:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:36:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 104/128 å®Œæˆ (208/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:36:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:36:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 120/128 å®Œæˆ (240/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:36:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:36:45 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:36:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:36:46 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:36:48 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:36:50 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:36:57 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 127.1s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:36:57 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:37:23 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:37:52 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:37:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2540)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:37:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3146)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:37:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3639)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:37:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3788)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:37:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3864)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:37:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4093)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:38:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4344)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:25 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2622)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3362)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3916)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4039)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4170)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4148)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:38:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4345)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:11 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2472)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3147)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3629)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3730)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3910)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3958)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:39:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4151)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:17 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2397)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3200)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3814)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3908)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3986)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4086)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4300)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:40:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.4441)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:40:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.4425)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:40:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.4282)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:40:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.4237)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:40:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.4460)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:40:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.4411)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:41:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.4325)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:41:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.4287)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:41:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.4203)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:41:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.4364)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:41:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.4174)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:41:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.4136)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:41:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.4126)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:41:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 45/64 å®Œæˆ (180/256 æ¡æ ·æœ¬, loss=0.4133)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:41:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.4093)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:42:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3969)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:42:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 54/64 å®Œæˆ (216/256 æ¡æ ·æœ¬, loss=0.4040)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:42:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3992)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:42:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3980)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:42:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.4024)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:42:31 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.00e-06, è€—æ—¶ 279.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:42:40 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:42:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3975)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:42:31 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.00e-06, è€—æ—¶ 246.7s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:42:40 [executor_base.py:205] It took 0.334368 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:42:40 [executor_base.py:205] It took 0.360881 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:42:40 [executor_base.py:205] It took 0.347641 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:43:08 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 428x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:43:10 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:43:10 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:43:10 [executor_base.py:189] It took 1.863748 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:43:10 vtd_trainer_ray.py:1123] æ­¥éª¤ 3: {'vtd_loss': 0.39979358622804284, 'distill_loss': 0.39979358622804284, 'avg_se_weight': 0.78779296875, 'actor_lr': 2e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.21220703125, 'step_time': 615.6077091693878, 'phase1_generate_time': 102.04564547538757, 'phase2_collect_time': 127.09349822998047, 'phase3_train_time': 343.4098479747772} [é‡‡æ ·=102.0s æ”¶é›†=127.1s è®­ç»ƒ=343.4s æ€»è®¡=615.6s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:44:00 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 3, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:44:00 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:43:08 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:43:10 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:43:10 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:43:10 [executor_base.py:189] It took 1.908229 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:44:00 [executor_base.py:205] It took 0.381081 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:44:00 [executor_base.py:205] It took 0.363397 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 148/256 [01:39<00:11,  9.38it/s, est. speed input: 185.76 toks/s, output: 2821.56 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 156/256 [01:38<00:12,  7.77it/s, est. speed input: 200.41 toks/s, output: 2990.41 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  7.77it/s, est. speed input: 338.23 toks/s, output: 5046.15 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  2.60it/s, est. speed input: 338.23 toks/s, output: 5046.15 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 248/256 [01:39<00:00, 19.67it/s, est. speed input: 326.73 toks/s, output: 4845.00 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:39<00:00, 19.67it/s, est. speed input: 334.81 toks/s, output: 5008.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:39<00:00,  2.56it/s, est. speed input: 334.81 toks/s, output: 5008.98 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   2%|â–         | 3/165 [00:00<00:11, 14.33it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:03<00:00, 72.65it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:03<00:00, 70.66it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 45.89it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:12<34:10, 12.50s/it, est. speed input: 37.51 toks/s, output: 26.40 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [00:03<00:00, 81.51it/s][32m [repeated 76x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 46.02it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:03<00:00, 70.91it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 45.96it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:12<34:31, 12.63s/it, est. speed input: 36.73 toks/s, output: 26.68 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–Œ         | 10/165 [00:18<02:25,  1.07it/s, est. speed input: 252.38 toks/s, output: 240.28 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 13/165 [00:24<01:40,  1.51it/s, est. speed input: 249.78 toks/s, output: 293.70 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 34/165 [00:29<00:45,  2.89it/s, est. speed input: 543.27 toks/s, output: 712.40 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 37/165 [00:34<00:49,  2.58it/s, est. speed input: 502.01 toks/s, output: 749.07 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 54/165 [00:39<00:27,  4.07it/s, est. speed input: 641.63 toks/s, output: 1042.08 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 68/165 [00:44<02:09,  1.33s/it, est. speed input: 715.77 toks/s, output: 1190.10 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 83/165 [00:50<00:37,  2.20it/s, est. speed input: 778.09 toks/s, output: 1454.01 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 83/165 [00:55<00:42,  1.94it/s, est. speed input: 709.16 toks/s, output: 1473.34 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 96/165 [01:00<00:21,  3.26it/s, est. speed input: 753.76 toks/s, output: 1700.36 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [01:05<00:39,  1.57it/s, est. speed input: 749.73 toks/s, output: 1685.42 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [01:07<00:00, 42.94it/s, est. speed input: 1124.48 toks/s, output: 3200.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 42.94it/s, est. speed input: 1161.21 toks/s, output: 3351.72 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1161.21 toks/s, output: 3351.72 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 134/165 [01:09<00:02, 11.47it/s, est. speed input: 928.71 toks/s, output: 2572.04 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00, 11.47it/s, est. speed input: 1146.94 toks/s, output: 3485.25 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  2.38it/s, est. speed input: 1146.94 toks/s, output: 3485.25 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 137/165 [01:10<00:01, 17.09it/s, est. speed input: 934.03 toks/s, output: 2672.97 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 25.50it/s, est. speed input: 1124.60 toks/s, output: 3475.56 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.33it/s, est. speed input: 1124.60 toks/s, output: 3475.56 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:45:15 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:44:00 [executor_base.py:205] It took 0.355885 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:45:15 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:45:15 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:45:15 [gpu_worker.py:117] Sleep mode freed 62.27 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:45:15 [executor_base.py:189] It took 0.487114 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:45:16 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 533/660 = 80.8%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:45:16 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:45:16 [executor_base.py:205] It took 0.330503 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 64.93it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [01:08<00:00, 33.09it/s, est. speed input: 1117.67 toks/s, output: 3268.42 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 33.09it/s, est. speed input: 1159.69 toks/s, output: 3447.08 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.40it/s, est. speed input: 1159.69 toks/s, output: 3447.08 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:02<00:00, 80.99it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 80.49it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 158/164 [00:01<00:00, 78.95it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 80.08it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:10<29:39, 10.92s/it, est. speed input: 43.70 toks/s, output: 26.20 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/164 [00:01<00:00, 78.97it/s][32m [repeated 60x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 81.12it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.66it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 2/165 [00:16<20:42,  7.62s/it, est. speed input: 54.03 toks/s, output: 45.97 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 8/165 [00:21<03:02,  1.16s/it, est. speed input: 168.67 toks/s, output: 189.89 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  14%|â–ˆâ–        | 23/165 [00:27<00:37,  3.74it/s, est. speed input: 399.52 toks/s, output: 521.76 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  18%|â–ˆâ–Š        | 30/165 [00:32<01:21,  1.66it/s, est. speed input: 440.89 toks/s, output: 610.22 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–       | 40/165 [00:37<01:11,  1.75it/s, est. speed input: 507.81 toks/s, output: 751.54 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 59/164 [00:42<01:14,  1.41it/s, est. speed input: 646.88 toks/s, output: 1133.12 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 73/165 [00:48<00:30,  3.05it/s, est. speed input: 715.25 toks/s, output: 1351.88 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 69/165 [00:53<00:46,  2.08it/s, est. speed input: 610.96 toks/s, output: 1264.59 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 77/165 [00:58<00:44,  1.98it/s, est. speed input: 622.45 toks/s, output: 1360.84 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 86/165 [01:03<00:55,  1.44it/s, est. speed input: 639.98 toks/s, output: 1483.87 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 115/165 [01:09<00:39,  1.27it/s, est. speed input: 792.52 toks/s, output: 1944.78 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 160/164 [01:10<00:00, 33.74it/s, est. speed input: 1098.72 toks/s, output: 3213.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:10<00:00, 33.74it/s, est. speed input: 1127.36 toks/s, output: 3330.20 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:10<00:00,  2.34it/s, est. speed input: 1127.36 toks/s, output: 3330.20 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 13.87it/s, est. speed input: 1124.80 toks/s, output: 3347.36 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.33it/s, est. speed input: 1124.80 toks/s, output: 3347.36 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 141/165 [01:11<00:00, 39.45it/s, est. speed input: 943.53 toks/s, output: 2845.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00, 39.45it/s, est. speed input: 1109.66 toks/s, output: 3529.04 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00,  2.30it/s, est. speed input: 1109.66 toks/s, output: 3529.04 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:45:16 [executor_base.py:205] It took 0.329505 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:46:30 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:45:15 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:45:15 [gpu_worker.py:117] Sleep mode freed 62.11 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:45:15 [executor_base.py:189] It took 0.531902 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:46:31 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1079/1319 = 81.8%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:46:31 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 3 å®Œæˆ: å‡†ç¡®çŽ‡ 81.8% (1079/1319), è€—æ—¶ 151.4s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:46:31 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_3.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:46:31 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   3%|â–Ž         | 3/89 [39:11<18:41:54, 782.73s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:46:32 [executor_base.py:205] It took 0.330419 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:00<00:00, 124.14it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:00<00:00, 155.19it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 149.77it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 155.19it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:44<46:42, 11.12s/it, est. speed input: 7.46 toks/s, output: 77.03 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00,  8.60it/s, est. speed input: 1126.90 toks/s, output: 3360.21 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00,  2.32it/s, est. speed input: 1126.90 toks/s, output: 3360.21 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [00:00<00:00, 150.69it/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:00<00:00, 155.36it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 169.02it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:56<59:02, 14.06s/it, est. speed input: 7.33 toks/s, output: 71.57 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:16<23:18,  5.73s/it, est. speed input: 16.54 toks/s, output: 152.93 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:28<43:41, 10.57s/it, est. speed input: 10.73 toks/s, output: 113.56 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:39<46:02, 11.14s/it, est. speed input: 9.18 toks/s, output: 118.60 toks/s] 
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:43<24:34,  6.15s/it, est. speed input: 20.08 toks/s, output: 191.88 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 132/256 [01:43<00:44,  2.81it/s, est. speed input: 178.99 toks/s, output: 2466.75 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.81it/s, est. speed input: 355.01 toks/s, output: 4899.99 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 355.01 toks/s, output: 4899.99 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  1.89it/s, est. speed input: 329.01 toks/s, output: 4927.26 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.44it/s, est. speed input: 329.01 toks/s, output: 4927.26 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:46:32 [executor_base.py:205] It took 0.312000 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:48:17 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:46:31 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:46:31 [gpu_worker.py:117] Sleep mode freed 61.97 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:46:31 [executor_base.py:189] It took 0.492739 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:48:18 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:48:18 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:48:31 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.270, å¹³å‡æƒé‡=0.730
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:48:17 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:48:17 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:48:17 [gpu_worker.py:117] Sleep mode freed 62.40 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:48:17 [executor_base.py:189] It took 0.483955 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:48:48 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:48:48 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:48:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:48:49 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:48:49 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:48:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 21:48:59 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 16/128 å®Œæˆ (32/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:49:06 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:49:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 36/128 å®Œæˆ (72/256 æ¡åºåˆ—)[32m [repeated 44x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:49:18 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 21:49:23 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:49:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:49:34 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 70/128 å®Œæˆ (140/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:49:39 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 78/128 å®Œæˆ (156/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:49:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 88/128 å®Œæˆ (176/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:49:51 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 98/128 å®Œæˆ (196/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 21:49:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 107/128 å®Œæˆ (214/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:50:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 114/128 å®Œæˆ (228/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:50:06 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 121/128 å®Œæˆ (242/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:50:29 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 21:50:11 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:50:32 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:50:33 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:50:35 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:50:41 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 130.0s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:50:41 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:51:08 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:41 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2826)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3751)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3070)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3458)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3430)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3446)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:51:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3413)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:14 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2673)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3583)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3073)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3502)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3408)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3495)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:52:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3465)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:52:59 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:53:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2639)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:53:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3755)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:53:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3125)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:53:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3476)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:53:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3370)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:53:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3435)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:53:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3354)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:53:57 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:53:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2832)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3583)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3027)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3390)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3409)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3397)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3327)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:54:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3436)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3398)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3517)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:54:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 13/64 å®Œæˆ (52/256 æ¡æ ·æœ¬, loss=0.3414)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:54:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3510)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3563)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3572)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3651)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:54:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3646)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:55:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3672)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:55:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 34/64 å®Œæˆ (136/256 æ¡æ ·æœ¬, loss=0.3659)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:55:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3631)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:55:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3590)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:55:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3532)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:55:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3526)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 21:55:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3522)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:55:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3556)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:55:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3559)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:55:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3554)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:56:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3542)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 21:56:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3526)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:56:16 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.67e-06, è€—æ—¶ 274.6s
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 21:56:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3547)[32m [repeated 8x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:56:24 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:56:16 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.67e-06, è€—æ—¶ 241.9s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 21:56:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3609)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:56:25 [executor_base.py:205] It took 0.322419 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:56:25 [executor_base.py:205] It took 0.358919 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:56:25 [executor_base.py:205] It took 0.350912 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:56:53 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:56:53 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:56:53 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:56:53 [executor_base.py:189] It took 0.443769 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:56:53 vtd_trainer_ray.py:1123] æ­¥éª¤ 4: {'vtd_loss': 0.3547236626036465, 'distill_loss': 0.3547236626036465, 'avg_se_weight': 0.730383203125, 'actor_lr': 2.6666666666666664e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.269616796875, 'step_time': 622.0223133563995, 'phase1_generate_time': 106.18273329734802, 'phase2_collect_time': 129.97757935523987, 'phase3_train_time': 343.3338711261749} [é‡‡æ ·=106.2s æ”¶é›†=130.0s è®­ç»ƒ=343.3s æ€»è®¡=622.0s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:56:53 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 4, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:56:53 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:56:54 [executor_base.py:205] It took 0.342110 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:56:54 [executor_base.py:205] It took 0.343243 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:44<27:06,  6.67s/it, est. speed input: 14.67 toks/s, output: 190.75 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 160/256 [01:44<00:25,  3.76it/s, est. speed input: 194.85 toks/s, output: 3040.74 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  3.76it/s, est. speed input: 333.20 toks/s, output: 4911.96 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.44it/s, est. speed input: 333.20 toks/s, output: 4911.96 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:02, 61.10it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:03<00:00, 77.27it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:03<00:00, 81.83it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 45.10it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:10<27:45, 10.16s/it, est. speed input: 45.29 toks/s, output: 29.93 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 140/165 [00:03<00:00, 70.75it/s][32m [repeated 72x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 45.55it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:12<34:06, 12.48s/it, est. speed input: 37.18 toks/s, output: 25.64 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   4%|â–         | 7/165 [00:18<04:23,  1.67s/it, est. speed input: 174.85 toks/s, output: 153.34 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 21/165 [00:23<01:10,  2.05it/s, est. speed input: 412.43 toks/s, output: 461.17 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 32/165 [00:28<00:50,  2.62it/s, est. speed input: 514.47 toks/s, output: 646.49 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  29%|â–ˆâ–ˆâ–‰       | 48/165 [00:33<01:07,  1.72it/s, est. speed input: 666.10 toks/s, output: 879.48 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 62/165 [00:38<00:48,  2.13it/s, est. speed input: 751.53 toks/s, output: 1162.99 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:44<00:25,  2.40it/s, est. speed input: 1090.39 toks/s, output: 1945.12 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 94/165 [00:49<00:22,  3.15it/s, est. speed input: 896.36 toks/s, output: 1679.69 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 105/165 [00:54<00:20,  2.91it/s, est. speed input: 911.39 toks/s, output: 1821.36 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 124/165 [00:59<00:35,  1.17it/s, est. speed input: 982.78 toks/s, output: 1988.95 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 15.84it/s, est. speed input: 1229.50 toks/s, output: 3160.54 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.58it/s, est. speed input: 1229.50 toks/s, output: 3160.54 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [01:06<00:49,  1.04it/s, est. speed input: 817.61 toks/s, output: 1730.71 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 144/165 [01:07<00:01, 10.86it/s, est. speed input: 1021.68 toks/s, output: 2575.96 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 10.86it/s, est. speed input: 1172.10 toks/s, output: 3207.56 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1172.10 toks/s, output: 3207.56 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:07<00:00, 21.12it/s, est. speed input: 1079.05 toks/s, output: 2898.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 21.12it/s, est. speed input: 1173.59 toks/s, output: 3290.88 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1173.59 toks/s, output: 3290.88 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:58:06 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:56:53 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:56:53 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:56:53 [executor_base.py:189] It took 0.481857 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:56:54 [executor_base.py:205] It took 0.374323 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:58:07 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 536/660 = 81.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:58:07 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.12it/s, est. speed input: 1168.49 toks/s, output: 3230.73 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1168.49 toks/s, output: 3230.73 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:58:07 [executor_base.py:205] It took 0.359117 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:02, 57.47it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [01:08<00:22,  2.12it/s, est. speed input: 828.63 toks/s, output: 1823.01 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:03<00:00, 56.56it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [00:03<00:00, 52.71it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 46.10it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 146/164 [00:03<00:00, 40.94it/s][32m [repeated 71x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:08<24:13,  8.92s/it, est. speed input: 50.79 toks/s, output: 29.71 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 45.66it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:09<11:21,  4.21s/it, est. speed input: 94.64 toks/s, output: 56.89 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 2/165 [00:14<16:44,  6.16s/it, est. speed input: 62.76 toks/s, output: 54.89 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–Œ         | 9/165 [00:20<02:56,  1.13s/it, est. speed input: 212.08 toks/s, output: 210.38 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 22/165 [00:25<01:26,  1.66it/s, est. speed input: 395.61 toks/s, output: 467.82 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–ˆ       | 50/164 [00:30<00:18,  6.10it/s, est. speed input: 758.11 toks/s, output: 1092.11 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  40%|â–ˆâ–ˆâ–ˆâ–‰      | 65/164 [00:35<00:28,  3.43it/s, est. speed input: 853.78 toks/s, output: 1326.24 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 77/165 [00:41<00:16,  5.18it/s, est. speed input: 890.23 toks/s, output: 1529.95 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 86/165 [00:46<01:13,  1.07it/s, est. speed input: 875.13 toks/s, output: 1577.23 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 101/164 [00:51<00:36,  1.75it/s, est. speed input: 923.09 toks/s, output: 1772.13 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 110/165 [00:56<00:24,  2.23it/s, est. speed input: 924.51 toks/s, output: 1873.69 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [01:02<00:41,  1.16it/s, est. speed input: 898.31 toks/s, output: 1951.39 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/164 [01:07<00:00, 12.36it/s, est. speed input: 1091.93 toks/s, output: 2866.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00, 12.36it/s, est. speed input: 1174.47 toks/s, output: 3200.27 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00,  2.44it/s, est. speed input: 1174.47 toks/s, output: 3200.27 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 136/165 [01:07<00:05,  5.60it/s, est. speed input: 968.52 toks/s, output: 2378.76 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  5.60it/s, est. speed input: 1180.52 toks/s, output: 3256.02 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.45it/s, est. speed input: 1180.52 toks/s, output: 3256.02 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [01:07<00:01, 13.22it/s, est. speed input: 1078.61 toks/s, output: 2780.20 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 21:59:18 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:58:06 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:58:06 [gpu_worker.py:117] Sleep mode freed 62.18 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 21:58:06 [executor_base.py:189] It took 0.509254 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:58:07 [executor_base.py:205] It took 0.361018 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:59:19 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1085/1319 = 82.3%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:59:19 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 4 å®Œæˆ: å‡†ç¡®çŽ‡ 82.3% (1085/1319), è€—æ—¶ 145.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:59:19 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_4.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 21:59:19 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   4%|â–         | 4/89 [51:58<18:20:36, 776.90s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 21:59:20 [executor_base.py:205] It took 0.340714 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  19%|â–ˆâ–‰        | 12/64 [00:00<00:00, 94.59it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [00:00<00:00, 135.95it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 151.62it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 145.44it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:08<09:19,  2.22s/it, est. speed input: 31.53 toks/s, output: 83.56 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  1.22it/s, est. speed input: 1175.36 toks/s, output: 3295.49 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1175.36 toks/s, output: 3295.49 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:00<00:00, 138.18it/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [00:00<00:00, 155.50it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 149.56it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [00:14<03:29,  1.16it/s, est. speed input: 94.30 toks/s, output: 199.16 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [00:19<00:56,  3.94it/s, est. speed input: 152.27 toks/s, output: 518.07 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [00:24<02:20,  1.60it/s, est. speed input: 147.61 toks/s, output: 443.00 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [00:30<03:57,  1.01s/it, est. speed input: 62.83 toks/s, output: 286.88 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 68/256 [00:37<01:04,  2.93it/s, est. speed input: 229.62 toks/s, output: 866.70 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 84/256 [00:43<01:27,  1.96it/s, est. speed input: 241.71 toks/s, output: 1009.17 toks/s][32m [repeated 14x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [00:50<03:16,  1.08it/s, est. speed input: 97.46 toks/s, output: 541.07 toks/s][32m [repeated 14x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–Œ       | 64/256 [00:58<01:50,  1.74it/s, est. speed input: 134.80 toks/s, output: 799.72 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 104/256 [01:04<02:30,  1.01it/s, est. speed input: 199.20 toks/s, output: 931.10 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 108/256 [01:10<03:38,  1.47s/it, est. speed input: 174.69 toks/s, output: 832.36 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:10<00:00,  1.47it/s, est. speed input: 504.83 toks/s, output: 3616.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:10<00:00,  3.62it/s, est. speed input: 504.83 toks/s, output: 3616.78 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 128/256 [01:12<00:59,  2.17it/s, est. speed input: 230.83 toks/s, output: 1221.36 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:12<00:00,  2.17it/s, est. speed input: 491.91 toks/s, output: 3736.02 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:12<00:00,  3.53it/s, est. speed input: 491.91 toks/s, output: 3736.02 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:00:35 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:59:19 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:59:19 [gpu_worker.py:117] Sleep mode freed 62.48 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:59:19 [executor_base.py:189] It took 0.498359 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 21:59:20 [executor_base.py:205] It took 0.318554 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:00:35 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:00:35 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:00:49 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.258, å¹³å‡æƒé‡=0.742
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:00:35 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:00:35 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:00:35 [gpu_worker.py:117] Sleep mode freed 62.64 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:00:35 [executor_base.py:189] It took 0.476094 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:01:00 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:01:00 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:01:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:01:00 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:01:00 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:01:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:01:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 17/128 å®Œæˆ (34/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:01:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 28/128 å®Œæˆ (56/256 æ¡åºåˆ—)[32m [repeated 45x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:01:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 37/128 å®Œæˆ (74/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:01:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:01:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 54/128 å®Œæˆ (108/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:01:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 44x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:01:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 74/128 å®Œæˆ (148/256 æ¡åºåˆ—)[32m [repeated 45x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:01:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 83/128 å®Œæˆ (166/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:01:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 92/128 å®Œæˆ (184/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:01:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 101/128 å®Œæˆ (202/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:02:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 43x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:02:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 120/128 å®Œæˆ (240/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:02:13 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 127/128 å®Œæˆ (254/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:02:22 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:02:13 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:02:24 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:02:25 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:02:25 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:02:28 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 99.4s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:02:28 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:02:55 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:19 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2026)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.1488)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.1514)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.1845)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2219)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2318)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:03:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2418)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:41 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2788)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2502)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2619)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2684)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2886)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2708)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:03:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2623)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:06 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2231)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2314)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2640)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2829)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2754)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3774)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:04:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3630)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:33 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2216)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2012)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2173)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2478)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2342)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2407)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2445)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:04:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.2646)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.2646)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3230)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:04:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3026)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:05:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.2954)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:05:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3105)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:05:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.2888)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:05:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 26/64 å®Œæˆ (104/256 æ¡æ ·æœ¬, loss=0.2839)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:05:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3506)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:05:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3212)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:05:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3331)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:05:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3372)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:05:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3468)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:05:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3116)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:06:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 45/64 å®Œæˆ (180/256 æ¡æ ·æœ¬, loss=0.2976)[32m [repeated 15x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:06:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.3171)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:06:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3033)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:06:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3253)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:06:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3077)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:06:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3009)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:06:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3171)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:06:46 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=3.00e-06, è€—æ—¶ 207.2s
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:06:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3160)[32m [repeated 9x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:06:55 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:06:46 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=3.00e-06, è€—æ—¶ 185.5s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:06:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3107)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:06:56 [executor_base.py:205] It took 0.328192 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:06:56 [executor_base.py:205] It took 0.342158 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:06:56 [executor_base.py:205] It took 0.340435 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:07:24 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:07:24 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:07:24 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:07:24 [executor_base.py:189] It took 0.461551 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:07:24 vtd_trainer_ray.py:1123] æ­¥éª¤ 5: {'vtd_loss': 0.31600177090149373, 'distill_loss': 0.31600177090149373, 'avg_se_weight': 0.741680078125, 'actor_lr': 2.9997681261994274e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.258319921875, 'step_time': 485.1948959827423, 'phase1_generate_time': 75.80847835540771, 'phase2_collect_time': 99.39486932754517, 'phase3_train_time': 267.02049469947815} [é‡‡æ ·=75.8s æ”¶é›†=99.4s è®­ç»ƒ=267.0s æ€»è®¡=485.2s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:07:24 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 5, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:07:24 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:07:25 [executor_base.py:205] It took 0.333994 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  34%|â–ˆâ–ˆâ–ˆâ–      | 88/256 [01:14<01:18,  2.14it/s, est. speed input: 156.60 toks/s, output: 971.56 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:14<00:00,  2.14it/s, est. speed input: 456.45 toks/s, output: 4228.90 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:14<00:00,  3.44it/s, est. speed input: 456.45 toks/s, output: 4228.90 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:07:25 [executor_base.py:205] It took 0.345521 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:02, 54.42it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:03<00:00, 73.14it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:03<00:00, 76.41it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.59it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:10<28:08, 10.30s/it, est. speed input: 45.06 toks/s, output: 29.71 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:03<00:00, 71.55it/s][32m [repeated 76x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:03<00:00, 76.64it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [00:03<00:00, 74.14it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.69it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/165 [00:14<18:21,  6.76s/it, est. speed input: 63.53 toks/s, output: 48.44 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 3/165 [00:19<13:27,  4.98s/it, est. speed input: 70.18 toks/s, output: 73.23 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  10%|â–‰         | 16/165 [00:25<01:53,  1.32it/s, est. speed input: 291.98 toks/s, output: 342.60 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  18%|â–ˆâ–Š        | 29/165 [00:30<00:35,  3.79it/s, est. speed input: 444.50 toks/s, output: 630.76 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–Ž       | 39/165 [00:35<00:38,  3.24it/s, est. speed input: 513.99 toks/s, output: 789.40 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  29%|â–ˆâ–ˆâ–‰       | 48/165 [00:40<01:31,  1.28it/s, est. speed input: 553.62 toks/s, output: 912.84 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 75/165 [00:46<00:53,  1.70it/s, est. speed input: 762.66 toks/s, output: 1423.49 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 82/165 [00:51<00:17,  4.77it/s, est. speed input: 752.31 toks/s, output: 1533.34 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 89/165 [00:56<00:27,  2.81it/s, est. speed input: 747.98 toks/s, output: 1601.84 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 102/165 [01:01<00:27,  2.33it/s, est. speed input: 787.83 toks/s, output: 1805.94 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 108/165 [01:07<00:54,  1.05it/s, est. speed input: 765.16 toks/s, output: 1803.69 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [01:09<00:00, 36.52it/s, est. speed input: 1091.21 toks/s, output: 3122.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00, 36.52it/s, est. speed input: 1125.97 toks/s, output: 3268.90 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  2.36it/s, est. speed input: 1125.97 toks/s, output: 3268.90 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [01:10<00:00, 48.40it/s, est. speed input: 1085.16 toks/s, output: 3129.42 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 48.40it/s, est. speed input: 1125.93 toks/s, output: 3302.40 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.33it/s, est. speed input: 1125.93 toks/s, output: 3302.40 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:08:40 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:07:24 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:07:24 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:07:24 [executor_base.py:189] It took 0.484489 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:07:25 [executor_base.py:205] It took 0.351087 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:08:42 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 542/660 = 82.1%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:08:42 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 125/165 [01:11<00:03, 10.22it/s, est. speed input: 841.35 toks/s, output: 2207.77 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:08:42 [executor_base.py:205] It took 0.372352 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:03, 43.88it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [01:10<00:00, 31.62it/s, est. speed input: 1061.24 toks/s, output: 3091.17 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 31.62it/s, est. speed input: 1122.73 toks/s, output: 3350.32 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.33it/s, est. speed input: 1122.73 toks/s, output: 3350.32 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:02<00:00, 81.53it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00, 10.22it/s, est. speed input: 1117.83 toks/s, output: 3355.62 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00,  2.32it/s, est. speed input: 1117.83 toks/s, output: 3355.62 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:01<00:00, 81.72it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.67it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:13<37:31, 13.81s/it, est. speed input: 34.53 toks/s, output: 26.71 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/164 [00:01<00:00, 78.69it/s][32m [repeated 60x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 78.82it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:02<00:00, 86.79it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 79.90it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:13<15:37,  5.79s/it, est. speed input: 66.52 toks/s, output: 53.21 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 3/165 [00:19<13:39,  5.06s/it, est. speed input: 74.49 toks/s, output: 72.13 toks/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 8/165 [00:24<04:07,  1.57s/it, est. speed input: 149.16 toks/s, output: 175.33 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  15%|â–ˆâ–Œ        | 25/164 [00:30<00:52,  2.67it/s, est. speed input: 383.00 toks/s, output: 543.35 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–Œ       | 42/165 [00:35<00:23,  5.28it/s, est. speed input: 556.96 toks/s, output: 891.13 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 45/165 [00:40<00:24,  4.84it/s, est. speed input: 518.26 toks/s, output: 873.01 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 74/165 [00:45<00:34,  2.67it/s, est. speed input: 766.87 toks/s, output: 1437.99 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 78/165 [00:51<01:09,  1.25it/s, est. speed input: 715.29 toks/s, output: 1395.89 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:56<00:24,  2.66it/s, est. speed input: 847.87 toks/s, output: 1819.90 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 112/165 [01:01<00:10,  4.88it/s, est. speed input: 863.47 toks/s, output: 1972.72 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 116/165 [01:07<00:32,  1.53it/s, est. speed input: 826.18 toks/s, output: 2024.36 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [01:09<00:00, 20.17it/s, est. speed input: 1075.84 toks/s, output: 3017.57 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00, 20.17it/s, est. speed input: 1140.64 toks/s, output: 3280.38 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  2.36it/s, est. speed input: 1140.64 toks/s, output: 3280.38 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 14.55it/s, est. speed input: 1135.42 toks/s, output: 3357.81 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.34it/s, est. speed input: 1135.42 toks/s, output: 3357.81 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 139/165 [01:10<00:02, 12.29it/s, est. speed input: 944.17 toks/s, output: 2577.28 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 12.29it/s, est. speed input: 1127.15 toks/s, output: 3327.76 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.33it/s, est. speed input: 1127.15 toks/s, output: 3327.76 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 124/164 [01:12<00:07,  5.39it/s, est. speed input: 821.13 toks/s, output: 2115.29 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:09:57 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:08:40 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:08:40 [gpu_worker.py:117] Sleep mode freed 61.97 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:08:40 [executor_base.py:189] It took 0.508118 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:08:42 [executor_base.py:205] It took 0.365106 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:09:58 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1087/1319 = 82.4%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:09:58 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 5 å®Œæˆ: å‡†ç¡®çŽ‡ 82.4% (1087/1319), è€—æ—¶ 153.3s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:09:58 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_5.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:09:58 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   6%|â–Œ         | 5/89 [1:02:37<16:57:48, 727.00s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:09:58 [executor_base.py:205] It took 0.412297 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  22%|â–ˆâ–ˆâ–       | 14/64 [00:00<00:00, 108.72it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:00<00:00, 144.47it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 151.07it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:00<00:00, 152.50it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 164.43it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 153.18it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 144/164 [01:12<00:00, 25.47it/s, est. speed input: 953.42 toks/s, output: 2673.03 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:12<00:00, 25.47it/s, est. speed input: 1092.24 toks/s, output: 3238.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:12<00:00,  2.27it/s, est. speed input: 1092.24 toks/s, output: 3238.05 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:48<50:58, 12.14s/it, est. speed input: 6.10 toks/s, output: 59.24 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [00:00<00:00, 133.44it/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 130.30it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:54<23:25,  5.67s/it, est. speed input: 22.33 toks/s, output: 127.34 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:04<17:06,  4.21s/it, est. speed input: 23.63 toks/s, output: 159.56 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:09<33:28,  8.10s/it, est. speed input: 10.63 toks/s, output: 102.10 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:20<17:02,  4.26s/it, est. speed input: 18.16 toks/s, output: 165.84 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:25<05:55,  1.59s/it, est. speed input: 41.86 toks/s, output: 402.21 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:33<20:12,  5.05s/it, est. speed input: 21.55 toks/s, output: 184.04 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 124/256 [01:37<00:25,  5.21it/s, est. speed input: 173.10 toks/s, output: 2122.79 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:37<00:00,  5.21it/s, est. speed input: 346.06 toks/s, output: 4566.00 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:37<00:00,  2.62it/s, est. speed input: 346.06 toks/s, output: 4566.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  5.93it/s, est. speed input: 348.96 toks/s, output: 4613.14 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  2.61it/s, est. speed input: 348.96 toks/s, output: 4613.14 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:11:37 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:09:58 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:09:58 [gpu_worker.py:117] Sleep mode freed 62.23 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:09:58 [executor_base.py:189] It took 0.497941 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:09:58 [executor_base.py:205] It took 0.415121 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:11:39 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:11:39 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:11:54 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.257, å¹³å‡æƒé‡=0.743
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:11:37 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:11:39 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:11:39 [gpu_worker.py:117] Sleep mode freed 62.59 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:11:39 [executor_base.py:189] It took 2.076695 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:12:09 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:12:09 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:12:09 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:12:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:12:09 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:12:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:12:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:12:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:12:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 31/128 å®Œæˆ (62/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:12:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 38/128 å®Œæˆ (76/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:12:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:12:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:12:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 66/128 å®Œæˆ (132/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:12:55 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:13:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 78/128 å®Œæˆ (156/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:13:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 91/128 å®Œæˆ (182/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:13:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 101/128 å®Œæˆ (202/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:13:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 105/128 å®Œæˆ (210/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:13:22 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 112/128 å®Œæˆ (224/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:13:27 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 120/128 å®Œæˆ (240/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:13:48 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:13:32 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:13:50 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:13:51 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:13:52 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:13:58 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 124.7s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:13:58 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:14:25 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:14:57 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:14:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3742)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:14:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3761)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:15:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3027)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:15:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2902)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:15:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3226)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:15:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3290)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:15:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3253)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:28 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3741)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3792)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3022)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2881)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3178)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3143)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:15:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3131)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:10 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3365)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3162)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2570)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2677)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2992)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3115)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:16:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3169)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:45 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3753)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3536)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2881)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2715)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3047)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3132)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3100)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:16:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3370)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:16:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3207)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:17:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3489)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:17:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3606)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:17:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.3580)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:17:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3576)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:17:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.3624)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:17:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 26/64 å®Œæˆ (104/256 æ¡æ ·æœ¬, loss=0.3582)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:17:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3686)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:17:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3674)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:17:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3629)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:18:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 38/64 å®Œæˆ (152/256 æ¡æ ·æœ¬, loss=0.3829)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:18:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3775)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:18:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3631)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:18:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3633)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:18:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.3687)[32m [repeated 7x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:18:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3520)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:18:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 54/64 å®Œæˆ (216/256 æ¡æ ·æœ¬, loss=0.3658)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:18:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3665)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:18:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3619)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:18:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3531)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:19:01 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=3.00e-06, è€—æ—¶ 244.5s
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:19:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3622)[32m [repeated 9x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:19:10 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:19:01 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=3.00e-06, è€—æ—¶ 213.8s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:19:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3565)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:19:11 [executor_base.py:205] It took 0.357647 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:19:11 [executor_base.py:205] It took 0.363784 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:19:11 [executor_base.py:205] It took 0.348382 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:19:40 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 428x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:19:41 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:19:41 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.89 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:19:41 [executor_base.py:189] It took 1.009131 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:19:41 vtd_trainer_ray.py:1123] æ­¥éª¤ 6: {'vtd_loss': 0.36216721893288195, 'distill_loss': 0.36216721893288195, 'avg_se_weight': 0.74299609375, 'actor_lr': 2.9979136136826788e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.25700390625, 'step_time': 583.4082210063934, 'phase1_generate_time': 101.6419939994812, 'phase2_collect_time': 124.70979309082031, 'phase3_train_time': 311.96011447906494} [é‡‡æ ·=101.6s æ”¶é›†=124.7s è®­ç»ƒ=312.0s æ€»è®¡=583.4s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:20:33 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 6, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:20:33 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:19:40 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:19:41 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:19:41 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:19:41 [executor_base.py:189] It took 0.998991 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:20:33 [executor_base.py:205] It took 0.405174 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:38<14:19,  3.64s/it, est. speed input: 24.73 toks/s, output: 247.40 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:38<13:41,  3.48s/it, est. speed input: 22.50 toks/s, output: 255.18 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  3.48s/it, est. speed input: 354.49 toks/s, output: 4699.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  2.60it/s, est. speed input: 354.49 toks/s, output: 4699.43 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  3.64s/it, est. speed input: 377.15 toks/s, output: 4669.97 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:38<00:00,  2.60it/s, est. speed input: 377.15 toks/s, output: 4669.97 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:20:33 [executor_base.py:205] It took 0.417652 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   1%|          | 2/165 [00:00<00:10, 15.54it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:03<00:00, 76.72it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:03<00:00, 80.80it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.29it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:13<37:29, 13.71s/it, est. speed input: 32.81 toks/s, output: 26.76 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/165 [00:03<00:00, 80.54it/s][32m [repeated 78x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:03<00:00, 79.69it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:03<00:00, 77.66it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.87it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:16<44:51, 16.41s/it, est. speed input: 28.52 toks/s, output: 27.36 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/165 [00:21<10:28,  3.90s/it, est. speed input: 85.49 toks/s, output: 99.78 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   7%|â–‹         | 11/165 [00:26<03:01,  1.18s/it, est. speed input: 194.61 toks/s, output: 246.20 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  15%|â–ˆâ–Œ        | 25/165 [00:32<01:50,  1.26it/s, est. speed input: 361.54 toks/s, output: 523.54 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 31/165 [00:37<01:04,  2.09it/s, est. speed input: 387.76 toks/s, output: 642.13 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–‰       | 49/165 [00:42<00:36,  3.20it/s, est. speed input: 541.61 toks/s, output: 918.45 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 66/165 [00:47<00:22,  4.42it/s, est. speed input: 647.68 toks/s, output: 1238.60 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 74/165 [00:52<01:21,  1.12it/s, est. speed input: 655.80 toks/s, output: 1319.58 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 80/165 [00:57<00:35,  2.36it/s, est. speed input: 653.56 toks/s, output: 1474.47 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 78/165 [01:03<00:46,  1.89it/s, est. speed input: 589.61 toks/s, output: 1377.81 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [01:08<01:12,  1.13s/it, est. speed input: 709.87 toks/s, output: 1674.97 toks/s][32m [repeated 16x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 105/165 [01:13<01:25,  1.43s/it, est. speed input: 683.88 toks/s, output: 1659.05 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [01:13<00:00, 24.95it/s, est. speed input: 1047.89 toks/s, output: 3176.73 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:13<00:00, 24.95it/s, est. speed input: 1080.49 toks/s, output: 3315.45 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:13<00:00,  2.24it/s, est. speed input: 1080.49 toks/s, output: 3315.45 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00, 20.93it/s, est. speed input: 1063.45 toks/s, output: 3326.74 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00,  2.23it/s, est. speed input: 1063.45 toks/s, output: 3326.74 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 139/165 [01:14<00:01, 17.83it/s, est. speed input: 896.23 toks/s, output: 2698.81 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00, 17.83it/s, est. speed input: 1064.14 toks/s, output: 3409.61 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00,  2.21it/s, est. speed input: 1064.14 toks/s, output: 3409.61 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:21:52 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:20:33 [executor_base.py:205] It took 0.369376 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:21:52 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:21:52 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:21:52 [gpu_worker.py:117] Sleep mode freed 61.87 GiB memory, 11.89 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:21:52 [executor_base.py:189] It took 0.516624 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:21:53 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 526/660 = 79.7%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:21:53 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:21:53 [executor_base.py:205] It took 0.346126 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   3%|â–Ž         | 5/165 [00:00<00:04, 35.67it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:02<00:00, 78.86it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:02<00:00, 93.32it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 78.83it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:12<35:04, 12.83s/it, est. speed input: 35.69 toks/s, output: 26.88 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00,  1.28it/s, est. speed input: 1062.79 toks/s, output: 3477.64 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00,  2.20it/s, est. speed input: 1062.79 toks/s, output: 3477.64 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:01<00:00, 80.11it/s][32m [repeated 60x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 79.04it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.70it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 76.63it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:18<49:27, 18.10s/it, est. speed input: 25.31 toks/s, output: 25.75 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 2/165 [00:18<21:36,  7.95s/it, est. speed input: 48.13 toks/s, output: 50.40 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 5/164 [00:24<06:48,  2.57s/it, est. speed input: 94.40 toks/s, output: 116.85 toks/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 8/165 [00:29<04:52,  1.87s/it, est. speed input: 125.52 toks/s, output: 170.45 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  18%|â–ˆâ–Š        | 29/165 [00:35<01:40,  1.35it/s, est. speed input: 380.70 toks/s, output: 592.48 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 34/165 [00:41<00:44,  2.95it/s, est. speed input: 390.28 toks/s, output: 691.10 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 44/165 [00:46<00:54,  2.23it/s, est. speed input: 451.34 toks/s, output: 853.49 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  34%|â–ˆâ–ˆâ–ˆâ–      | 56/165 [00:51<00:55,  1.96it/s, est. speed input: 517.65 toks/s, output: 1000.10 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 69/165 [00:56<01:06,  1.45it/s, est. speed input: 581.54 toks/s, output: 1264.20 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 74/164 [01:01<01:36,  1.07s/it, est. speed input: 567.42 toks/s, output: 1234.16 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 93/165 [01:06<00:32,  2.23it/s, est. speed input: 663.64 toks/s, output: 1608.82 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 100/165 [01:11<00:27,  2.35it/s, est. speed input: 665.67 toks/s, output: 1725.01 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [01:14<00:00, 26.92it/s, est. speed input: 963.63 toks/s, output: 2888.88 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00, 26.92it/s, est. speed input: 1076.83 toks/s, output: 3356.40 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00,  2.22it/s, est. speed input: 1076.83 toks/s, output: 3356.40 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:14<00:00, 34.26it/s, est. speed input: 977.80 toks/s, output: 3028.57 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00, 34.26it/s, est. speed input: 1063.65 toks/s, output: 3383.60 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:14<00:00,  2.20it/s, est. speed input: 1063.65 toks/s, output: 3383.60 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:21:53 [executor_base.py:205] It took 0.354001 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:23:10 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:21:52 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:21:52 [gpu_worker.py:117] Sleep mode freed 62.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:21:52 [executor_base.py:189] It took 0.517865 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:23:13 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1060/1319 = 80.4%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:23:13 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 6 å®Œæˆ: å‡†ç¡®çŽ‡ 80.4% (1060/1319), è€—æ—¶ 160.0s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:23:13 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_6.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:23:13 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   7%|â–‹         | 6/89 [1:15:52<17:17:38, 750.11s/it]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [01:14<00:38,  1.60it/s, est. speed input: 662.26 toks/s, output: 1757.11 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:23:13 [executor_base.py:205] It took 0.332061 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  27%|â–ˆâ–ˆâ–‹       | 17/64 [00:00<00:00, 169.84it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:00<00:00, 144.53it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 168.72it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 144.40it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 148/164 [01:14<00:00, 47.05it/s, est. speed input: 947.95 toks/s, output: 2957.46 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:14<00:00, 47.05it/s, est. speed input: 1055.13 toks/s, output: 3393.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:14<00:00,  2.19it/s, est. speed input: 1055.13 toks/s, output: 3393.31 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [01:15<00:00, 33.91it/s, est. speed input: 1035.79 toks/s, output: 3309.45 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:15<00:00, 33.91it/s, est. speed input: 1062.17 toks/s, output: 3418.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:15<00:00,  2.20it/s, est. speed input: 1062.17 toks/s, output: 3418.55 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:01<1:04:35, 15.38s/it, est. speed input: 4.23 toks/s, output: 78.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [00:00<00:00, 126.66it/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 146.03it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [01:10<1:14:11, 17.66s/it, est. speed input: 4.02 toks/s, output: 67.95 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:21<20:14,  4.98s/it, est. speed input: 15.09 toks/s, output: 177.68 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:30<24:09,  5.94s/it, est. speed input: 13.60 toks/s, output: 172.42 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:36<11:11,  2.85s/it, est. speed input: 22.91 toks/s, output: 296.10 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:49<13:57,  3.61s/it, est. speed input: 24.53 toks/s, output: 305.36 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:49<31:29,  7.74s/it, est. speed input: 11.54 toks/s, output: 165.09 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:49<00:00,  4.02it/s, est. speed input: 342.70 toks/s, output: 4581.11 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:49<00:00,  2.33it/s, est. speed input: 342.70 toks/s, output: 4581.11 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 180/256 [01:50<00:11,  6.54it/s, est. speed input: 206.06 toks/s, output: 3175.01 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:50<00:00,  6.54it/s, est. speed input: 297.63 toks/s, output: 4562.52 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:50<00:00,  2.31it/s, est. speed input: 297.63 toks/s, output: 4562.52 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:23:13 [executor_base.py:205] It took 0.349096 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:25:05 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:23:11 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:23:11 [gpu_worker.py:117] Sleep mode freed 62.05 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:23:11 [executor_base.py:189] It took 0.477180 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:25:05 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:25:05 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:25:19 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.213, å¹³å‡æƒé‡=0.787
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:25:05 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:25:05 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:25:05 [gpu_worker.py:117] Sleep mode freed 62.63 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:25:05 [executor_base.py:189] It took 0.462384 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:25:37 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:25:37 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:25:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:25:37 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:25:37 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:25:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 25x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:25:48 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:25:53 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 24/128 å®Œæˆ (48/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:25:58 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 33/128 å®Œæˆ (66/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:26:03 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 39/128 å®Œæˆ (78/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:26:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 47/128 å®Œæˆ (94/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:26:13 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:26:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 64/128 å®Œæˆ (128/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:26:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 71/128 å®Œæˆ (142/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:26:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 78/128 å®Œæˆ (156/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:26:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 87/128 å®Œæˆ (174/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:26:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:26:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 103/128 å®Œæˆ (206/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:26:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 111/128 å®Œæˆ (222/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:26:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 119/128 å®Œæˆ (238/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:27:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:27:19 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:27:03 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:27:20 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:27:23 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:27:25 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:27:31 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 132.4s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:27:31 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:27:58 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:32 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4423)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4089)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3680)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3654)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3866)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3565)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:28:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3646)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:14 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4182)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4229)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3801)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3748)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3930)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3654)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:29:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3736)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:02 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4680)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4734)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4146)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3964)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4131)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3835)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:30:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3902)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:30:49 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:30:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4698)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:30:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4259)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:30:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3854)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:30:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3753)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:31:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3907)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:31:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3641)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:31:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3728)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:31:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3824)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:31:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3675)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:31:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3570)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:31:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3726)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:31:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3726)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:31:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3773)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:31:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3827)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:31:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3882)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:32:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3836)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:32:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3845)[32m [repeated 15x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:32:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3889)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:32:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3867)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:32:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3861)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:32:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3901)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:32:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3865)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:32:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3873)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:32:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3818)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:32:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3802)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:32:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3786)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:33:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3787)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:33:07 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.99e-06, è€—æ—¶ 275.5s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:33:18 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:33:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3810)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:33:07 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.99e-06, è€—æ—¶ 232.6s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:33:18 [executor_base.py:205] It took 0.353872 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:33:18 [executor_base.py:205] It took 0.337525 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 22:33:18 [executor_base.py:205] It took 0.371216 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:33:46 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:33:47 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:33:47 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:33:47 [executor_base.py:189] It took 0.486928 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:33:47 vtd_trainer_ray.py:1123] æ­¥éª¤ 7: {'vtd_loss': 0.3717886037193239, 'distill_loss': 0.3717886037193239, 'avg_se_weight': 0.786632421875, 'actor_lr': 2.99420713665473e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.213367578125, 'step_time': 634.0203726291656, 'phase1_generate_time': 112.35187840461731, 'phase2_collect_time': 132.36009240150452, 'phase3_train_time': 346.03273940086365} [é‡‡æ ·=112.4s æ”¶é›†=132.4s è®­ç»ƒ=346.0s æ€»è®¡=634.0s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:33:47 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 7, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:33:47 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:33:47 [executor_base.py:205] It took 0.342787 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:33:47 [executor_base.py:205] It took 0.342345 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:50<19:08,  4.79s/it, est. speed input: 16.52 toks/s, output: 237.44 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:50<00:00,  4.79s/it, est. speed input: 308.68 toks/s, output: 4599.25 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:50<00:00,  2.31it/s, est. speed input: 308.68 toks/s, output: 4599.25 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 84/256 [01:50<02:02,  1.40it/s, est. speed input: 123.94 toks/s, output: 1528.26 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:50<00:00,  1.40it/s, est. speed input: 329.52 toks/s, output: 4618.51 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:50<00:00,  2.31it/s, est. speed input: 329.52 toks/s, output: 4618.51 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   3%|â–Ž         | 5/165 [00:00<00:03, 45.56it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:03<00:00, 32.23it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:03<00:00, 41.30it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.14it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:13<36:42, 13.43s/it, est. speed input: 34.55 toks/s, output: 26.28 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 146/165 [00:03<00:00, 33.89it/s][32m [repeated 77x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [00:03<00:00, 36.93it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [00:03<00:00, 45.67it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.52it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/165 [00:13<15:39,  5.77s/it, est. speed input: 66.95 toks/s, output: 52.13 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   4%|â–         | 7/165 [00:18<03:25,  1.30s/it, est. speed input: 172.61 toks/s, output: 174.30 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  10%|â–ˆ         | 17/165 [00:23<01:01,  2.41it/s, est. speed input: 331.20 toks/s, output: 376.29 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 28/165 [00:29<00:55,  2.46it/s, est. speed input: 449.08 toks/s, output: 571.23 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  16%|â–ˆâ–‹        | 27/165 [00:33<01:16,  1.81it/s, est. speed input: 383.88 toks/s, output: 552.65 toks/s]
Processed prompts:  17%|â–ˆâ–‹        | 28/165 [00:33<00:57,  2.39it/s, est. speed input: 396.98 toks/s, output: 576.90 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 36/165 [00:34<01:33,  1.38it/s, est. speed input: 487.20 toks/s, output: 716.46 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 58/165 [00:39<01:06,  1.60it/s, est. speed input: 681.06 toks/s, output: 1083.16 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 62/165 [00:45<00:29,  3.52it/s, est. speed input: 650.94 toks/s, output: 1145.56 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:50<00:59,  1.69it/s, est. speed input: 615.38 toks/s, output: 1167.51 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 74/165 [00:55<00:51,  1.77it/s, est. speed input: 636.45 toks/s, output: 1285.09 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 90/165 [01:01<01:03,  1.17it/s, est. speed input: 698.90 toks/s, output: 1490.02 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 99/165 [01:06<00:43,  1.51it/s, est. speed input: 711.31 toks/s, output: 1610.82 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:10<00:01, 12.87it/s, est. speed input: 1021.31 toks/s, output: 2880.89 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 12.87it/s, est. speed input: 1109.55 toks/s, output: 3254.35 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.32it/s, est. speed input: 1109.55 toks/s, output: 3254.35 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 108/165 [01:11<00:28,  2.03it/s, est. speed input: 722.84 toks/s, output: 1739.08 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:12<00:00, 23.09it/s, est. speed input: 1101.94 toks/s, output: 3324.94 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:12<00:00,  2.28it/s, est. speed input: 1101.94 toks/s, output: 3324.94 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:35:03 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:33:47 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:33:47 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:33:47 [executor_base.py:189] It took 0.475555 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:33:47 [executor_base.py:205] It took 0.340111 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:35:04 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 540/660 = 81.8%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:35:04 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:35:06 [executor_base.py:205] It took 1.885726 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:03, 48.74it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [01:12<00:00, 33.41it/s, est. speed input: 1097.56 toks/s, output: 3333.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:12<00:00, 33.41it/s, est. speed input: 1104.38 toks/s, output: 3362.21 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:12<00:00,  2.29it/s, est. speed input: 1104.38 toks/s, output: 3362.21 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [01:12<00:00, 32.94it/s, est. speed input: 983.56 toks/s, output: 2934.18 toks/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:01<00:00, 79.64it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:02<00:00, 77.28it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 75.71it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:12<00:00, 32.94it/s, est. speed input: 1098.95 toks/s, output: 3413.83 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:12<00:00,  2.28it/s, est. speed input: 1098.95 toks/s, output: 3413.83 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:02<00:00, 76.40it/s][32m [repeated 59x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:11<31:30, 11.60s/it, est. speed input: 41.12 toks/s, output: 24.66 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 79.52it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/164 [00:02<00:00, 73.35it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 77.01it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:13<37:27, 13.70s/it, est. speed input: 32.98 toks/s, output: 26.63 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 2/165 [00:18<23:43,  8.74s/it, est. speed input: 47.73 toks/s, output: 44.51 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 8/165 [00:24<04:36,  1.76s/it, est. speed input: 152.01 toks/s, output: 169.37 toks/s][32m [repeated 15x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 28/165 [00:29<00:32,  4.28it/s, est. speed input: 438.10 toks/s, output: 605.70 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 36/165 [00:34<01:12,  1.78it/s, est. speed input: 482.67 toks/s, output: 707.89 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–‰       | 49/165 [00:39<00:36,  3.14it/s, est. speed input: 576.77 toks/s, output: 929.67 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 73/165 [00:45<00:46,  1.96it/s, est. speed input: 761.96 toks/s, output: 1420.35 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 79/165 [00:50<00:28,  3.04it/s, est. speed input: 741.39 toks/s, output: 1426.31 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 79/165 [00:55<00:38,  2.22it/s, est. speed input: 671.44 toks/s, output: 1432.85 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 87/165 [01:01<00:56,  1.39it/s, est. speed input: 677.31 toks/s, output: 1508.79 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [01:06<00:39,  1.62it/s, est. speed input: 729.12 toks/s, output: 1747.98 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00, 28.28it/s, est. speed input: 1127.34 toks/s, output: 3353.54 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.32it/s, est. speed input: 1127.34 toks/s, output: 3353.54 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:11<00:00, 21.45it/s, est. speed input: 1024.72 toks/s, output: 2879.30 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 138/165 [01:11<00:02, 13.35it/s, est. speed input: 931.53 toks/s, output: 2485.20 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [01:11<00:00, 23.25it/s, est. speed input: 1064.24 toks/s, output: 3043.72 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [01:11<00:00, 21.26it/s, est. speed input: 1095.53 toks/s, output: 3173.20 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00, 21.26it/s, est. speed input: 1108.68 toks/s, output: 3230.24 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00,  2.30it/s, est. speed input: 1108.68 toks/s, output: 3230.24 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 135/164 [01:13<00:03,  9.66it/s, est. speed input: 880.68 toks/s, output: 2457.33 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:13<00:00,  9.66it/s, est. speed input: 1077.80 toks/s, output: 3265.58 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:13<00:00,  2.24it/s, est. speed input: 1077.80 toks/s, output: 3265.58 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:36:22 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:35:04 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:35:04 [gpu_worker.py:117] Sleep mode freed 62.26 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:35:04 [executor_base.py:189] It took 0.514780 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:35:06 [executor_base.py:205] It took 1.831611 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:36:23 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1080/1319 = 81.9%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:36:23 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 7 å®Œæˆ: å‡†ç¡®çŽ‡ 81.9% (1080/1319), è€—æ—¶ 156.2s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:36:23 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_7.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:36:23 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   8%|â–Š         | 7/89 [1:29:02<17:23:04, 763.22s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:36:23 [executor_base.py:205] It took 0.385434 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  27%|â–ˆâ–ˆâ–‹       | 17/64 [00:00<00:00, 130.46it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 177.59it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:00<00:00, 147.93it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 159.71it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:49<51:35, 12.28s/it, est. speed input: 9.28 toks/s, output: 68.35 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [01:13<00:00, 21.44it/s, est. speed input: 1000.60 toks/s, output: 3000.60 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:13<00:00, 21.44it/s, est. speed input: 1079.28 toks/s, output: 3332.81 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:13<00:00,  2.23it/s, est. speed input: 1079.28 toks/s, output: 3332.81 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:00<00:00, 144.85it/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 151.12it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:00<00:00, 132.80it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 154.84it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:55<57:52, 13.78s/it, est. speed input: 5.44 toks/s, output: 57.88 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:06<12:32,  3.08s/it, est. speed input: 21.34 toks/s, output: 207.98 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [01:10<1:14:03, 17.63s/it, est. speed input: 5.05 toks/s, output: 70.97 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:23<13:29,  3.43s/it, est. speed input: 26.42 toks/s, output: 264.82 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:28<05:03,  1.35s/it, est. speed input: 37.53 toks/s, output: 439.68 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  16%|â–ˆâ–Œ        | 40/256 [01:42<06:01,  1.67s/it, est. speed input: 39.99 toks/s, output: 507.00 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 148/256 [01:44<00:11,  9.70it/s, est. speed input: 189.11 toks/s, output: 2576.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  9.70it/s, est. speed input: 357.18 toks/s, output: 4696.95 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 357.18 toks/s, output: 4696.95 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  4.16it/s, est. speed input: 347.10 toks/s, output: 4819.60 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.43it/s, est. speed input: 347.10 toks/s, output: 4819.60 toks/s]
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 22:38:11 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:36:23 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:36:23 [gpu_worker.py:117] Sleep mode freed 62.08 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:36:23 [executor_base.py:189] It took 0.481435 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:36:23 [executor_base.py:205] It took 0.393105 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:38:12 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:38:12 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:38:26 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.241, å¹³å‡æƒé‡=0.759
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:38:11 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:38:12 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:38:12 [gpu_worker.py:117] Sleep mode freed 62.68 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:38:12 [executor_base.py:189] It took 0.518049 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:38:42 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:38:43 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:38:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:38:45 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:38:45 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:38:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 10/128 å®Œæˆ (20/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:38:55 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 17/128 å®Œæˆ (34/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:39:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:39:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:39:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 42/128 å®Œæˆ (84/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:39:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 50/128 å®Œæˆ (100/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:39:21 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:39:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:39:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:39:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 81/128 å®Œæˆ (162/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:39:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 88/128 å®Œæˆ (176/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:39:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 95/128 å®Œæˆ (190/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:39:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 104/128 å®Œæˆ (208/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:39:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:40:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 120/128 å®Œæˆ (240/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:40:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 127/128 å®Œæˆ (254/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:40:25 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:40:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 5x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:40:28 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:40:29 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:40:31 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:40:38 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 131.4s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:40:38 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:41:05 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:41 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3676)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2906)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2825)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3272)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3222)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3553)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:41:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3521)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:16 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3864)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2862)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2840)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3290)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3599)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3884)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:42:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3786)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:05 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3762)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2914)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2690)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3158)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3160)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3564)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:43:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3494)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:43:53 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:43:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3556)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:43:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2771)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:43:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2618)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3072)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3198)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3541)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3479)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:44:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3580)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3495)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:44:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3587)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3682)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:44:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3595)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:44:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3767)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:44:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3854)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:44:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3793)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3734)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:44:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 31/64 å®Œæˆ (124/256 æ¡æ ·æœ¬, loss=0.3818)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:45:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 34/64 å®Œæˆ (136/256 æ¡æ ·æœ¬, loss=0.3913)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:45:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3810)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:45:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3801)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:45:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3746)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:45:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3774)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:45:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 50/64 å®Œæˆ (200/256 æ¡æ ·æœ¬, loss=0.3819)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:45:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3749)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:45:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3804)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:46:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3866)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:46:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3861)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:46:11 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.99e-06, è€—æ—¶ 269.8s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:46:21 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:46:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3829)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:46:11 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.99e-06, è€—æ—¶ 234.6s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:46:22 [executor_base.py:205] It took 0.332410 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:46:22 [executor_base.py:205] It took 0.359012 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:46:22 [executor_base.py:205] It took 0.351343 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 481x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:46:50 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:46:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:46:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:46:50 [executor_base.py:189] It took 0.471393 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:46:51 vtd_trainer_ray.py:1123] æ­¥éª¤ 8: {'vtd_loss': 0.37364704138599336, 'distill_loss': 0.37364704138599336, 'avg_se_weight': 0.758875390625, 'actor_lr': 2.988653787625848e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.241124609375, 'step_time': 627.4816393852234, 'phase1_generate_time': 108.97878360748291, 'phase2_collect_time': 131.40920567512512, 'phase3_train_time': 343.6149592399597} [é‡‡æ ·=109.0s æ”¶é›†=131.4s è®­ç»ƒ=343.6s æ€»è®¡=627.5s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:46:51 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 8, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:46:51 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:46:51 [executor_base.py:205] It took 0.361429 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [01:47<1:52:49, 26.86s/it, est. speed input: 3.76 toks/s, output: 76.24 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 152/256 [01:46<00:15,  6.64it/s, est. speed input: 194.14 toks/s, output: 2814.32 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  6.64it/s, est. speed input: 311.82 toks/s, output: 4783.44 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.39it/s, est. speed input: 311.82 toks/s, output: 4783.44 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:47<00:00, 26.86s/it, est. speed input: 339.70 toks/s, output: 4818.14 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:47<00:00,  2.38it/s, est. speed input: 339.70 toks/s, output: 4818.14 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:46:51 [executor_base.py:205] It took 0.355467 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   6%|â–Œ         | 10/165 [00:00<00:02, 73.81it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:01<00:00, 83.17it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:02<00:00, 84.98it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 79.10it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:13<36:09, 13.23s/it, est. speed input: 35.08 toks/s, output: 25.63 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:01<00:00, 79.40it/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 80.43it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:14<40:36, 14.85s/it, est. speed input: 30.63 toks/s, output: 24.64 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–Œ         | 10/165 [00:20<01:37,  1.59it/s, est. speed input: 228.45 toks/s, output: 226.67 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  12%|â–ˆâ–        | 19/165 [00:25<01:02,  2.35it/s, est. speed input: 351.54 toks/s, output: 389.31 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 45/165 [00:30<00:17,  6.81it/s, est. speed input: 691.94 toks/s, output: 909.75 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–‰       | 49/165 [00:36<00:49,  2.32it/s, est. speed input: 632.10 toks/s, output: 957.25 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 66/165 [00:41<00:29,  3.38it/s, est. speed input: 749.57 toks/s, output: 1240.73 toks/s][32m [repeated 59x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 89/165 [00:46<00:23,  3.21it/s, est. speed input: 902.91 toks/s, output: 1544.49 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:51<00:13,  4.54it/s, est. speed input: 946.69 toks/s, output: 1781.19 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [00:56<00:41,  1.26it/s, est. speed input: 942.69 toks/s, output: 1855.57 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [01:03<01:20,  1.30s/it, est. speed input: 768.19 toks/s, output: 1580.93 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [01:08<00:00, 18.38it/s, est. speed input: 1079.61 toks/s, output: 2739.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 18.38it/s, est. speed input: 1157.76 toks/s, output: 3070.11 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.43it/s, est. speed input: 1157.76 toks/s, output: 3070.11 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 110/165 [01:08<00:28,  1.95it/s, est. speed input: 764.24 toks/s, output: 1664.42 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  9.95it/s, est. speed input: 1128.55 toks/s, output: 3136.97 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.34it/s, est. speed input: 1128.55 toks/s, output: 3136.97 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:48:04 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:46:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:46:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:46:50 [executor_base.py:189] It took 0.464341 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:46:51 [executor_base.py:205] It took 0.333228 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [01:11<00:01, 15.91it/s, est. speed input: 1009.95 toks/s, output: 2738.06 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00, 15.91it/s, est. speed input: 1120.63 toks/s, output: 3198.89 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:11<00:00,  2.32it/s, est. speed input: 1120.63 toks/s, output: 3198.89 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:48:05 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 550/660 = 83.3%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:48:05 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:48:05 [executor_base.py:205] It took 0.354252 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:03, 49.91it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [01:08<00:00, 28.74it/s, est. speed input: 1151.27 toks/s, output: 3013.79 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 28.74it/s, est. speed input: 1172.70 toks/s, output: 3104.12 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.43it/s, est. speed input: 1172.70 toks/s, output: 3104.12 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 111/165 [01:10<00:49,  1.09it/s, est. speed input: 748.90 toks/s, output: 1645.19 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:02<00:00, 78.17it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:02<00:00, 78.03it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 80.00it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 148/164 [00:01<00:00, 84.06it/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:12<33:42, 12.41s/it, est. speed input: 38.44 toks/s, output: 25.47 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 79.38it/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:13<36:11, 13.24s/it, est. speed input: 34.28 toks/s, output: 25.98 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:18<05:46,  2.17s/it, est. speed input: 125.26 toks/s, output: 111.64 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 14/165 [00:23<02:07,  1.19it/s, est. speed input: 277.80 toks/s, output: 295.20 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–       | 40/165 [00:28<00:29,  4.21it/s, est. speed input: 661.99 toks/s, output: 850.82 toks/s][32m [repeated 61x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  34%|â–ˆâ–ˆâ–ˆâ–      | 56/165 [00:33<00:22,  4.93it/s, est. speed input: 786.81 toks/s, output: 1108.77 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–‰       | 49/165 [00:38<00:29,  3.99it/s, est. speed input: 599.31 toks/s, output: 945.35 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 68/165 [00:43<00:46,  2.08it/s, est. speed input: 735.31 toks/s, output: 1284.06 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 94/164 [00:49<00:34,  2.03it/s, est. speed input: 892.82 toks/s, output: 1660.28 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 92/165 [00:55<01:06,  1.11it/s, est. speed input: 794.99 toks/s, output: 1566.87 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 107/165 [01:00<00:40,  1.44it/s, est. speed input: 851.92 toks/s, output: 1624.36 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 115/165 [01:05<00:45,  1.11it/s, est. speed input: 842.52 toks/s, output: 1792.99 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 14.70it/s, est. speed input: 1170.94 toks/s, output: 3130.64 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.41it/s, est. speed input: 1170.94 toks/s, output: 3130.64 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 131/164 [01:08<00:03,  8.73it/s, est. speed input: 917.20 toks/s, output: 2176.75 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  8.73it/s, est. speed input: 1154.27 toks/s, output: 3160.15 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  2.39it/s, est. speed input: 1154.27 toks/s, output: 3160.15 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [01:08<00:00, 20.70it/s, est. speed input: 1047.77 toks/s, output: 2724.70 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 20.70it/s, est. speed input: 1154.00 toks/s, output: 3168.69 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.39it/s, est. speed input: 1154.00 toks/s, output: 3168.69 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:49:17 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:48:04 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:48:04 [gpu_worker.py:117] Sleep mode freed 61.87 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:48:04 [executor_base.py:189] It took 0.489195 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:48:05 [executor_base.py:205] It took 0.347348 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:49:19 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1105/1319 = 83.8%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:49:19 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 8 å®Œæˆ: å‡†ç¡®çŽ‡ 83.8% (1105/1319), è€—æ—¶ 148.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:49:19 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_8.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:49:19 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:   9%|â–‰         | 8/89 [1:41:59<17:16:00, 767.41s/it]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [01:09<00:19,  2.49it/s, est. speed input: 807.86 toks/s, output: 1881.47 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:49:20 [executor_base.py:205] It took 0.369196 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  27%|â–ˆâ–ˆâ–‹       | 17/64 [00:00<00:00, 162.18it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:00<00:00, 161.14it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 168.03it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 157.35it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:00<00:00, 140.98it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 155.65it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  2.49it/s, est. speed input: 1150.73 toks/s, output: 3297.47 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  2.38it/s, est. speed input: 1150.73 toks/s, output: 3297.47 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:44<46:40, 11.11s/it, est. speed input: 9.36 toks/s, output: 81.56 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:00<00:00, 156.60it/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 154.08it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:49<22:04,  5.34s/it, est. speed input: 15.14 toks/s, output: 140.70 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:03<18:22,  4.52s/it, est. speed input: 17.62 toks/s, output: 176.94 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:09<13:20,  3.34s/it, est. speed input: 21.63 toks/s, output: 233.37 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:17<1:21:26, 19.39s/it, est. speed input: 5.05 toks/s, output: 69.30 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:25<09:18,  2.41s/it, est. speed input: 27.20 toks/s, output: 321.80 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:30<07:43,  2.03s/it, est. speed input: 30.15 toks/s, output: 378.19 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [01:35<02:51,  1.24it/s, est. speed input: 48.29 toks/s, output: 605.62 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 48/256 [01:42<03:35,  1.04s/it, est. speed input: 48.60 toks/s, output: 640.10 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  3.45it/s, est. speed input: 338.31 toks/s, output: 4670.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 338.31 toks/s, output: 4670.23 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  20%|â–ˆâ–ˆ        | 52/256 [01:45<01:30,  2.26it/s, est. speed input: 62.38 toks/s, output: 869.29 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.26it/s, est. speed input: 331.20 toks/s, output: 4779.42 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.43it/s, est. speed input: 331.20 toks/s, output: 4779.42 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:51:06 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:49:19 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:49:19 [gpu_worker.py:117] Sleep mode freed 62.15 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:49:19 [executor_base.py:189] It took 2.120594 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:49:20 [executor_base.py:205] It took 0.373478 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:51:08 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:51:08 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:51:22 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.224, å¹³å‡æƒé‡=0.776
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:51:06 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:51:08 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:51:08 [gpu_worker.py:117] Sleep mode freed 62.53 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:51:08 [executor_base.py:189] It took 2.088236 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:51:39 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:51:39 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:51:39 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:51:39 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:51:39 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:51:44 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:51:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:51:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:52:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 35/128 å®Œæˆ (70/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:52:06 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 41/128 å®Œæˆ (82/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:52:11 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 48/128 å®Œæˆ (96/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 22:52:16 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 55/128 å®Œæˆ (110/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:52:21 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 66/128 å®Œæˆ (132/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:52:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:52:32 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 80/128 å®Œæˆ (160/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 22:52:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 87/128 å®Œæˆ (174/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:52:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:52:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 107/128 å®Œæˆ (214/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:52:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 116/128 å®Œæˆ (232/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 22:53:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 123/128 å®Œæˆ (246/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:53:20 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 22:53:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 23x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:53:22 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:53:24 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:53:26 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:53:32 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 129.9s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:53:32 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:54:00 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:34 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3113)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3751)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3818)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3535)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3569)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3592)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:54:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3699)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:10 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2937)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3547)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3639)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3481)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3587)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3607)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:55:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3719)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:04 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3312)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3743)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3761)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3541)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3588)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3551)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:56:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3597)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:56:52 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:56:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3345)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:56:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3617)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:56:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3580)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3298)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3372)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3465)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3520)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3619)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3834)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3853)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3708)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:57:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3529)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:57:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3610)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:57:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3595)[32m [repeated 15x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:57:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3560)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:58:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3589)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:58:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3556)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:58:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 38/64 å®Œæˆ (152/256 æ¡æ ·æœ¬, loss=0.3566)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:58:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3601)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:58:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3605)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 22:58:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3507)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:58:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3566)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:58:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3579)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 22:58:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3566)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:58:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3608)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:59:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3620)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:59:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3622)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:59:11 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.98e-06, è€—æ—¶ 277.5s
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 22:59:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3622)[32m [repeated 9x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:59:20 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:59:11 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.98e-06, è€—æ—¶ 241.1s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 22:59:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3617)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:59:21 [executor_base.py:205] It took 0.323851 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 22:59:21 [executor_base.py:205] It took 0.367692 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:59:21 [executor_base.py:205] It took 0.358308 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:59:49 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:59:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:59:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 22:59:50 [executor_base.py:189] It took 0.456611 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 22:59:50 vtd_trainer_ray.py:1123] æ­¥éª¤ 9: {'vtd_loss': 0.3622416022699326, 'distill_loss': 0.3622416022699326, 'avg_se_weight': 0.775562890625, 'actor_lr': 2.9812611966141713e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.224437109375, 'step_time': 630.2503621578217, 'phase1_generate_time': 108.86228704452515, 'phase2_collect_time': 129.8949236869812, 'phase3_train_time': 348.1576795578003} [é‡‡æ ·=108.9s æ”¶é›†=129.9s è®­ç»ƒ=348.2s æ€»è®¡=630.3s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:00:43 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 9, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:00:43 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:59:49 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:59:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:59:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 22:59:50 [executor_base.py:189] It took 0.447964 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 23:00:43 [executor_base.py:205] It took 0.331782 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:45<07:27,  1.93s/it, est. speed input: 21.61 toks/s, output: 344.73 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  6.61it/s, est. speed input: 341.52 toks/s, output: 4795.13 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.43it/s, est. speed input: 341.52 toks/s, output: 4795.13 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:45<15:59,  4.00s/it, est. speed input: 17.05 toks/s, output: 254.08 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  4.00s/it, est. speed input: 341.25 toks/s, output: 4818.35 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.42it/s, est. speed input: 341.25 toks/s, output: 4818.35 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:00:44 [executor_base.py:205] It took 0.368824 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:03, 51.97it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 80.60it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:01<00:00, 84.66it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.22it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:14<38:39, 14.14s/it, est. speed input: 31.68 toks/s, output: 26.16 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:01<00:00, 80.25it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 66.05it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 39.96it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 66.56it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/165 [00:15<17:29,  6.44s/it, est. speed input: 59.65 toks/s, output: 49.65 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   7%|â–‹         | 11/165 [00:20<01:53,  1.36it/s, est. speed input: 244.89 toks/s, output: 255.87 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 31/165 [00:25<00:33,  4.06it/s, est. speed input: 564.38 toks/s, output: 663.15 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 34/165 [00:31<00:41,  3.17it/s, est. speed input: 510.58 toks/s, output: 674.29 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  29%|â–ˆâ–ˆâ–‰       | 48/165 [00:36<00:56,  2.07it/s, est. speed input: 624.67 toks/s, output: 914.52 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 66/165 [00:41<00:39,  2.52it/s, est. speed input: 753.47 toks/s, output: 1198.06 toks/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 85/165 [00:46<00:16,  4.84it/s, est. speed input: 863.84 toks/s, output: 1563.80 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 96/165 [00:51<00:19,  3.62it/s, est. speed input: 883.47 toks/s, output: 1696.17 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:56<00:55,  1.09it/s, est. speed input: 866.27 toks/s, output: 1611.27 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [01:03<01:06,  1.10s/it, est. speed input: 780.29 toks/s, output: 1611.47 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 21.93it/s, est. speed input: 1198.57 toks/s, output: 3120.41 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 21.93it/s, est. speed input: 1198.57 toks/s, output: 3120.41 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.48it/s, est. speed input: 1198.57 toks/s, output: 3120.41 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 15.18it/s, est. speed input: 1157.74 toks/s, output: 3106.19 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.43it/s, est. speed input: 1157.74 toks/s, output: 3106.19 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [01:09<00:39,  1.22it/s, est. speed input: 799.83 toks/s, output: 1813.82 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:01:56 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:00:44 [executor_base.py:205] It took 0.352399 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:01:56 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:01:57 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:01:57 [gpu_worker.py:117] Sleep mode freed 61.85 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:01:57 [executor_base.py:189] It took 0.496181 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:01:57 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 549/660 = 83.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:01:57 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:01:57 [executor_base.py:205] It took 0.349564 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:02, 59.05it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:01<00:00, 80.00it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 84.48it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.56it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  1.57it/s, est. speed input: 1133.83 toks/s, output: 3208.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:10<00:00,  2.35it/s, est. speed input: 1133.83 toks/s, output: 3208.05 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:12<32:54, 12.11s/it, est. speed input: 39.38 toks/s, output: 26.00 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 142/164 [00:01<00:00, 78.62it/s][32m [repeated 60x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.38it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 86.24it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 79.13it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 3/165 [00:17<13:01,  4.82s/it, est. speed input: 79.84 toks/s, output: 70.11 toks/s]
Processed prompts:   2%|â–         | 4/165 [00:17<08:33,  3.19s/it, est. speed input: 106.56 toks/s, output: 94.48 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 2/165 [00:15<17:16,  6.36s/it, est. speed input: 59.93 toks/s, output: 54.47 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–Œ         | 10/164 [00:22<01:56,  1.32it/s, est. speed input: 207.30 toks/s, output: 225.88 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  18%|â–ˆâ–Š        | 29/165 [00:27<00:41,  3.28it/s, est. speed input: 481.99 toks/s, output: 609.71 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 35/165 [00:32<00:58,  2.21it/s, est. speed input: 499.08 toks/s, output: 699.23 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 63/165 [00:38<00:52,  1.95it/s, est. speed input: 783.70 toks/s, output: 1182.47 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 67/165 [00:43<00:32,  3.02it/s, est. speed input: 730.43 toks/s, output: 1259.13 toks/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 83/165 [00:48<00:22,  3.61it/s, est. speed input: 810.62 toks/s, output: 1517.57 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 106/165 [00:54<00:26,  2.22it/s, est. speed input: 935.45 toks/s, output: 1798.05 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 100/165 [00:59<00:55,  1.17it/s, est. speed input: 802.27 toks/s, output: 1655.72 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 110/165 [01:04<00:38,  1.43it/s, est. speed input: 811.10 toks/s, output: 1786.46 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 142/165 [01:08<00:03,  6.70it/s, est. speed input: 1004.97 toks/s, output: 2450.79 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  6.70it/s, est. speed input: 1174.09 toks/s, output: 3138.27 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1174.09 toks/s, output: 3138.27 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  8.41it/s, est. speed input: 1159.75 toks/s, output: 3149.37 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  2.41it/s, est. speed input: 1159.75 toks/s, output: 3149.37 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:01:57 [executor_base.py:205] It took 0.360549 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:03:09 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:01:57 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:01:57 [gpu_worker.py:117] Sleep mode freed 61.90 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:01:57 [executor_base.py:189] It took 0.528297 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:03:09 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1091/1319 = 82.7%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:03:09 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 9 å®Œæˆ: å‡†ç¡®çŽ‡ 82.7% (1091/1319), è€—æ—¶ 146.2s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:03:09 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_9.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:03:09 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  10%|â–ˆ         | 9/89 [1:55:49<17:29:16, 786.95s/it]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 146/165 [01:09<00:00, 21.19it/s, est. speed input: 1012.51 toks/s, output: 2711.12 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:03:11 [executor_base.py:205] It took 1.977191 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:00<00:00, 116.55it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:00<00:00, 164.27it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 161.75it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [00:00<00:00, 141.21it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 156.46it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00, 21.19it/s, est. speed input: 1148.21 toks/s, output: 3269.85 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  2.38it/s, est. speed input: 1148.21 toks/s, output: 3269.85 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:38<40:01,  9.53s/it, est. speed input: 11.02 toks/s, output: 80.97 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [00:00<00:00, 130.35it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:00<00:00, 162.14it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 167.75it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:00<00:00, 145.49it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 157.74it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:56<58:57, 14.04s/it, est. speed input: 7.27 toks/s, output: 70.34 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [01:05<1:09:15, 16.49s/it, est. speed input: 7.28 toks/s, output: 57.26 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:11<21:28,  5.28s/it, est. speed input: 16.07 toks/s, output: 164.13 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:12<1:16:22, 18.19s/it, est. speed input: 4.34 toks/s, output: 60.53 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:18<10:24,  2.65s/it, est. speed input: 23.87 toks/s, output: 275.23 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:24<23:03,  5.67s/it, est. speed input: 14.36 toks/s, output: 174.16 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:37<09:58,  2.62s/it, est. speed input: 30.60 toks/s, output: 349.62 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:37<18:09,  4.54s/it, est. speed input: 16.68 toks/s, output: 219.37 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:43<08:30,  2.28s/it, est. speed input: 34.36 toks/s, output: 407.66 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  4.99it/s, est. speed input: 353.52 toks/s, output: 4742.94 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 353.52 toks/s, output: 4742.94 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 144/256 [01:45<00:12,  8.63it/s, est. speed input: 185.02 toks/s, output: 2647.58 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  8.63it/s, est. speed input: 325.78 toks/s, output: 4778.53 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.43it/s, est. speed input: 325.78 toks/s, output: 4778.53 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:03:11 [executor_base.py:205] It took 1.993276 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:04:58 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:03:09 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:03:09 [gpu_worker.py:117] Sleep mode freed 62.23 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:03:09 [executor_base.py:189] It took 0.500636 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:04:59 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:04:59 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:05:13 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.251, å¹³å‡æƒé‡=0.749
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:04:58 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:04:59 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:04:59 [gpu_worker.py:117] Sleep mode freed 62.70 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:04:59 [executor_base.py:189] It took 0.533498 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:05:31 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:05:31 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:05:32 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:05:32 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:05:32 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:05:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:05:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 14/128 å®Œæˆ (28/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:05:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:05:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:05:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 39/128 å®Œæˆ (78/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:06:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:06:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:06:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:06:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 75/128 å®Œæˆ (150/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:06:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 84/128 å®Œæˆ (168/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:06:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 89/128 å®Œæˆ (178/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:06:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:06:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 110/128 å®Œæˆ (220/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:06:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 119/128 å®Œæˆ (238/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:06:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 124/128 å®Œæˆ (248/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:07:15 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:06:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 17x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:07:18 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:07:20 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:07:22 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:07:30 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 137.9s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:07:30 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:07:58 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:32 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3798)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3624)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3572)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3529)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3530)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3623)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:08:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3585)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:09 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3667)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3287)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3339)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3285)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3341)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3502)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:09:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3472)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:01 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3658)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3377)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3339)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3218)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3275)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3379)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:10:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3394)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:10:51 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:10:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3562)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:10:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3396)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:10:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3227)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:10:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3215)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3326)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3473)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3478)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3499)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3579)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3454)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:11:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3597)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:11:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3590)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:11:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3626)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3522)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:11:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3533)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:12:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3593)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:12:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3634)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:12:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3650)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:12:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3576)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:12:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 45/64 å®Œæˆ (180/256 æ¡æ ·æœ¬, loss=0.3561)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:12:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.3567)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:12:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3527)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:12:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3552)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:12:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3648)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:13:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3659)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:13:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3633)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:13:12 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.97e-06, è€—æ—¶ 279.8s
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:13:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3661)[32m [repeated 8x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:13:21 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:13:12 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.97e-06, è€—æ—¶ 243.4s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:13:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3652)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:13:21 [executor_base.py:205] It took 0.341990 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:13:21 [executor_base.py:205] It took 0.341851 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:13:21 [executor_base.py:205] It took 0.349717 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 480x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:13:50 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:13:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:13:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:13:50 [executor_base.py:189] It took 0.473260 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:13:50 vtd_trainer_ray.py:1123] æ­¥éª¤ 10: {'vtd_loss': 0.3660877872025594, 'distill_loss': 0.3660877872025594, 'avg_se_weight': 0.748809765625, 'actor_lr': 2.9720395206624504e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.251190234375, 'step_time': 640.9698445796967, 'phase1_generate_time': 109.26167154312134, 'phase2_collect_time': 137.88328099250793, 'phase3_train_time': 350.5183472633362} [é‡‡æ ·=109.3s æ”¶é›†=137.9s è®­ç»ƒ=350.5s æ€»è®¡=641.0s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:13:50 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 10, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:13:50 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:13:51 [executor_base.py:205] It took 0.349754 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:46<29:07,  7.16s/it, est. speed input: 14.47 toks/s, output: 175.33 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  7.16s/it, est. speed input: 328.49 toks/s, output: 4842.44 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.41it/s, est. speed input: 328.49 toks/s, output: 4842.44 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 144/256 [01:45<00:23,  4.75it/s, est. speed input: 182.16 toks/s, output: 2646.97 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  4.75it/s, est. speed input: 336.67 toks/s, output: 4816.83 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.43it/s, est. speed input: 336.67 toks/s, output: 4816.83 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:13:51 [executor_base.py:205] It took 0.322372 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:08, 18.25it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:03<00:00, 79.60it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:03<00:00, 77.37it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 42.69it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:08<23:35,  8.63s/it, est. speed input: 53.77 toks/s, output: 28.62 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [00:03<00:00, 77.54it/s][32m [repeated 82x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 42.37it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:03<00:00, 74.37it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 42.82it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:13<35:47, 13.09s/it, est. speed input: 35.82 toks/s, output: 25.66 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 14/165 [00:18<01:11,  2.12it/s, est. speed input: 357.64 toks/s, output: 321.37 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 28/165 [00:23<00:28,  4.87it/s, est. speed input: 560.86 toks/s, output: 637.42 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  23%|â–ˆâ–ˆâ–Ž       | 38/165 [00:28<00:37,  3.40it/s, est. speed input: 628.02 toks/s, output: 731.46 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  29%|â–ˆâ–ˆâ–‰       | 48/165 [00:33<01:32,  1.26it/s, est. speed input: 680.16 toks/s, output: 926.55 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:38<00:52,  1.91it/s, est. speed input: 795.37 toks/s, output: 1208.90 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 87/165 [00:44<00:32,  2.41it/s, est. speed input: 930.13 toks/s, output: 1529.33 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 95/165 [00:49<00:14,  4.67it/s, est. speed input: 921.10 toks/s, output: 1680.79 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:54<01:29,  1.44s/it, est. speed input: 893.82 toks/s, output: 1571.43 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:59<00:54,  1.17it/s, est. speed input: 801.51 toks/s, output: 1487.60 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [01:04<00:19,  2.63it/s, est. speed input: 831.52 toks/s, output: 1707.12 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:05<00:01, 11.54it/s, est. speed input: 1123.28 toks/s, output: 2690.69 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [01:05<00:00, 14.67it/s, est. speed input: 1175.28 toks/s, output: 2903.30 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 17.27it/s, est. speed input: 1216.07 toks/s, output: 3082.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 17.27it/s, est. speed input: 1216.07 toks/s, output: 3082.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.52it/s, est. speed input: 1216.07 toks/s, output: 3082.98 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  6.18it/s, est. speed input: 1171.48 toks/s, output: 3061.50 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.45it/s, est. speed input: 1171.48 toks/s, output: 3061.50 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 128/165 [01:08<00:05,  6.38it/s, est. speed input: 901.13 toks/s, output: 2062.42 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  6.38it/s, est. speed input: 1166.59 toks/s, output: 3169.91 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1166.59 toks/s, output: 3169.91 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:15:03 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:13:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:13:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:13:50 [executor_base.py:189] It took 0.501810 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:13:51 [executor_base.py:205] It took 0.346260 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:15:04 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 549/660 = 83.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:15:04 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:15:04 [executor_base.py:205] It took 0.342447 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [01:08<00:34,  1.35it/s, est. speed input: 823.09 toks/s, output: 1760.80 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:03, 49.54it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 83.05it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:02<00:00, 81.47it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 79.02it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.35it/s, est. speed input: 1160.70 toks/s, output: 3163.30 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.41it/s, est. speed input: 1160.70 toks/s, output: 3163.30 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:11<31:45, 11.69s/it, est. speed input: 38.75 toks/s, output: 26.18 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 142/164 [00:01<00:00, 82.04it/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 82.01it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 162/164 [00:02<00:00, 82.50it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 79.61it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:11<13:09,  4.87s/it, est. speed input: 78.86 toks/s, output: 52.15 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 2/165 [00:17<19:12,  7.07s/it, est. speed input: 53.55 toks/s, output: 48.33 toks/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   7%|â–‹         | 11/164 [00:22<02:06,  1.21it/s, est. speed input: 231.09 toks/s, output: 238.85 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 31/165 [00:27<00:40,  3.32it/s, est. speed input: 532.03 toks/s, output: 640.20 toks/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  32%|â–ˆâ–ˆâ–ˆâ–      | 53/165 [00:32<00:28,  3.91it/s, est. speed input: 771.15 toks/s, output: 1019.11 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 67/165 [00:37<00:35,  2.79it/s, est. speed input: 844.09 toks/s, output: 1220.86 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 77/164 [00:42<01:04,  1.35it/s, est. speed input: 847.15 toks/s, output: 1364.00 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 97/164 [00:48<00:19,  3.45it/s, est. speed input: 953.25 toks/s, output: 1721.32 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:53<00:20,  2.97it/s, est. speed input: 928.73 toks/s, output: 1742.28 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [00:58<00:47,  1.18it/s, est. speed input: 888.75 toks/s, output: 1725.99 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 116/165 [01:04<00:40,  1.21it/s, est. speed input: 859.95 toks/s, output: 1838.95 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 12.39it/s, est. speed input: 1184.46 toks/s, output: 3102.57 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1184.46 toks/s, output: 3102.57 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:16:15 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:15:04 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:15:04 [gpu_worker.py:117] Sleep mode freed 61.92 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:15:04 [executor_base.py:189] It took 0.502376 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:15:04 [executor_base.py:205] It took 0.338173 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:16:17 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1100/1319 = 83.4%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:16:17 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 10 å®Œæˆ: å‡†ç¡®çŽ‡ 83.4% (1100/1319), è€—æ—¶ 147.0s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:16:17 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_10.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:16:17 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  11%|â–ˆ         | 10/89 [2:08:56<17:16:33, 787.26s/it]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 120/165 [01:08<00:57,  1.27s/it, est. speed input: 835.28 toks/s, output: 1835.56 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:16:18 [executor_base.py:205] It took 0.335828 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  27%|â–ˆâ–ˆâ–‹       | 17/64 [00:00<00:00, 121.65it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:00<00:00, 150.56it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 151.88it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:00<00:00, 135.39it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 136.77it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 150.98it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.27s/it, est. speed input: 1162.81 toks/s, output: 3177.04 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.41it/s, est. speed input: 1162.81 toks/s, output: 3177.04 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:31<32:56,  7.84s/it, est. speed input: 10.84 toks/s, output: 83.01 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [00:00<00:00, 145.61it/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:00<00:00, 160.40it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 153.75it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:44<46:18, 11.03s/it, est. speed input: 7.62 toks/s, output: 73.94 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:51<25:38,  6.21s/it, est. speed input: 14.11 toks/s, output: 121.50 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [00:57<14:32,  3.58s/it, est. speed input: 17.71 toks/s, output: 183.93 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:02<10:48,  2.70s/it, est. speed input: 22.10 toks/s, output: 234.27 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:03<07:09,  1.82s/it, est. speed input: 29.53 toks/s, output: 301.65 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:04<04:42,  1.22s/it, est. speed input: 34.62 toks/s, output: 363.73 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:08<04:36,  1.21s/it, est. speed input: 37.14 toks/s, output: 407.62 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:09<03:18,  1.13it/s, est. speed input: 43.06 toks/s, output: 473.27 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:16<15:53,  3.97s/it, est. speed input: 20.45 toks/s, output: 212.84 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:23<08:23,  2.17s/it, est. speed input: 30.27 toks/s, output: 340.01 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [01:31<08:25,  2.30s/it, est. speed input: 36.85 toks/s, output: 427.45 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:36<06:53,  1.85s/it, est. speed input: 35.66 toks/s, output: 422.46 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  16%|â–ˆâ–Œ        | 40/256 [01:43<09:07,  2.54s/it, est. speed input: 37.81 toks/s, output: 455.88 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 124/256 [01:43<00:32,  4.01it/s, est. speed input: 142.64 toks/s, output: 2098.42 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  4.01it/s, est. speed input: 328.14 toks/s, output: 4675.82 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 328.14 toks/s, output: 4675.82 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 248/256 [01:45<00:01,  4.93it/s, est. speed input: 332.06 toks/s, output: 4664.60 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  4.93it/s, est. speed input: 342.47 toks/s, output: 4806.72 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.43it/s, est. speed input: 342.47 toks/s, output: 4806.72 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:18:04 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:16:17 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:16:17 [gpu_worker.py:117] Sleep mode freed 62.14 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:16:17 [executor_base.py:189] It took 2.008146 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:16:18 [executor_base.py:205] It took 0.320803 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  7.05s/it, est. speed input: 313.27 toks/s, output: 4858.22 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.41it/s, est. speed input: 313.27 toks/s, output: 4858.22 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:18:05 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:18:05 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:18:19 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.268, å¹³å‡æƒé‡=0.732
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:18:04 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:18:05 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:18:05 [gpu_worker.py:117] Sleep mode freed 62.43 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:18:05 [executor_base.py:189] It took 0.507049 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:18:37 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:18:37 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:18:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:18:39 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:18:39 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:18:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 4/128 å®Œæˆ (8/256 æ¡åºåˆ—)[32m [repeated 21x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:18:48 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 11/128 å®Œæˆ (22/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:18:53 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 21/128 å®Œæˆ (42/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:18:58 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 29/128 å®Œæˆ (58/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:19:03 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 40/128 å®Œæˆ (80/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:19:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 48/128 å®Œæˆ (96/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:19:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 57/128 å®Œæˆ (114/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:19:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 67/128 å®Œæˆ (134/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:19:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 74/128 å®Œæˆ (148/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:19:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 78/128 å®Œæˆ (156/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:19:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 89/128 å®Œæˆ (178/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:19:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 95/128 å®Œæˆ (190/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:19:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 106/128 å®Œæˆ (212/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:19:51 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:19:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 120/128 å®Œæˆ (240/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:20:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 126/128 å®Œæˆ (252/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:20:20 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:20:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:20:23 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:20:25 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:20:27 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:20:34 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 135.6s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:20:34 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:21:02 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:39 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3256)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3439)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3811)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3557)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3309)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3306)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:21:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3453)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:15 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2559)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3209)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3761)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3499)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3359)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3343)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:22:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3452)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:05 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2910)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3422)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3883)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3532)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3377)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3347)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:23:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3498)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:23:57 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:23:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2326)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3030)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3527)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3248)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3120)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3179)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3274)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:24:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3680)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3385)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3301)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3213)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:24:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3354)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3331)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3388)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3443)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:24:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3469)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:25:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 31/64 å®Œæˆ (124/256 æ¡æ ·æœ¬, loss=0.3513)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:25:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 34/64 å®Œæˆ (136/256 æ¡æ ·æœ¬, loss=0.3594)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:25:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3528)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:25:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3523)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:25:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3501)[32m [repeated 15x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:25:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3481)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:25:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.3475)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:25:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3483)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:25:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3431)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:25:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3411)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:26:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3440)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:26:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3386)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:26:17 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.96e-06, è€—æ—¶ 278.3s
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:26:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3402)[32m [repeated 10x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:26:27 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:26:17 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.96e-06, è€—æ—¶ 242.6s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:26:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3413)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:26:27 [executor_base.py:205] It took 0.341434 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:26:27 [executor_base.py:205] It took 0.382555 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:26:27 [executor_base.py:205] It took 0.361462 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:26:55 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:26:56 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:26:56 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:26:56 [executor_base.py:189] It took 0.509605 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:26:56 vtd_trainer_ray.py:1123] æ­¥éª¤ 11: {'vtd_loss': 0.3402361562475562, 'distill_loss': 0.3402361562475562, 'avg_se_weight': 0.7319078125, 'actor_lr': 2.9610014298827927e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.2680921875, 'step_time': 638.683779001236, 'phase1_generate_time': 107.3965539932251, 'phase2_collect_time': 135.61378598213196, 'phase3_train_time': 352.5359044075012} [é‡‡æ ·=107.4s æ”¶é›†=135.6s è®­ç»ƒ=352.5s æ€»è®¡=638.7s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:26:56 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 11, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:26:56 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:26:56 [executor_base.py:205] It took 0.337287 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:45<28:39,  7.05s/it, est. speed input: 11.33 toks/s, output: 172.52 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 152/256 [01:44<00:07, 14.56it/s, est. speed input: 184.62 toks/s, output: 2687.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00, 14.56it/s, est. speed input: 360.78 toks/s, output: 4724.01 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.45it/s, est. speed input: 360.78 toks/s, output: 4724.01 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:26:56 [executor_base.py:205] It took 0.322168 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:03, 46.94it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:03<00:00, 38.71it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.66it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:03<00:00, 42.60it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:10<27:59, 10.24s/it, est. speed input: 45.12 toks/s, output: 28.22 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:03<00:00, 33.27it/s][32m [repeated 76x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.29it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:11<30:23, 11.12s/it, est. speed input: 42.19 toks/s, output: 30.22 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:16<05:11,  1.95s/it, est. speed input: 142.58 toks/s, output: 126.15 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–        | 20/165 [00:21<00:54,  2.64it/s, est. speed input: 433.97 toks/s, output: 428.59 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–Ž       | 39/165 [00:26<00:50,  2.48it/s, est. speed input: 676.12 toks/s, output: 795.05 toks/s][32m [repeated 59x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:31<00:12,  8.02it/s, est. speed input: 952.76 toks/s, output: 1317.75 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 83/165 [00:37<00:18,  4.50it/s, est. speed input: 1053.17 toks/s, output: 1588.36 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 82/165 [00:42<00:28,  2.90it/s, est. speed input: 915.50 toks/s, output: 1424.56 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 94/165 [00:47<00:50,  1.39it/s, est. speed input: 942.51 toks/s, output: 1612.97 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [00:54<01:13,  1.31s/it, est. speed input: 942.90 toks/s, output: 1668.45 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [01:01<01:05,  1.26s/it, est. speed input: 882.90 toks/s, output: 1685.13 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [01:05<00:00, 22.18it/s, est. speed input: 1144.58 toks/s, output: 2845.14 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 22.18it/s, est. speed input: 1197.62 toks/s, output: 3063.10 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.51it/s, est. speed input: 1197.62 toks/s, output: 3063.10 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 120/165 [01:06<00:54,  1.22s/it, est. speed input: 865.87 toks/s, output: 1768.12 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  9.03it/s, est. speed input: 1201.12 toks/s, output: 3164.59 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1201.12 toks/s, output: 3164.59 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:28:08 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:26:56 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:26:56 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:26:56 [executor_base.py:189] It took 0.517828 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:26:56 [executor_base.py:205] It took 0.342672 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:28:09 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 565/660 = 85.6%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:28:09 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:28:09 [executor_base.py:205] It took 0.354105 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   6%|â–Œ         | 10/165 [00:00<00:02, 66.04it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 18.22it/s, est. speed input: 1194.50 toks/s, output: 3141.95 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 18.22it/s, est. speed input: 1194.50 toks/s, output: 3141.95 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.48it/s, est. speed input: 1194.50 toks/s, output: 3141.95 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 82.01it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [01:08<00:25,  1.47it/s, est. speed input: 892.50 toks/s, output: 1903.50 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:02<00:00, 85.94it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.15it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.47it/s, est. speed input: 1167.35 toks/s, output: 3040.17 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1167.35 toks/s, output: 3040.17 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 148/164 [00:01<00:00, 81.06it/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 80.97it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:10<29:09, 10.73s/it, est. speed input: 44.45 toks/s, output: 25.25 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:01<00:00, 87.59it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.58it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:11<13:26,  4.98s/it, est. speed input: 79.59 toks/s, output: 49.38 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   4%|â–         | 7/165 [00:17<03:19,  1.26s/it, est. speed input: 188.02 toks/s, output: 162.54 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  10%|â–ˆ         | 17/165 [00:22<00:53,  2.75it/s, est. speed input: 353.10 toks/s, output: 376.41 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  20%|â–ˆâ–ˆ        | 33/164 [00:27<00:17,  7.62it/s, est. speed input: 562.74 toks/s, output: 716.38 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  29%|â–ˆâ–ˆâ–‰       | 48/165 [00:32<00:26,  4.46it/s, est. speed input: 691.58 toks/s, output: 937.85 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 63/165 [00:37<01:03,  1.60it/s, est. speed input: 790.42 toks/s, output: 1167.05 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 88/164 [00:42<00:15,  4.88it/s, est. speed input: 977.35 toks/s, output: 1636.40 toks/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 86/165 [00:47<00:46,  1.71it/s, est. speed input: 852.80 toks/s, output: 1461.17 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 100/164 [00:52<01:19,  1.24s/it, est. speed input: 899.44 toks/s, output: 1615.48 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 111/164 [00:58<00:53,  1.01s/it, est. speed input: 897.22 toks/s, output: 1742.84 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:04<00:49,  1.07s/it, est. speed input: 884.91 toks/s, output: 1747.42 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [01:07<00:00, 29.37it/s, est. speed input: 1173.82 toks/s, output: 3009.82 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 29.37it/s, est. speed input: 1188.27 toks/s, output: 3070.62 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.45it/s, est. speed input: 1188.27 toks/s, output: 3070.62 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 142/165 [01:08<00:02,  8.54it/s, est. speed input: 1006.37 toks/s, output: 2412.21 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  8.54it/s, est. speed input: 1169.18 toks/s, output: 3102.17 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1169.18 toks/s, output: 3102.17 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:29:20 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:28:09 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:28:09 [gpu_worker.py:117] Sleep mode freed 61.83 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:28:09 [executor_base.py:189] It took 0.508857 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:28:09 [executor_base.py:205] It took 0.368501 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.01s/it, est. speed input: 1167.01 toks/s, output: 3158.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.41it/s, est. speed input: 1167.01 toks/s, output: 3158.05 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:29:21 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1117/1319 = 84.7%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:29:21 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 11 å®Œæˆ: å‡†ç¡®çŽ‡ 84.7% (1117/1319), è€—æ—¶ 144.8s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:29:21 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_11.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:29:21 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  12%|â–ˆâ–        | 11/89 [2:22:00<17:01:55, 786.10s/it]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:29:21 [executor_base.py:205] It took 0.338322 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 123/165 [01:08<00:42,  1.01s/it, est. speed input: 860.53 toks/s, output: 1901.58 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  17%|â–ˆâ–‹        | 11/64 [00:00<00:00, 102.69it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:00<00:00, 163.43it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 168.53it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:00<00:00, 160.67it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 159.08it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 150.00it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 158/164 [01:08<00:00, 23.60it/s, est. speed input: 1117.88 toks/s, output: 2898.18 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00, 23.60it/s, est. speed input: 1161.57 toks/s, output: 3078.46 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  2.41it/s, est. speed input: 1161.57 toks/s, output: 3078.46 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:50<53:19, 12.70s/it, est. speed input: 7.09 toks/s, output: 53.02 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [00:00<00:00, 142.18it/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:00<00:00, 151.48it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 152.98it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:53<55:49, 13.29s/it, est. speed input: 7.60 toks/s, output: 68.13 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:54<23:11,  5.61s/it, est. speed input: 16.11 toks/s, output: 138.78 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:01<15:40,  3.86s/it, est. speed input: 19.21 toks/s, output: 159.11 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:07<18:45,  4.61s/it, est. speed input: 21.18 toks/s, output: 180.04 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:13<09:37,  2.45s/it, est. speed input: 24.93 toks/s, output: 266.53 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:21<37:23,  9.05s/it, est. speed input: 8.86 toks/s, output: 118.22 toks/s] 
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:21<08:50,  2.29s/it, est. speed input: 27.46 toks/s, output: 291.69 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:29<14:34,  3.71s/it, est. speed input: 26.26 toks/s, output: 256.74 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:34<11:07,  2.88s/it, est. speed input: 30.81 toks/s, output: 318.19 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:42<14:20,  3.65s/it, est. speed input: 17.91 toks/s, output: 262.11 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 136/256 [01:45<00:15,  7.55it/s, est. speed input: 165.64 toks/s, output: 2318.52 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  7.55it/s, est. speed input: 307.66 toks/s, output: 4607.72 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.42it/s, est. speed input: 307.66 toks/s, output: 4607.72 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:31:08 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:29:20 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:29:20 [gpu_worker.py:117] Sleep mode freed 61.97 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:29:20 [executor_base.py:189] It took 0.492235 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:29:21 [executor_base.py:205] It took 0.349114 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:31:09 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:31:09 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:31:23 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.246, å¹³å‡æƒé‡=0.754
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:31:08 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:31:09 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:31:09 [gpu_worker.py:117] Sleep mode freed 62.64 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:31:09 [executor_base.py:189] It took 0.538716 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:31:39 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:31:40 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:31:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:31:41 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:31:41 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:31:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 10/128 å®Œæˆ (20/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:31:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 19/128 å®Œæˆ (38/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:31:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 26/128 å®Œæˆ (52/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:32:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:32:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 42/128 å®Œæˆ (84/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:32:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 51/128 å®Œæˆ (102/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:32:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 57/128 å®Œæˆ (114/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:32:22 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:32:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:32:33 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 82/128 å®Œæˆ (164/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:32:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 90/128 å®Œæˆ (180/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:32:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:32:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 106/128 å®Œæˆ (212/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:32:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 115/128 å®Œæˆ (230/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:32:59 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 122/128 å®Œæˆ (244/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:33:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 127/128 å®Œæˆ (254/256 æ¡åºåˆ—)[32m [repeated 24x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:33:21 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:33:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:33:24 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:33:26 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:33:28 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:33:37 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 133.8s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:33:37 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:34:04 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:39 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4132)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3751)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3134)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3053)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3354)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3533)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:34:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3603)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:14 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4443)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3910)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3144)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3125)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3472)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3606)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:35:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3783)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:03 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4018)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3866)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3163)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3160)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3379)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3459)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:36:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3573)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:36:52 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:36:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4444)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:36:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4014)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:36:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3233)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3237)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3432)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3545)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3642)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:37:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3754)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3767)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3555)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3700)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:37:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.3580)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3491)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:37:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.3507)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:37:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3394)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:37:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3413)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:37:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3382)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:38:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3439)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:38:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 34/64 å®Œæˆ (136/256 æ¡æ ·æœ¬, loss=0.3437)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:38:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3457)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:38:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3418)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:38:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3377)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:38:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 45/64 å®Œæˆ (180/256 æ¡æ ·æœ¬, loss=0.3452)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:38:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.3390)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:38:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3467)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:38:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3445)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:38:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3393)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:39:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3394)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:39:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3472)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:39:12 vtd_actor.py:330] [è®­ç»ƒ rank=3] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.95e-06, è€—æ—¶ 139.6s
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:39:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3469)[32m [repeated 9x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:39:20 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:39:12 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.95e-06, è€—æ—¶ 272.5s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:39:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3385)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:39:21 [executor_base.py:205] It took 0.382493 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:39:21 [executor_base.py:205] It took 0.370048 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:39:21 [executor_base.py:205] It took 0.351327 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 480x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:39:49 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 23:39:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 23:39:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 23:39:50 [executor_base.py:189] It took 0.440853 seconds to fall asleep.
[36m(VtDStudentActor pid=843942)[0m Deleted oldest ckpt /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints/_actor/global_step3
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:39:50 vtd_trainer_ray.py:1123] æ­¥éª¤ 12: {'vtd_loss': 0.33851150108966976, 'distill_loss': 0.33851150108966976, 'avg_se_weight': 0.7538046875, 'actor_lr': 2.9481620900485743e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.2461953125, 'step_time': 629.2494473457336, 'phase1_generate_time': 108.04725384712219, 'phase2_collect_time': 133.76922869682312, 'phase3_train_time': 343.90268754959106} [é‡‡æ ·=108.0s æ”¶é›†=133.8s è®­ç»ƒ=343.9s æ€»è®¡=629.2s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:40:44 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 12, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:40:44 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:39:49 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:39:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:39:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:39:50 [executor_base.py:189] It took 0.468797 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:40:44 [executor_base.py:205] It took 0.332509 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:46<07:46,  2.08s/it, est. speed input: 30.80 toks/s, output: 415.38 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 148/256 [01:46<00:15,  6.76it/s, est. speed input: 171.93 toks/s, output: 2635.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  6.76it/s, est. speed input: 311.17 toks/s, output: 4681.19 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.40it/s, est. speed input: 311.17 toks/s, output: 4681.19 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:40:44 [executor_base.py:205] It took 0.335310 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 67.03it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:03<00:00, 56.89it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 62.42it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.06it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:09<25:52,  9.47s/it, est. speed input: 49.54 toks/s, output: 29.36 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 141/165 [00:03<00:00, 47.66it/s][32m [repeated 73x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.51it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:03<00:00, 64.12it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.99it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:10<28:02, 10.26s/it, est. speed input: 45.91 toks/s, output: 29.43 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   4%|â–Ž         | 6/165 [00:15<03:49,  1.44s/it, est. speed input: 180.60 toks/s, output: 138.61 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 18/165 [00:20<01:14,  1.97it/s, est. speed input: 403.89 toks/s, output: 385.64 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  18%|â–ˆâ–Š        | 30/165 [00:26<01:33,  1.44it/s, est. speed input: 525.56 toks/s, output: 607.69 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  29%|â–ˆâ–ˆâ–‰       | 48/165 [00:31<00:27,  4.23it/s, est. speed input: 718.42 toks/s, output: 969.71 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 67/165 [00:36<00:16,  6.09it/s, est. speed input: 865.89 toks/s, output: 1315.37 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 91/165 [00:41<00:33,  2.24it/s, est. speed input: 1024.62 toks/s, output: 1626.67 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 96/165 [00:47<01:12,  1.05s/it, est. speed input: 964.55 toks/s, output: 1631.46 toks/s] [32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [00:53<00:42,  1.31it/s, est. speed input: 960.87 toks/s, output: 1821.62 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 115/165 [00:59<00:44,  1.11it/s, est. speed input: 934.84 toks/s, output: 1794.28 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 132/165 [01:04<00:21,  1.52it/s, est. speed input: 978.89 toks/s, output: 2051.12 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:05<00:01, 12.50it/s, est. speed input: 1110.20 toks/s, output: 2644.02 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 12.50it/s, est. speed input: 1206.27 toks/s, output: 3050.27 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.53it/s, est. speed input: 1206.27 toks/s, output: 3050.27 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [01:07<00:00, 30.25it/s, est. speed input: 1152.71 toks/s, output: 3056.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 30.25it/s, est. speed input: 1174.02 toks/s, output: 3147.36 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1174.02 toks/s, output: 3147.36 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:41:56 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:40:44 [executor_base.py:205] It took 0.313364 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:41:56 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 139/165 [01:08<00:02,  9.90it/s, est. speed input: 978.11 toks/s, output: 2300.92 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  9.90it/s, est. speed input: 1165.68 toks/s, output: 3080.15 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1165.68 toks/s, output: 3080.15 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:41:57 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:41:57 [gpu_worker.py:117] Sleep mode freed 62.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:41:57 [executor_base.py:189] It took 0.518263 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:41:57 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 550/660 = 83.3%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:41:57 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 123/165 [01:08<00:31,  1.33it/s, est. speed input: 862.06 toks/s, output: 1823.12 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:41:57 [executor_base.py:205] It took 0.347450 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   6%|â–Œ         | 10/165 [00:00<00:02, 69.33it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:07<00:00, 17.36it/s, est. speed input: 1081.57 toks/s, output: 2758.96 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  9.67it/s, est. speed input: 1205.48 toks/s, output: 3132.06 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1205.48 toks/s, output: 3132.06 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:01<00:00, 84.65it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 81.94it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.17it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:11<32:19, 11.90s/it, est. speed input: 38.08 toks/s, output: 25.30 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 144/164 [00:01<00:00, 78.65it/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 80.45it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/164 [00:01<00:00, 82.61it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 81.76it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:12<14:08,  5.24s/it, est. speed input: 74.57 toks/s, output: 49.71 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/165 [00:17<07:39,  2.85s/it, est. speed input: 103.92 toks/s, output: 94.61 toks/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 22/165 [00:22<00:37,  3.80it/s, est. speed input: 449.85 toks/s, output: 483.11 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  20%|â–ˆâ–ˆ        | 33/165 [00:27<00:28,  4.61it/s, est. speed input: 552.41 toks/s, output: 704.65 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–ˆ       | 50/165 [00:32<00:19,  6.04it/s, est. speed input: 712.52 toks/s, output: 993.82 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 55/165 [00:38<01:01,  1.78it/s, est. speed input: 681.33 toks/s, output: 1007.78 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 80/165 [00:43<00:28,  2.99it/s, est. speed input: 878.70 toks/s, output: 1459.54 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 95/164 [00:48<00:30,  2.24it/s, est. speed input: 933.00 toks/s, output: 1674.35 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:53<01:30,  1.46s/it, est. speed input: 921.23 toks/s, output: 1574.61 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 111/165 [00:58<00:37,  1.42it/s, est. speed input: 904.39 toks/s, output: 1846.15 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [01:03<00:24,  1.90it/s, est. speed input: 890.67 toks/s, output: 1855.56 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 160/164 [01:07<00:00, 19.51it/s, est. speed input: 1137.42 toks/s, output: 2945.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00, 19.51it/s, est. speed input: 1166.12 toks/s, output: 3065.03 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00,  2.42it/s, est. speed input: 1166.12 toks/s, output: 3065.03 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 138/165 [01:08<00:03,  7.45it/s, est. speed input: 974.80 toks/s, output: 2216.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  7.45it/s, est. speed input: 1173.13 toks/s, output: 3024.62 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1173.13 toks/s, output: 3024.62 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [01:08<00:23,  1.60it/s, est. speed input: 886.92 toks/s, output: 2000.78 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 23:41:57 [executor_base.py:205] It took 0.355131 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:43:08 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:41:57 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:41:57 [gpu_worker.py:117] Sleep mode freed 62.09 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:41:57 [executor_base.py:189] It took 0.492632 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:43:09 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1108/1319 = 84.0%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:43:09 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 12 å®Œæˆ: å‡†ç¡®çŽ‡ 84.0% (1108/1319), è€—æ—¶ 145.0s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:43:09 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_12.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:43:09 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  13%|â–ˆâ–Ž        | 12/89 [2:35:48<17:05:10, 798.83s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:43:09 [executor_base.py:205] It took 0.336381 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:00<00:00, 120.83it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 158.35it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [00:00<00:00, 163.33it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 168.84it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [01:08<00:00, 15.10it/s, est. speed input: 1082.97 toks/s, output: 2803.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 15.10it/s, est. speed input: 1161.81 toks/s, output: 3130.80 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.40it/s, est. speed input: 1161.81 toks/s, output: 3130.80 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [01:08<00:01, 13.36it/s, est. speed input: 1039.98 toks/s, output: 2610.90 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 13.36it/s, est. speed input: 1161.01 toks/s, output: 3117.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.41it/s, est. speed input: 1161.01 toks/s, output: 3117.63 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:39<41:08,  9.80s/it, est. speed input: 8.68 toks/s, output: 77.38 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:00<00:00, 176.20it/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 170.76it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:40<42:53, 10.21s/it, est. speed input: 9.30 toks/s, output: 72.70 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:53<56:09, 13.37s/it, est. speed input: 7.48 toks/s, output: 70.71 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:54<23:08,  5.60s/it, est. speed input: 13.45 toks/s, output: 132.37 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:06<33:13,  8.04s/it, est. speed input: 9.94 toks/s, output: 119.48 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:15<15:07,  3.78s/it, est. speed input: 19.23 toks/s, output: 203.76 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:21<22:41,  5.58s/it, est. speed input: 15.50 toks/s, output: 154.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:34<20:43,  5.18s/it, est. speed input: 18.26 toks/s, output: 198.25 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:40<15:09,  3.85s/it, est. speed input: 21.55 toks/s, output: 255.96 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 160/256 [01:44<00:13,  7.11it/s, est. speed input: 183.13 toks/s, output: 2799.50 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  7.11it/s, est. speed input: 303.71 toks/s, output: 4645.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 303.71 toks/s, output: 4645.05 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:45<16:46,  4.26s/it, est. speed input: 20.78 toks/s, output: 245.54 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  7.34it/s, est. speed input: 326.53 toks/s, output: 4639.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  7.34it/s, est. speed input: 326.53 toks/s, output: 4639.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.42it/s, est. speed input: 326.53 toks/s, output: 4639.93 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:43:09 [executor_base.py:205] It took 0.347182 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:44:55 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-21 23:43:08 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:43:08 [gpu_worker.py:117] Sleep mode freed 61.98 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:43:08 [executor_base.py:189] It took 0.496098 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  3.31s/it, est. speed input: 314.00 toks/s, output: 4646.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.42it/s, est. speed input: 314.00 toks/s, output: 4646.31 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:44:56 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:44:56 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:45:10 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.245, å¹³å‡æƒé‡=0.755
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:44:55 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:44:56 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:44:56 [gpu_worker.py:117] Sleep mode freed 62.57 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:44:56 [executor_base.py:189] It took 0.491714 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:45:27 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:45:28 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:45:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:45:29 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:45:29 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:45:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 10/128 å®Œæˆ (20/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:45:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 20/128 å®Œæˆ (40/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:45:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 27/128 å®Œæˆ (54/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:45:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 33/128 å®Œæˆ (66/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:45:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 42/128 å®Œæˆ (84/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:46:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 52/128 å®Œæˆ (104/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:46:06 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 59/128 å®Œæˆ (118/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:46:11 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 66/128 å®Œæˆ (132/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:46:16 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 74/128 å®Œæˆ (148/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:46:22 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 84/128 å®Œæˆ (168/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:46:27 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 91/128 å®Œæˆ (182/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:46:32 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 100/128 å®Œæˆ (200/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:46:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 106/128 å®Œæˆ (212/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:46:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 114/128 å®Œæˆ (228/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:46:48 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 125/128 å®Œæˆ (250/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:47:08 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:46:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 17x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:47:12 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:47:13 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:47:16 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:47:24 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 134.2s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:47:24 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:47:52 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:27 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4942)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4412)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3947)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3691)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3486)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3383)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:48:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3334)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:03 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4854)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4621)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3981)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3581)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3445)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3374)
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:49:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3360)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:49:54 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:49:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4433)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:49:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4626)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:50:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4043)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:50:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3799)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:50:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3581)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:50:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3553)
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:50:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3473)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:43 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4836)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4700)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4051)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3886)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3660)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3536)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3490)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:50:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3312)
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:50:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3431)
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:51:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 10/64 å®Œæˆ (40/256 æ¡æ ·æœ¬, loss=0.3415)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:51:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 13/64 å®Œæˆ (52/256 æ¡æ ·æœ¬, loss=0.3453)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:51:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3464)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:51:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3273)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:51:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3196)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:51:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3307)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:51:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3355)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:51:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3299)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:51:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3306)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:52:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3323)[32m [repeated 15x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-21 23:52:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3374)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:52:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3340)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:52:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3357)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:52:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3386)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:52:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 50/64 å®Œæˆ (200/256 æ¡æ ·æœ¬, loss=0.3449)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:52:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3412)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:52:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3430)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-21 23:52:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3467)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:52:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3525)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-21 23:53:03 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.93e-06, è€—æ—¶ 275.8s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:53:13 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:53:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3514)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-21 23:53:03 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.93e-06, è€—æ—¶ 239.5s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:53:14 [executor_base.py:205] It took 0.373907 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:53:14 [executor_base.py:205] It took 0.349675 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:53:14 [executor_base.py:205] It took 0.356085 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 481x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:53:42 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:53:43 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:53:43 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:53:43 [executor_base.py:189] It took 0.495001 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:53:43 vtd_trainer_ray.py:1123] æ­¥éª¤ 13: {'vtd_loss': 0.34878143132664263, 'distill_loss': 0.34878143132664263, 'avg_se_weight': 0.755083203125, 'actor_lr': 2.933539141757441e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.244916796875, 'step_time': 634.1431360244751, 'phase1_generate_time': 107.25958728790283, 'phase2_collect_time': 134.24169325828552, 'phase3_train_time': 348.84792828559875} [é‡‡æ ·=107.3s æ”¶é›†=134.2s è®­ç»ƒ=348.8s æ€»è®¡=634.1s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:53:43 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 13, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:53:43 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:53:43 [executor_base.py:205] It took 0.331913 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 156/256 [01:44<00:13,  7.52it/s, est. speed input: 196.50 toks/s, output: 2818.76 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  7.52it/s, est. speed input: 330.42 toks/s, output: 4689.44 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.45it/s, est. speed input: 330.42 toks/s, output: 4689.44 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:45<12:46,  3.31s/it, est. speed input: 24.15 toks/s, output: 291.39 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:53:43 [executor_base.py:205] It took 0.335514 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   6%|â–Œ         | 10/165 [00:00<00:02, 62.74it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:03<00:00, 21.63it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:03<00:00, 38.15it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.19it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:09<26:51,  9.83s/it, est. speed input: 47.93 toks/s, output: 30.43 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/165 [00:03<00:01, 19.65it/s][32m [repeated 72x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.75it/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:03<00:00, 36.83it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.44it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/165 [00:10<12:51,  4.73s/it, est. speed input: 84.58 toks/s, output: 56.66 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 3/165 [00:13<10:03,  3.72s/it, est. speed input: 104.98 toks/s, output: 72.65 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 3/165 [00:14<09:32,  3.53s/it, est. speed input: 90.62 toks/s, output: 77.57 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   7%|â–‹         | 12/165 [00:19<02:06,  1.21it/s, est. speed input: 277.51 toks/s, output: 270.45 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 37/165 [00:25<00:40,  3.12it/s, est. speed input: 684.67 toks/s, output: 817.21 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  28%|â–ˆâ–ˆâ–Š       | 47/165 [00:30<00:41,  2.86it/s, est. speed input: 726.88 toks/s, output: 948.16 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 72/165 [00:35<00:32,  2.86it/s, est. speed input: 967.06 toks/s, output: 1394.71 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 93/165 [00:40<00:49,  1.46it/s, est. speed input: 1074.21 toks/s, output: 1704.21 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 85/165 [00:45<00:40,  2.00it/s, est. speed input: 884.87 toks/s, output: 1509.03 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 98/165 [00:50<00:32,  2.07it/s, est. speed input: 913.15 toks/s, output: 1647.04 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 100/165 [00:56<00:56,  1.15it/s, est. speed input: 851.58 toks/s, output: 1602.68 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [01:01<00:41,  1.34it/s, est. speed input: 851.77 toks/s, output: 1710.84 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [01:04<00:01, 10.09it/s, est. speed input: 1088.46 toks/s, output: 2521.97 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 10.09it/s, est. speed input: 1214.70 toks/s, output: 3056.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.54it/s, est. speed input: 1214.70 toks/s, output: 3056.98 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 10.62it/s, est. speed input: 1215.94 toks/s, output: 3124.41 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.52it/s, est. speed input: 1215.94 toks/s, output: 3124.41 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:06<00:17,  2.56it/s, est. speed input: 856.80 toks/s, output: 1860.60 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 12.78it/s, est. speed input: 1201.30 toks/s, output: 3216.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1201.30 toks/s, output: 3216.43 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 121/165 [01:12<01:08,  1.55s/it, est. speed input: 805.71 toks/s, output: 1776.91 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:55:01 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:53:43 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:53:43 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:53:43 [executor_base.py:189] It took 0.545339 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:53:43 [executor_base.py:205] It took 0.337769 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 146/165 [01:13<00:02,  8.54it/s, est. speed input: 952.12 toks/s, output: 2428.58 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:13<00:00,  8.54it/s, est. speed input: 1078.21 toks/s, output: 2954.75 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:13<00:00,  2.23it/s, est. speed input: 1078.21 toks/s, output: 2954.75 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:55:02 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 550/660 = 83.3%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:55:02 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:55:02 [executor_base.py:205] It took 0.349150 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842167)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   4%|â–         | 7/164 [00:00<00:02, 59.32it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:01<00:00, 84.10it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:02<00:00, 83.24it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 81.34it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:12<34:22, 12.66s/it, est. speed input: 37.69 toks/s, output: 25.68 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/164 [00:01<00:00, 83.08it/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.25it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/164 [00:01<00:00, 82.37it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 80.61it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:17<05:56,  2.23s/it, est. speed input: 130.82 toks/s, output: 112.65 toks/s][32m [repeated 14x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  15%|â–ˆâ–Œ        | 25/165 [00:22<00:44,  3.12it/s, est. speed input: 510.80 toks/s, output: 538.10 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  28%|â–ˆâ–ˆâ–Š       | 47/165 [00:27<00:14,  8.13it/s, est. speed input: 788.44 toks/s, output: 976.64 toks/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 44/165 [00:32<00:36,  3.27it/s, est. speed input: 625.75 toks/s, output: 872.97 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 63/165 [00:38<00:40,  2.53it/s, est. speed input: 783.94 toks/s, output: 1208.03 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 91/165 [00:43<00:37,  1.96it/s, est. speed input: 993.18 toks/s, output: 1591.85 toks/s] [32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:48<00:25,  2.48it/s, est. speed input: 987.35 toks/s, output: 1693.38 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:53<00:28,  2.15it/s, est. speed input: 919.42 toks/s, output: 1735.25 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 112/165 [00:59<00:31,  1.70it/s, est. speed input: 903.63 toks/s, output: 1803.47 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:05<01:07,  1.47s/it, est. speed input: 868.49 toks/s, output: 1801.34 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [01:06<00:00, 15.30it/s, est. speed input: 1114.90 toks/s, output: 2741.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 15.30it/s, est. speed input: 1197.56 toks/s, output: 3076.54 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.47it/s, est. speed input: 1197.56 toks/s, output: 3076.54 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 137/164 [01:07<00:05,  4.53it/s, est. speed input: 973.18 toks/s, output: 2246.60 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00,  4.53it/s, est. speed input: 1171.95 toks/s, output: 3063.14 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00,  2.43it/s, est. speed input: 1171.95 toks/s, output: 3063.14 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:56:12 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:55:01 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:55:01 [gpu_worker.py:117] Sleep mode freed 62.11 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:55:01 [executor_base.py:189] It took 0.492519 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:55:02 [executor_base.py:205] It took 0.352453 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:56:13 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1106/1319 = 83.9%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:56:13 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 13 å®Œæˆ: å‡†ç¡®çŽ‡ 83.9% (1106/1319), è€—æ—¶ 150.2s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:56:13 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_13.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:56:13 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  15%|â–ˆâ–        | 13/89 [2:48:52<16:46:17, 794.44s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:56:13 [executor_base.py:205] It took 0.344726 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  16%|â–ˆâ–Œ        | 10/64 [00:00<00:00, 86.39it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 149.81it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:00<00:00, 139.52it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 145.20it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:40<42:46, 10.18s/it, est. speed input: 10.60 toks/s, output: 66.97 toks/s][32m [repeated 14x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 123/165 [01:07<00:18,  2.25it/s, est. speed input: 868.68 toks/s, output: 1884.95 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.25it/s, est. speed input: 1172.98 toks/s, output: 3149.85 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1172.98 toks/s, output: 3149.85 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:00<00:00, 140.77it/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 158.80it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:00<00:00, 151.39it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 163.39it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:47<49:52, 11.87s/it, est. speed input: 7.41 toks/s, output: 67.94 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:51<53:59, 12.86s/it, est. speed input: 6.77 toks/s, output: 58.94 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:57<25:48,  6.24s/it, est. speed input: 13.47 toks/s, output: 120.83 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:05<32:38,  7.90s/it, est. speed input: 14.44 toks/s, output: 107.12 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:13<32:41,  7.91s/it, est. speed input: 10.65 toks/s, output: 122.39 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:20<14:56,  3.73s/it, est. speed input: 19.23 toks/s, output: 201.21 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:25<43:13, 10.46s/it, est. speed input: 9.79 toks/s, output: 109.02 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:32<26:01,  6.40s/it, est. speed input: 11.73 toks/s, output: 161.57 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:38<15:52,  4.04s/it, est. speed input: 19.35 toks/s, output: 228.40 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:46<10:11,  2.64s/it, est. speed input: 21.65 toks/s, output: 341.22 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  20%|â–ˆâ–ˆ        | 52/256 [01:46<02:03,  1.66it/s, est. speed input: 55.84 toks/s, output: 868.24 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  1.66it/s, est. speed input: 305.44 toks/s, output: 4690.82 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.41it/s, est. speed input: 305.44 toks/s, output: 4690.82 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 108/256 [01:46<00:44,  3.34it/s, est. speed input: 133.23 toks/s, output: 1875.91 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  3.34it/s, est. speed input: 330.62 toks/s, output: 4683.99 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.40it/s, est. speed input: 330.62 toks/s, output: 4683.99 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-21 23:58:00 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:56:12 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:56:12 [gpu_worker.py:117] Sleep mode freed 61.92 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-21 23:56:12 [executor_base.py:189] It took 0.515632 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:56:13 [executor_base.py:205] It took 0.341580 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:58:01 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:58:01 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:58:15 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.240, å¹³å‡æƒé‡=0.760
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:58:00 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:58:01 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:58:01 [gpu_worker.py:117] Sleep mode freed 62.64 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-21 23:58:01 [executor_base.py:189] It took 0.470589 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:58:34 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:58:34 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:58:34 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-21 23:58:34 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:58:34 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:58:39 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:58:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 19/128 å®Œæˆ (38/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:58:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 26/128 å®Œæˆ (52/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:58:55 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 33/128 å®Œæˆ (66/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:59:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 41/128 å®Œæˆ (82/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:59:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 50/128 å®Œæˆ (100/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:59:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 57/128 å®Œæˆ (114/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:59:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:59:21 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:59:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 81/128 å®Œæˆ (162/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-21 23:59:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 89/128 å®Œæˆ (178/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-21 23:59:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:59:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 103/128 å®Œæˆ (206/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:59:48 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-21 23:59:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 123/128 å®Œæˆ (246/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:00:17 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-21 23:59:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 21x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:00:19 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:00:23 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:00:25 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:00:33 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 137.6s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:00:33 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:01:00 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:38 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4293)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4238)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3822)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3716)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3711)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3444)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:01:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3570)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:14 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.5223)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4647)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4089)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3905)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3766)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3455)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:02:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3591)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:03 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4358)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4196)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3724)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3666)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3613)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3360)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:03:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3519)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:03:50 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:03:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4792)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:03:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4518)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:03:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3950)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:03:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3894)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3810)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3501)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3602)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3462)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3415)[32m [repeated 4x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3475)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3550)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3481)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:04:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3540)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:04:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3590)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3582)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:04:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3597)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:05:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3554)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:05:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3640)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:05:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3597)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:05:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3637)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:05:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3650)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:05:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3568)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:05:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3507)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:05:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3592)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:05:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3537)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:05:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 58/64 å®Œæˆ (232/256 æ¡æ ·æœ¬, loss=0.3541)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:06:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 60/64 å®Œæˆ (240/256 æ¡æ ·æœ¬, loss=0.3501)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:06:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3472)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:06:11 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.92e-06, è€—æ—¶ 273.2s
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:06:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3523)[32m [repeated 7x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:06:20 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:06:11 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.92e-06, è€—æ—¶ 237.1s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:06:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3494)[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:06:20 [executor_base.py:205] It took 0.373414 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:06:20 [executor_base.py:205] It took 0.350957 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:06:20 [executor_base.py:205] It took 0.367670 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:06:49 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:06:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:06:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.89 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:06:50 [executor_base.py:189] It took 0.461411 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:06:50 vtd_trainer_ray.py:1123] æ­¥éª¤ 14: {'vtd_loss': 0.3512930450960994, 'distill_loss': 0.3512930450960994, 'avg_se_weight': 0.759656640625, 'actor_lr': 2.917152676194027e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.240343359375, 'step_time': 636.5873956680298, 'phase1_generate_time': 107.97810363769531, 'phase2_collect_time': 137.63271570205688, 'phase3_train_time': 347.06872749328613} [é‡‡æ ·=108.0s æ”¶é›†=137.6s è®­ç»ƒ=347.1s æ€»è®¡=636.6s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:06:50 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 14, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:06:50 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:06:50 [executor_base.py:205] It took 0.417500 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:46<17:28,  4.44s/it, est. speed input: 21.29 toks/s, output: 253.61 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  4.44s/it, est. speed input: 308.18 toks/s, output: 4636.02 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.40it/s, est. speed input: 308.18 toks/s, output: 4636.02 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 172/256 [01:46<00:10,  8.13it/s, est. speed input: 201.12 toks/s, output: 3098.19 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  8.13it/s, est. speed input: 309.28 toks/s, output: 4686.01 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:46<00:00,  2.40it/s, est. speed input: 309.28 toks/s, output: 4686.01 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:06:50 [executor_base.py:205] It took 0.369643 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:03, 44.72it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 70/165 [00:01<00:03, 23.86it/s]
Adding requests:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 73/165 [00:02<00:04, 21.07it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:03<00:00, 74.52it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.36it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:03<00:00, 74.45it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:10<28:58, 10.60s/it, est. speed input: 42.07 toks/s, output: 29.90 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/165 [00:03<00:00, 70.20it/s][32m [repeated 74x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 83.49it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 42.60it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:03<00:00, 76.11it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:17, 12.18s/it, est. speed input: 38.51 toks/s, output: 26.69 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   4%|â–         | 7/165 [00:17<02:45,  1.05s/it, est. speed input: 183.96 toks/s, output: 173.83 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 21/165 [00:22<00:33,  4.31it/s, est. speed input: 431.66 toks/s, output: 470.42 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 37/165 [00:27<00:37,  3.40it/s, est. speed input: 625.56 toks/s, output: 759.20 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  28%|â–ˆâ–ˆâ–Š       | 46/165 [00:33<01:05,  1.82it/s, est. speed input: 649.03 toks/s, output: 920.90 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 72/165 [00:38<00:19,  4.83it/s, est. speed input: 883.24 toks/s, output: 1344.41 toks/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 94/165 [00:43<00:33,  2.14it/s, est. speed input: 1013.56 toks/s, output: 1645.43 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:48<00:34,  1.77it/s, est. speed input: 1007.87 toks/s, output: 1736.83 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 105/165 [00:53<00:37,  1.60it/s, est. speed input: 930.32 toks/s, output: 1743.50 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [00:58<00:17,  2.70it/s, est. speed input: 958.11 toks/s, output: 1951.35 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 110/165 [01:04<01:19,  1.45s/it, est. speed input: 823.44 toks/s, output: 1715.70 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:05<00:01, 10.63it/s, est. speed input: 1100.45 toks/s, output: 2638.19 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 10.63it/s, est. speed input: 1195.72 toks/s, output: 3041.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.50it/s, est. speed input: 1195.72 toks/s, output: 3041.43 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 138/165 [01:08<00:04,  6.61it/s, est. speed input: 968.20 toks/s, output: 2430.70 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  6.61it/s, est. speed input: 1157.61 toks/s, output: 3232.74 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.40it/s, est. speed input: 1157.61 toks/s, output: 3232.74 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:08:03 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:06:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:06:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:06:50 [executor_base.py:189] It took 0.464233 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:06:50 [executor_base.py:205] It took 0.398501 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:08:04 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 555/660 = 84.1%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:08:04 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 121/165 [01:08<00:45,  1.04s/it, est. speed input: 838.69 toks/s, output: 1891.87 toks/s][32m [repeated 14x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:08:04 [executor_base.py:205] It took 0.352352 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   6%|â–Œ         | 10/165 [00:00<00:02, 77.36it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [01:08<00:00, 15.27it/s, est. speed input: 1155.04 toks/s, output: 3007.89 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 15.27it/s, est. speed input: 1169.37 toks/s, output: 3067.94 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1169.37 toks/s, output: 3067.94 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:01<00:00, 80.95it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:01<00:00, 83.01it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 82.74it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/165 [01:09<00:02,  8.51it/s, est. speed input: 994.37 toks/s, output: 2541.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  8.51it/s, est. speed input: 1151.44 toks/s, output: 3192.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:09<00:00,  2.39it/s, est. speed input: 1151.44 toks/s, output: 3192.87 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:11<31:24, 11.56s/it, est. speed input: 39.18 toks/s, output: 26.12 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:01<00:00, 75.37it/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 78.78it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:02<00:00, 81.31it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 80.17it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:12<13:38,  5.05s/it, est. speed input: 77.12 toks/s, output: 51.41 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 2/165 [00:17<21:12,  7.80s/it, est. speed input: 54.68 toks/s, output: 45.44 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 8/164 [00:23<04:55,  1.89s/it, est. speed input: 160.55 toks/s, output: 158.59 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 37/165 [00:28<00:47,  2.68it/s, est. speed input: 601.42 toks/s, output: 760.16 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–Œ       | 42/165 [00:34<00:24,  4.93it/s, est. speed input: 579.38 toks/s, output: 832.59 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 62/165 [00:39<00:17,  5.94it/s, est. speed input: 749.35 toks/s, output: 1200.07 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 75/165 [00:44<00:47,  1.91it/s, est. speed input: 803.63 toks/s, output: 1373.32 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 88/165 [00:49<00:44,  1.74it/s, est. speed input: 847.72 toks/s, output: 1557.07 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:54<00:40,  1.54it/s, est. speed input: 908.48 toks/s, output: 1676.52 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 112/165 [00:59<00:24,  2.17it/s, est. speed input: 903.97 toks/s, output: 1783.75 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 116/165 [01:04<00:57,  1.17s/it, est. speed input: 856.07 toks/s, output: 1766.73 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:07<00:01, 12.91it/s, est. speed input: 1086.92 toks/s, output: 2757.58 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 12.91it/s, est. speed input: 1182.17 toks/s, output: 3148.99 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1182.17 toks/s, output: 3148.99 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 146/164 [01:08<00:00, 20.44it/s, est. speed input: 1029.09 toks/s, output: 2581.16 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00, 20.44it/s, est. speed input: 1161.94 toks/s, output: 3121.04 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  2.41it/s, est. speed input: 1161.94 toks/s, output: 3121.04 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:09:15 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:08:03 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:08:03 [gpu_worker.py:117] Sleep mode freed 62.01 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:08:03 [executor_base.py:189] It took 0.451410 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:08:04 [executor_base.py:205] It took 0.336710 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:09:17 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1101/1319 = 83.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:09:17 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 14 å®Œæˆ: å‡†ç¡®çŽ‡ 83.5% (1101/1319), è€—æ—¶ 147.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:09:17 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_14.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:09:17 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  16%|â–ˆâ–Œ        | 14/89 [3:01:57<16:29:16, 791.43s/it]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [01:08<00:39,  1.20it/s, est. speed input: 820.88 toks/s, output: 1808.57 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:09:18 [executor_base.py:205] It took 0.365304 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  28%|â–ˆâ–ˆâ–Š       | 18/64 [00:00<00:00, 158.10it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 169.91it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:00<00:00, 154.62it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 162.27it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [00:00<00:00, 146.44it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 164.73it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.20it/s, est. speed input: 1161.62 toks/s, output: 3208.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.40it/s, est. speed input: 1161.62 toks/s, output: 3208.63 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 134/165 [01:08<00:03,  8.33it/s, est. speed input: 943.46 toks/s, output: 2215.42 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  8.33it/s, est. speed input: 1166.55 toks/s, output: 3143.69 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1166.55 toks/s, output: 3143.69 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:49<51:37, 12.29s/it, est. speed input: 8.95 toks/s, output: 70.36 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [00:00<00:00, 158.25it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:00<00:00, 167.96it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 166.11it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:51<53:35, 12.76s/it, est. speed input: 7.84 toks/s, output: 65.99 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:57<26:15,  6.35s/it, est. speed input: 14.36 toks/s, output: 133.07 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:58<1:01:35, 14.66s/it, est. speed input: 7.09 toks/s, output: 76.89 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:04<17:08,  4.22s/it, est. speed input: 18.62 toks/s, output: 175.74 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:08<32:35,  7.88s/it, est. speed input: 12.13 toks/s, output: 106.94 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:16<35:35,  8.61s/it, est. speed input: 10.40 toks/s, output: 124.08 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:23<22:18,  5.48s/it, est. speed input: 15.19 toks/s, output: 174.02 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:23<24:01,  5.91s/it, est. speed input: 14.48 toks/s, output: 148.93 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:23<14:35,  3.65s/it, est. speed input: 18.03 toks/s, output: 206.26 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [01:28<1:33:04, 22.16s/it, est. speed input: 4.65 toks/s, output: 65.90 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:38<24:44,  6.08s/it, est. speed input: 9.99 toks/s, output: 190.22 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00, 15.55it/s, est. speed input: 325.17 toks/s, output: 4667.96 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00, 15.55it/s, est. speed input: 325.17 toks/s, output: 4667.96 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 325.17 toks/s, output: 4667.96 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:44<08:56,  2.35s/it, est. speed input: 28.00 toks/s, output: 347.74 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 168/256 [01:44<00:12,  7.33it/s, est. speed input: 193.47 toks/s, output: 3010.83 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  7.33it/s, est. speed input: 316.12 toks/s, output: 4660.51 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 316.12 toks/s, output: 4660.51 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.90s/it, est. speed input: 311.64 toks/s, output: 4703.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.45it/s, est. speed input: 311.64 toks/s, output: 4703.93 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:11:03 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:09:15 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:09:15 [gpu_worker.py:117] Sleep mode freed 62.22 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:09:15 [executor_base.py:189] It took 0.476153 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:09:18 [executor_base.py:205] It took 0.361473 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:11:04 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:11:04 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:11:18 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.221, å¹³å‡æƒé‡=0.779
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:11:03 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:11:04 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:11:04 [gpu_worker.py:117] Sleep mode freed 62.39 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:11:04 [executor_base.py:189] It took 0.503148 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:11:36 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:11:36 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:11:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:11:37 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:11:37 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:11:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 24x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:11:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 17/128 å®Œæˆ (34/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:11:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:11:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:12:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 38/128 å®Œæˆ (76/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:12:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 47/128 å®Œæˆ (94/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:12:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 58/128 å®Œæˆ (116/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:12:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:12:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 71/128 å®Œæˆ (142/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:12:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 80/128 å®Œæˆ (160/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:12:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 90/128 å®Œæˆ (180/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:12:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:12:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 103/128 å®Œæˆ (206/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:12:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 111/128 å®Œæˆ (222/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:12:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 121/128 å®Œæˆ (242/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:13:19 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:13:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:13:21 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:13:24 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:13:26 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:13:33 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 135.3s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:13:33 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:14:01 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:36 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3390)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3452)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3711)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3653)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3746)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3410)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:14:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3405)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:14 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3332)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3643)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3702)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3575)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3631)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3335)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:15:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3335)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:08 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3495)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3689)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3757)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3647)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3601)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3177)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:16:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3220)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:16:53 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:16:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3148)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:16:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3402)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:16:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3694)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:17:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3564)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:17:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3611)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:17:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3330)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:17:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3355)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:17:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3418)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:17:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3402)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:17:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3731)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:17:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.3573)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:17:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3645)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:17:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.3623)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:17:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3621)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:17:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3607)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:17:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3677)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:18:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3652)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:18:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3660)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:18:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3705)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:18:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3698)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:18:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3708)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:18:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3674)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:18:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3726)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:18:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3687)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:18:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3706)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:18:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 58/64 å®Œæˆ (232/256 æ¡æ ·æœ¬, loss=0.3726)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:19:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 60/64 å®Œæˆ (240/256 æ¡æ ·æœ¬, loss=0.3717)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:19:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3738)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:19:13 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.90e-06, è€—æ—¶ 276.8s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:19:22 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:19:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3796)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:19:13 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.90e-06, è€—æ—¶ 239.2s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:19:22 [executor_base.py:205] It took 0.351600 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:19:22 [executor_base.py:205] It took 0.305224 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:19:22 [executor_base.py:205] It took 0.359852 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:19:51 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:19:51 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:19:51 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:19:51 [executor_base.py:189] It took 0.495726 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:19:51 vtd_trainer_ray.py:1123] æ­¥éª¤ 15: {'vtd_loss': 0.37289255065843463, 'distill_loss': 0.37289255065843463, 'avg_se_weight': 0.7790671875, 'actor_lr': 2.8990252075256942e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.2209328125, 'step_time': 633.9617624282837, 'phase1_generate_time': 106.43151521682739, 'phase2_collect_time': 135.27326011657715, 'phase3_train_time': 348.728492975235} [é‡‡æ ·=106.4s æ”¶é›†=135.3s è®­ç»ƒ=348.7s æ€»è®¡=634.0s]
[36m(VtDStudentActor pid=843942)[0m Deleted oldest ckpt /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints/_actor/global_step6
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:20:45 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 15, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:20:45 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:19:51 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:19:51 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:19:51 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:19:51 [executor_base.py:189] It took 0.475691 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:20:45 [executor_base.py:205] It took 0.376752 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:20:45 [executor_base.py:205] It took 0.402517 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:44<17:08,  4.28s/it, est. speed input: 21.19 toks/s, output: 257.23 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  4.28s/it, est. speed input: 327.37 toks/s, output: 4827.19 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:45<00:00,  2.44it/s, est. speed input: 327.37 toks/s, output: 4827.19 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:02, 53.30it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 125/165 [00:01<00:00, 83.71it/s]
Adding requests:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 136/165 [00:01<00:00, 90.41it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:02<00:00, 59.28it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:10<29:59, 10.98s/it, est. speed input: 40.64 toks/s, output: 27.24 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 146/165 [00:01<00:00, 55.94it/s][32m [repeated 54x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 56.53it/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:36, 12.29s/it, est. speed input: 37.91 toks/s, output: 27.09 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 2/165 [00:12<13:58,  5.15s/it, est. speed input: 74.39 toks/s, output: 53.40 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/165 [00:12<05:14,  1.96s/it, est. speed input: 146.62 toks/s, output: 107.18 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   7%|â–‹         | 12/165 [00:17<01:36,  1.58it/s, est. speed input: 316.28 toks/s, output: 259.50 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  16%|â–ˆâ–Œ        | 26/165 [00:22<01:08,  2.02it/s, est. speed input: 541.11 toks/s, output: 559.33 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–       | 41/165 [00:27<00:47,  2.62it/s, est. speed input: 695.40 toks/s, output: 842.05 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 55/165 [00:32<00:26,  4.20it/s, est. speed input: 782.55 toks/s, output: 1019.23 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 72/165 [00:37<00:27,  3.43it/s, est. speed input: 900.60 toks/s, output: 1325.16 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 81/165 [00:43<00:52,  1.61it/s, est. speed input: 889.54 toks/s, output: 1394.94 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 95/165 [00:48<00:50,  1.39it/s, est. speed input: 923.60 toks/s, output: 1545.32 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 106/165 [00:53<00:39,  1.49it/s, est. speed input: 939.36 toks/s, output: 1697.37 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 110/165 [00:59<00:20,  2.75it/s, est. speed input: 884.75 toks/s, output: 1714.47 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [01:04<00:39,  1.21it/s, est. speed input: 871.71 toks/s, output: 1724.43 toks/s][32m [repeated 16x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [01:05<00:00, 15.82it/s, est. speed input: 1119.35 toks/s, output: 2651.39 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 15.82it/s, est. speed input: 1199.94 toks/s, output: 2992.34 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.51it/s, est. speed input: 1199.94 toks/s, output: 2992.34 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  9.62it/s, est. speed input: 1194.38 toks/s, output: 3136.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.47it/s, est. speed input: 1194.38 toks/s, output: 3136.87 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:21:55 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:20:45 [executor_base.py:205] It took 0.405541 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:21:55 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:21:56 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:21:56 [gpu_worker.py:117] Sleep mode freed 61.84 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:21:56 [executor_base.py:189] It took 0.536824 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:21:56 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 549/660 = 83.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:21:56 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:21:57 [executor_base.py:205] It took 0.853220 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   2%|â–         | 4/165 [00:00<00:08, 18.14it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 120/165 [01:07<00:22,  2.03it/s, est. speed input: 854.44 toks/s, output: 1801.61 toks/s][32m [repeated 16x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:02<00:00, 90.66it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.03it/s, est. speed input: 1183.75 toks/s, output: 3170.94 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.46it/s, est. speed input: 1183.75 toks/s, output: 3170.94 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:02<00:00, 90.65it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 60.16it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 148/164 [00:02<00:00, 90.58it/s][32m [repeated 66x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:10<29:48, 10.97s/it, est. speed input: 41.28 toks/s, output: 27.98 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:02<00:00, 58.59it/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:12<14:21,  5.32s/it, est. speed input: 75.38 toks/s, output: 50.66 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–Œ         | 9/165 [00:17<02:01,  1.28it/s, est. speed input: 234.17 toks/s, output: 210.96 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  12%|â–ˆâ–        | 19/165 [00:22<00:47,  3.09it/s, est. speed input: 384.26 toks/s, output: 411.02 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 36/165 [00:27<00:25,  5.10it/s, est. speed input: 600.37 toks/s, output: 781.59 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–ˆ       | 50/165 [00:32<00:43,  2.61it/s, est. speed input: 708.25 toks/s, output: 1007.65 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 67/165 [00:39<01:08,  1.44it/s, est. speed input: 802.80 toks/s, output: 1247.90 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 99/165 [00:45<00:54,  1.22it/s, est. speed input: 1035.89 toks/s, output: 1689.10 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 99/165 [00:50<00:32,  2.05it/s, est. speed input: 930.77 toks/s, output: 1668.89 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 112/165 [00:56<00:20,  2.60it/s, est. speed input: 954.27 toks/s, output: 1864.96 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 107/164 [01:01<00:37,  1.53it/s, est. speed input: 830.28 toks/s, output: 1638.54 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [01:07<01:25,  1.78s/it, est. speed input: 832.25 toks/s, output: 1572.87 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  4.28it/s, est. speed input: 1183.73 toks/s, output: 3021.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1183.73 toks/s, output: 3021.93 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:07<00:01, 10.47it/s, est. speed input: 1081.06 toks/s, output: 2774.84 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [01:07<00:00, 10.39it/s, est. speed input: 1105.85 toks/s, output: 2819.69 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 10.39it/s, est. speed input: 1171.11 toks/s, output: 3089.74 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1171.11 toks/s, output: 3089.74 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 124/164 [01:08<00:07,  5.10it/s, est. speed input: 865.47 toks/s, output: 1957.32 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  5.10it/s, est. speed input: 1154.04 toks/s, output: 3151.40 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  2.39it/s, est. speed input: 1154.04 toks/s, output: 3151.40 toks/s]
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:21:57 [executor_base.py:205] It took 1.004726 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:23:08 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:21:56 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:21:56 [gpu_worker.py:117] Sleep mode freed 62.24 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:21:56 [executor_base.py:189] It took 0.510165 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:23:10 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1110/1319 = 84.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:23:10 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 15 å®Œæˆ: å‡†ç¡®çŽ‡ 84.2% (1110/1319), è€—æ—¶ 144.8s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:23:10 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_15.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:23:10 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  17%|â–ˆâ–‹        | 15/89 [3:15:49<16:31:16, 803.74s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:23:10 [executor_base.py:205] It took 0.347039 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  22%|â–ˆâ–ˆâ–       | 14/64 [00:00<00:00, 139.58it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:00<00:00, 159.77it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 171.93it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 151.36it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:42<44:29, 10.60s/it, est. speed input: 7.64 toks/s, output: 66.49 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 10.47it/s, est. speed input: 1177.17 toks/s, output: 3166.54 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1177.17 toks/s, output: 3166.54 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:00<00:00, 149.77it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:00<00:00, 167.52it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 179.60it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:49<51:39, 12.30s/it, est. speed input: 8.78 toks/s, output: 64.60 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:01<29:52,  7.23s/it, est. speed input: 11.57 toks/s, output: 111.16 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:07<15:48,  3.89s/it, est. speed input: 18.66 toks/s, output: 175.00 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:12<07:33,  1.92s/it, est. speed input: 28.46 toks/s, output: 265.80 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:22<23:05,  5.68s/it, est. speed input: 15.18 toks/s, output: 168.25 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:27<11:22,  2.89s/it, est. speed input: 23.59 toks/s, output: 277.20 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:33<09:22,  2.43s/it, est. speed input: 25.49 toks/s, output: 321.92 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:41<07:30,  1.97s/it, est. speed input: 28.26 toks/s, output: 355.08 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–Œ       | 64/256 [01:43<00:47,  4.07it/s, est. speed input: 77.67 toks/s, output: 1031.26 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  4.07it/s, est. speed input: 355.37 toks/s, output: 4667.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 355.37 toks/s, output: 4667.23 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  9.29it/s, est. speed input: 318.32 toks/s, output: 4705.10 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 318.32 toks/s, output: 4705.10 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:23:10 [executor_base.py:205] It took 0.335358 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:24:55 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:23:09 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:23:09 [gpu_worker.py:117] Sleep mode freed 62.40 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:23:09 [executor_base.py:189] It took 0.523113 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:24:55 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:24:55 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:25:09 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.234, å¹³å‡æƒé‡=0.766
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:24:55 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:24:55 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:24:55 [gpu_worker.py:117] Sleep mode freed 62.48 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:24:55 [executor_base.py:189] It took 0.482750 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:25:27 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:25:28 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:25:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:25:28 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:25:28 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:25:33 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:25:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 14/128 å®Œæˆ (28/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:25:44 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 24/128 å®Œæˆ (48/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:25:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:25:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 39/128 å®Œæˆ (78/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:25:59 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:26:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:26:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:26:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:26:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 79/128 å®Œæˆ (158/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:26:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 87/128 å®Œæˆ (174/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:26:32 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 99/128 å®Œæˆ (198/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:26:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 108/128 å®Œæˆ (216/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:26:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 116/128 å®Œæˆ (232/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:26:48 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 123/128 å®Œæˆ (246/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:27:10 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:26:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:27:12 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:27:15 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:27:17 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:27:24 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 135.1s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:27:24 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:27:52 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:27 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3514)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3054)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3090)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3031)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3034)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3359)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:28:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3391)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:05 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3293)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2906)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3203)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3085)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3041)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3369)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:29:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3392)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:29:55 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:29:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3344)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:30:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2870)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:30:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2803)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:30:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2783)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:30:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2798)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:30:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3158)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:30:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3169)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:30:50 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:30:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2762)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:30:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2740)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:30:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2913)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:30:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2904)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:31:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2878)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:31:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3224)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:31:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3214)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:31:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3378)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:31:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3398)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:31:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3531)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:31:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3534)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:31:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3496)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:31:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3608)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:31:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3478)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:31:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3605)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:32:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3622)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:32:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3691)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:32:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 38/64 å®Œæˆ (152/256 æ¡æ ·æœ¬, loss=0.3616)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:32:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3673)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:32:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3680)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:32:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3627)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:32:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3703)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:32:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3709)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:32:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3684)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:32:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 58/64 å®Œæˆ (232/256 æ¡æ ·æœ¬, loss=0.3725)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:33:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3679)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:33:12 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.88e-06, è€—æ—¶ 284.9s
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:33:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3675)[32m [repeated 12x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:33:20 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:33:12 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.88e-06, è€—æ—¶ 246.7s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:33:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3676)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:33:21 [executor_base.py:205] It took 0.385874 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:33:21 [executor_base.py:205] It took 0.387132 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:33:21 [executor_base.py:205] It took 0.379482 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 480x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:33:49 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:33:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:33:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:33:50 [executor_base.py:189] It took 0.457553 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:33:50 vtd_trainer_ray.py:1123] æ­¥éª¤ 16: {'vtd_loss': 0.3675153712974861, 'distill_loss': 0.3675153712974861, 'avg_se_weight': 0.76582265625, 'actor_lr': 2.879181641969215e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.23417734375, 'step_time': 640.1862170696259, 'phase1_generate_time': 105.50376009941101, 'phase2_collect_time': 135.105406999588, 'phase3_train_time': 355.99194622039795} [é‡‡æ ·=105.5s æ”¶é›†=135.1s è®­ç»ƒ=356.0s æ€»è®¡=640.2s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:33:50 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 16, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:33:50 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:33:52 [executor_base.py:205] It took 1.973393 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:43<08:34,  2.30s/it, est. speed input: 35.26 toks/s, output: 384.06 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:44<09:29,  2.50s/it, est. speed input: 28.70 toks/s, output: 353.07 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.50s/it, est. speed input: 334.47 toks/s, output: 4744.64 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 334.47 toks/s, output: 4744.64 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.30s/it, est. speed input: 337.55 toks/s, output: 4695.11 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 337.55 toks/s, output: 4695.11 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:33:52 [executor_base.py:205] It took 1.935004 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   3%|â–Ž         | 5/165 [00:00<00:03, 45.69it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 93.26it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:01<00:00, 94.65it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 88.78it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:09<25:40,  9.39s/it, est. speed input: 49.19 toks/s, output: 30.66 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 145/165 [00:01<00:00, 86.31it/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.93it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 86.90it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 87.09it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:11<32:15, 11.80s/it, est. speed input: 37.80 toks/s, output: 25.09 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–Œ         | 10/165 [00:17<02:11,  1.18it/s, est. speed input: 269.04 toks/s, output: 230.09 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 31/165 [00:22<00:22,  6.05it/s, est. speed input: 649.02 toks/s, output: 689.35 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–‰       | 49/165 [00:27<00:16,  7.07it/s, est. speed input: 840.44 toks/s, output: 998.72 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–‰       | 49/165 [00:32<01:32,  1.25it/s, est. speed input: 702.46 toks/s, output: 915.78 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 85/165 [00:39<00:48,  1.66it/s, est. speed input: 1014.82 toks/s, output: 1494.01 toks/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 94/165 [00:44<00:51,  1.38it/s, est. speed input: 996.69 toks/s, output: 1557.11 toks/s] [32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 107/165 [00:49<00:17,  3.41it/s, est. speed input: 1016.42 toks/s, output: 1750.37 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [00:55<00:45,  1.11it/s, est. speed input: 982.25 toks/s, output: 1782.61 toks/s] [32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 123/165 [01:00<00:27,  1.52it/s, est. speed input: 970.38 toks/s, output: 1891.36 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 22.57it/s, est. speed input: 1215.84 toks/s, output: 3074.01 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 22.57it/s, est. speed input: 1215.84 toks/s, output: 3074.01 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.55it/s, est. speed input: 1215.84 toks/s, output: 3074.01 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [01:06<00:25,  1.66it/s, est. speed input: 883.51 toks/s, output: 1869.76 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  8.96it/s, est. speed input: 1176.88 toks/s, output: 3142.20 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1176.88 toks/s, output: 3142.20 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  3.16it/s, est. speed input: 1177.15 toks/s, output: 3127.29 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1177.15 toks/s, output: 3127.29 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:35:02 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:33:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:33:50 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:33:50 [executor_base.py:189] It took 0.503574 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:33:52 [executor_base.py:205] It took 1.946889 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:35:03 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 537/660 = 81.4%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:35:03 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:35:03 [executor_base.py:205] It took 0.328692 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:02, 55.87it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 88.89it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [00:01<00:00, 91.30it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.49it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:47, 11.63s/it, est. speed input: 40.58 toks/s, output: 26.74 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.89it/s, est. speed input: 1167.91 toks/s, output: 3183.79 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1167.91 toks/s, output: 3183.79 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 146/164 [00:01<00:00, 87.80it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 85.29it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:01<00:00, 89.75it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.98it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 3/165 [00:16<12:35,  4.66s/it, est. speed input: 81.51 toks/s, output: 64.97 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   9%|â–‰         | 15/165 [00:22<02:29,  1.00it/s, est. speed input: 310.48 toks/s, output: 301.44 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 31/165 [00:27<00:19,  6.95it/s, est. speed input: 525.99 toks/s, output: 650.35 toks/s][32m [repeated 61x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–ˆ       | 50/165 [00:32<00:34,  3.29it/s, est. speed input: 714.96 toks/s, output: 954.46 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 59/165 [00:37<00:39,  2.70it/s, est. speed input: 737.88 toks/s, output: 1082.86 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 82/165 [00:43<00:41,  1.98it/s, est. speed input: 894.42 toks/s, output: 1446.84 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 96/165 [00:48<00:36,  1.87it/s, est. speed input: 943.50 toks/s, output: 1564.78 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 94/165 [00:53<00:45,  1.55it/s, est. speed input: 832.84 toks/s, output: 1534.00 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:58<01:03,  1.02s/it, est. speed input: 836.01 toks/s, output: 1478.05 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [01:04<01:17,  1.39s/it, est. speed input: 806.38 toks/s, output: 1509.57 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00, 17.92it/s, est. speed input: 1157.75 toks/s, output: 3105.15 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00, 17.92it/s, est. speed input: 1157.75 toks/s, output: 3105.15 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:08<00:00,  2.40it/s, est. speed input: 1157.75 toks/s, output: 3105.15 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 22.74it/s, est. speed input: 1169.32 toks/s, output: 3090.44 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.41it/s, est. speed input: 1169.32 toks/s, output: 3090.44 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 120/165 [01:08<00:17,  2.53it/s, est. speed input: 831.72 toks/s, output: 1850.88 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.53it/s, est. speed input: 1156.80 toks/s, output: 3185.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.39it/s, est. speed input: 1156.80 toks/s, output: 3185.77 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:36:14 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:35:02 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:35:02 [gpu_worker.py:117] Sleep mode freed 61.98 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:35:02 [executor_base.py:189] It took 0.490706 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:35:03 [executor_base.py:205] It took 0.315336 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:36:17 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1083/1319 = 82.1%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:36:17 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 16 å®Œæˆ: å‡†ç¡®çŽ‡ 82.1% (1083/1319), è€—æ—¶ 146.8s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:36:17 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_16.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:36:17 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  18%|â–ˆâ–Š        | 16/89 [3:28:56<16:11:45, 798.71s/it]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:08<00:19,  2.37it/s, est. speed input: 828.83 toks/s, output: 1829.81 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:36:17 [executor_base.py:205] It took 0.356933 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  17%|â–ˆâ–‹        | 11/64 [00:00<00:00, 102.45it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 161.80it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:00<00:00, 165.29it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 175.66it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:00<00:00, 179.08it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 175.11it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [01:08<00:00, 15.57it/s, est. speed input: 1121.78 toks/s, output: 2895.53 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00, 15.57it/s, est. speed input: 1164.54 toks/s, output: 3074.53 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.41it/s, est. speed input: 1164.54 toks/s, output: 3074.53 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:39<41:46,  9.95s/it, est. speed input: 11.06 toks/s, output: 79.66 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:00<00:00, 149.88it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 192.59it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:49<51:33, 12.28s/it, est. speed input: 7.98 toks/s, output: 51.71 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:54<25:44,  6.23s/it, est. speed input: 14.96 toks/s, output: 127.01 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:59<1:02:46, 14.95s/it, est. speed input: 5.62 toks/s, output: 64.40 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:05<16:36,  4.08s/it, est. speed input: 17.97 toks/s, output: 169.09 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:11<07:53,  2.01s/it, est. speed input: 27.10 toks/s, output: 306.89 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:16<14:36,  3.65s/it, est. speed input: 18.92 toks/s, output: 215.83 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:22<05:03,  1.35s/it, est. speed input: 36.62 toks/s, output: 455.11 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:30<07:35,  2.03s/it, est. speed input: 39.15 toks/s, output: 413.34 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:35<08:43,  2.30s/it, est. speed input: 28.09 toks/s, output: 332.48 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 188/256 [01:39<00:03, 19.24it/s, est. speed input: 232.54 toks/s, output: 3273.44 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:39<00:00, 19.24it/s, est. speed input: 321.18 toks/s, output: 4611.29 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:39<00:00,  2.56it/s, est. speed input: 321.18 toks/s, output: 4611.29 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  1.92s/it, est. speed input: 334.86 toks/s, output: 4713.42 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  2.55it/s, est. speed input: 334.86 toks/s, output: 4713.42 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:40<07:09,  1.92s/it, est. speed input: 30.47 toks/s, output: 399.36 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:38:00 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:36:15 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:36:15 [gpu_worker.py:117] Sleep mode freed 62.13 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:36:15 [executor_base.py:189] It took 0.470412 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:36:17 [executor_base.py:205] It took 0.334611 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:38:01 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:38:01 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:38:15 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.229, å¹³å‡æƒé‡=0.771
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:38:00 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:38:01 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:38:01 [gpu_worker.py:117] Sleep mode freed 62.39 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:38:01 [executor_base.py:189] It took 0.512537 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:38:31 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:38:31 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:38:32 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:38:32 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:38:33 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:38:37 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:38:42 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:38:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 22/128 å®Œæˆ (44/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:38:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:38:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 38/128 å®Œæˆ (76/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:39:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 45/128 å®Œæˆ (90/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:39:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 54/128 å®Œæˆ (108/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:39:13 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 64/128 å®Œæˆ (128/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:39:18 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:39:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 79/128 å®Œæˆ (158/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:39:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 86/128 å®Œæˆ (172/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:39:34 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 95/128 å®Œæˆ (190/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:39:39 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 104/128 å®Œæˆ (208/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:39:44 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 110/128 å®Œæˆ (220/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:39:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 117/128 å®Œæˆ (234/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:39:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 127/128 å®Œæˆ (254/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:40:13 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:39:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:40:14 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:40:18 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:40:19 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:40:26 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 131.2s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:40:26 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:40:54 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:29 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3896)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3334)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3226)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3409)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3484)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3309)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:41:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3176)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:05 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4190)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3414)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3249)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3319)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3460)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3260)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:42:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3109)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:42:54 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:42:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4004)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:42:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3108)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:43:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3042)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:43:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3256)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:43:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3397)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:43:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3202)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:43:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3094)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:42 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4069)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3243)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3225)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3435)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3512)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3351)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3240)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:43:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3180)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:43:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3248)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:44:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 10/64 å®Œæˆ (40/256 æ¡æ ·æœ¬, loss=0.3062)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:44:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 13/64 å®Œæˆ (52/256 æ¡æ ·æœ¬, loss=0.3252)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:44:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3566)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:44:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3607)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:44:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3564)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:44:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3640)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:44:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3607)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:44:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3586)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:44:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3660)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:44:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3635)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:45:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 38/64 å®Œæˆ (152/256 æ¡æ ·æœ¬, loss=0.3534)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:45:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3623)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:45:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3628)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:45:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3633)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:45:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3559)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:45:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3576)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:45:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3602)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:45:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 58/64 å®Œæˆ (232/256 æ¡æ ·æœ¬, loss=0.3587)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:45:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 60/64 å®Œæˆ (240/256 æ¡æ ·æœ¬, loss=0.3538)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:45:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 63/64 å®Œæˆ (252/256 æ¡æ ·æœ¬, loss=0.3604)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:46:00 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.86e-06, è€—æ—¶ 271.5s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:46:09 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:46:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3535)[32m [repeated 7x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:46:00 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.86e-06, è€—æ—¶ 235.0s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:46:09 [executor_base.py:205] It took 0.335599 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:46:10 [executor_base.py:205] It took 0.386649 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:46:10 [executor_base.py:205] It took 0.379748 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 480x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:46:38 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:46:39 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:46:39 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:46:39 [executor_base.py:189] It took 0.448134 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:46:39 vtd_trainer_ray.py:1123] æ­¥éª¤ 17: {'vtd_loss': 0.3535533235408366, 'distill_loss': 0.3535533235408366, 'avg_se_weight': 0.77121171875, 'actor_lr': 2.857649243570899e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.22878828125, 'step_time': 621.8572025299072, 'phase1_generate_time': 104.17553162574768, 'phase2_collect_time': 131.20825123786926, 'phase3_train_time': 342.81723523139954} [é‡‡æ ·=104.2s æ”¶é›†=131.2s è®­ç»ƒ=342.8s æ€»è®¡=621.9s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:46:39 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 17, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:46:39 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:46:41 [executor_base.py:205] It took 1.880454 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:46:41 [executor_base.py:205] It took 1.985271 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:42<08:27,  2.22s/it, est. speed input: 26.86 toks/s, output: 334.90 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.22s/it, est. speed input: 313.21 toks/s, output: 4681.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.49it/s, est. speed input: 313.21 toks/s, output: 4681.55 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   3%|â–Ž         | 5/165 [00:00<00:03, 44.50it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:01<00:00, 89.59it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:01<00:00, 89.19it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 87.52it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:08<24:20,  8.91s/it, est. speed input: 52.89 toks/s, output: 29.20 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 141/165 [00:01<00:00, 88.61it/s][32m [repeated 54x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 87.95it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:01<00:00, 93.84it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.82it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/165 [00:14<05:59,  2.24s/it, est. speed input: 128.53 toks/s, output: 98.75 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  14%|â–ˆâ–        | 23/165 [00:19<00:57,  2.45it/s, est. speed input: 556.35 toks/s, output: 524.79 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 44/165 [00:24<00:33,  3.65it/s, est. speed input: 841.99 toks/s, output: 911.30 toks/s][32m [repeated 65x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 74/165 [00:29<00:19,  4.76it/s, est. speed input: 1172.65 toks/s, output: 1496.19 toks/s][32m [repeated 59x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 76/165 [00:34<00:27,  3.18it/s, est. speed input: 1036.45 toks/s, output: 1375.91 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 86/165 [00:39<00:43,  1.82it/s, est. speed input: 1027.89 toks/s, output: 1456.04 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 105/165 [00:44<00:33,  1.81it/s, est. speed input: 1107.87 toks/s, output: 1723.97 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [00:50<00:13,  3.64it/s, est. speed input: 1114.27 toks/s, output: 1929.95 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [00:55<00:31,  1.54it/s, est. speed input: 1002.98 toks/s, output: 1807.80 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 121/165 [01:00<00:50,  1.14s/it, est. speed input: 948.81 toks/s, output: 1779.90 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [01:03<00:00, 16.17it/s, est. speed input: 1218.46 toks/s, output: 2899.81 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00, 16.17it/s, est. speed input: 1248.83 toks/s, output: 3029.68 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00,  2.62it/s, est. speed input: 1248.83 toks/s, output: 3029.68 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [01:04<00:01, 14.27it/s, est. speed input: 1102.81 toks/s, output: 2508.66 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 14.27it/s, est. speed input: 1240.30 toks/s, output: 3081.84 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.57it/s, est. speed input: 1240.30 toks/s, output: 3081.84 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:47:47 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:46:39 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:46:39 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:46:39 [executor_base.py:189] It took 0.460887 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:46:41 [executor_base.py:205] It took 1.985575 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  1.18it/s, est. speed input: 1236.07 toks/s, output: 3054.71 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.56it/s, est. speed input: 1236.07 toks/s, output: 3054.71 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:47:48 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 555/660 = 84.1%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:47:48 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 128/165 [01:04<00:31,  1.18it/s, est. speed input: 955.10 toks/s, output: 1880.83 toks/s][32m [repeated 15x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:47:50 [executor_base.py:205] It took 1.962504 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:02, 57.35it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [01:04<00:02,  5.93it/s, est. speed input: 1148.75 toks/s, output: 2574.61 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  5.93it/s, est. speed input: 1240.79 toks/s, output: 2956.18 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.57it/s, est. speed input: 1240.79 toks/s, output: 2956.18 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:01<00:00, 83.62it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 82.96it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 156/164 [00:01<00:00, 83.15it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 83.18it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:07, 11.39s/it, est. speed input: 39.96 toks/s, output: 26.08 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/164 [00:01<00:00, 81.31it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 85.72it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.72it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:11<31:58, 11.77s/it, est. speed input: 40.53 toks/s, output: 25.24 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   7%|â–‹         | 12/165 [00:17<01:45,  1.44it/s, est. speed input: 312.16 toks/s, output: 275.70 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 32/165 [00:23<00:25,  5.13it/s, est. speed input: 647.55 toks/s, output: 739.40 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  31%|â–ˆâ–ˆâ–ˆ       | 51/165 [00:28<00:27,  4.19it/s, est. speed input: 840.46 toks/s, output: 1070.32 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:33<00:29,  3.40it/s, est. speed input: 913.01 toks/s, output: 1263.83 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 93/165 [00:38<00:32,  2.19it/s, est. speed input: 1149.29 toks/s, output: 1664.02 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 99/165 [00:43<00:21,  3.07it/s, est. speed input: 1075.91 toks/s, output: 1785.58 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/164 [00:48<00:20,  2.86it/s, est. speed input: 1014.83 toks/s, output: 1702.59 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [00:53<00:37,  1.26it/s, est. speed input: 1038.77 toks/s, output: 1911.26 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 128/165 [00:58<00:23,  1.61it/s, est. speed input: 1040.45 toks/s, output: 2072.49 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00,  5.17it/s, est. speed input: 1252.24 toks/s, output: 3100.49 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00,  2.60it/s, est. speed input: 1252.24 toks/s, output: 3100.49 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 134/165 [01:04<00:18,  1.65it/s, est. speed input: 999.29 toks/s, output: 2091.46 toks/s] [32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:48:56 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:47:47 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:47:47 [gpu_worker.py:117] Sleep mode freed 61.96 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:47:47 [executor_base.py:189] It took 0.466077 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:47:50 [executor_base.py:205] It took 1.960990 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:48:59 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1116/1319 = 84.6%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:48:59 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 17 å®Œæˆ: å‡†ç¡®çŽ‡ 84.6% (1116/1319), è€—æ—¶ 140.2s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:48:59 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_17.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:48:59 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  19%|â–ˆâ–‰        | 17/89 [3:41:38<15:45:14, 787.70s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:48:59 [executor_base.py:205] It took 0.380359 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  28%|â–ˆâ–ˆâ–Š       | 18/64 [00:00<00:00, 159.58it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 192.43it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [00:00<00:00, 175.72it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 179.53it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:00<00:00, 163.22it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 177.45it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:04<00:00,  2.16it/s, est. speed input: 1225.61 toks/s, output: 3065.46 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:04<00:00,  2.54it/s, est. speed input: 1225.61 toks/s, output: 3065.46 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:40<42:57, 10.23s/it, est. speed input: 9.29 toks/s, output: 70.09 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:00<00:00, 141.68it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 177.96it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:49<22:50,  5.53s/it, est. speed input: 15.56 toks/s, output: 129.29 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [00:55<14:55,  3.67s/it, est. speed input: 21.26 toks/s, output: 182.73 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:00<06:50,  1.74s/it, est. speed input: 32.49 toks/s, output: 307.71 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:12<20:02,  4.93s/it, est. speed input: 19.43 toks/s, output: 191.55 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:17<06:28,  1.73s/it, est. speed input: 45.68 toks/s, output: 433.56 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [01:24<06:10,  1.68s/it, est. speed input: 47.17 toks/s, output: 474.77 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [01:30<04:19,  1.22s/it, est. speed input: 53.52 toks/s, output: 587.92 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 48/256 [01:36<04:42,  1.36s/it, est. speed input: 53.75 toks/s, output: 602.33 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 164/256 [01:40<00:08, 10.39it/s, est. speed input: 216.20 toks/s, output: 2823.58 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00, 10.39it/s, est. speed input: 331.84 toks/s, output: 4671.71 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  2.55it/s, est. speed input: 331.84 toks/s, output: 4671.71 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 248/256 [01:40<00:00, 26.76it/s, est. speed input: 313.59 toks/s, output: 4553.67 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00, 26.76it/s, est. speed input: 323.86 toks/s, output: 4716.66 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  2.55it/s, est. speed input: 323.86 toks/s, output: 4716.66 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  31%|â–ˆâ–ˆâ–ˆâ–      | 80/256 [01:40<00:40,  4.35it/s, est. speed input: 98.36 toks/s, output: 1302.15 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:50:43 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:48:57 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:48:57 [gpu_worker.py:117] Sleep mode freed 62.19 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:48:57 [executor_base.py:189] It took 0.450800 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:48:59 [executor_base.py:205] It took 0.383078 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:50:44 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:50:44 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:50:58 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.289, å¹³å‡æƒé‡=0.711
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:50:43 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:50:44 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:50:44 [gpu_worker.py:117] Sleep mode freed 62.38 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:50:44 [executor_base.py:189] It took 0.506369 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:51:16 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:51:17 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:51:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:51:17 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:51:17 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:51:23 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 00:51:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 18/128 å®Œæˆ (36/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:51:33 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:51:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:51:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 40/128 å®Œæˆ (80/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:51:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 50/128 å®Œæˆ (100/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:51:55 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 60/128 å®Œæˆ (120/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:52:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 67/128 å®Œæˆ (134/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:52:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:52:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 81/128 å®Œæˆ (162/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:52:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 90/128 å®Œæˆ (180/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:52:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 00:52:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 104/128 å®Œæˆ (208/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:52:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 00:52:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 123/128 å®Œæˆ (246/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:52:59 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 00:52:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 24x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:53:01 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:53:03 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:53:06 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:53:13 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 135.1s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:53:13 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:53:41 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:16 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4528)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3235)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3541)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3176)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3338)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3473)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:54:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3619)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:54:55 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:54:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4628)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:54:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3230)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:54:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3453)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:55:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3074)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:55:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3195)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:55:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3544)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:55:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3698)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:43 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4767)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3385)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3536)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3229)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3350)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3604)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:55:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3766)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:32 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.5393)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3694)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3650)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3159)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3301)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3536)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3641)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:56:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3632)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3699)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:56:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 10/64 å®Œæˆ (40/256 æ¡æ ·æœ¬, loss=0.3620)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:56:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 13/64 å®Œæˆ (52/256 æ¡æ ·æœ¬, loss=0.3414)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:57:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3401)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:57:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3447)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:57:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3305)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:57:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3266)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:57:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3217)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:57:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3264)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:57:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3215)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:57:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3202)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:57:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 38/64 å®Œæˆ (152/256 æ¡æ ·æœ¬, loss=0.3199)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:58:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3230)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:58:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3261)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:58:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3237)[32m [repeated 15x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:58:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 50/64 å®Œæˆ (200/256 æ¡æ ·æœ¬, loss=0.3291)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:58:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3243)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:58:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3354)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 00:58:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3365)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:58:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3344)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 00:58:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3344)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:58:51 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.83e-06, è€—æ—¶ 274.8s
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 00:58:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3341)[32m [repeated 6x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:59:00 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:58:51 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.83e-06, è€—æ—¶ 235.8s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 00:58:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3311)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:59:02 [executor_base.py:205] It took 1.942000 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 00:59:02 [executor_base.py:205] It took 1.976453 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:59:02 [executor_base.py:205] It took 1.933928 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 00:59:31 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:59:31 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:59:31 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 00:59:31 [executor_base.py:189] It took 0.455337 seconds to fall asleep.
[36m(VtDStudentActor pid=843942)[0m Deleted oldest ckpt /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints/_actor/global_step9
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 00:59:31 vtd_trainer_ray.py:1123] æ­¥éª¤ 18: {'vtd_loss': 0.334130255272612, 'distill_loss': 0.334130255272612, 'avg_se_weight': 0.710583984375, 'actor_lr': 2.834457596747188e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.289416015625, 'step_time': 632.128155708313, 'phase1_generate_time': 105.10191607475281, 'phase2_collect_time': 135.0744297504425, 'phase3_train_time': 346.89627742767334} [é‡‡æ ·=105.1s æ”¶é›†=135.1s è®­ç»ƒ=346.9s æ€»è®¡=632.1s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:00:25 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 18, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:00:25 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:59:31 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:59:31 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:59:31 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 00:59:31 [executor_base.py:189] It took 0.494891 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:00:25 [executor_base.py:205] It took 0.430037 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:43<10:43,  2.82s/it, est. speed input: 27.01 toks/s, output: 332.34 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.82s/it, est. speed input: 370.77 toks/s, output: 4745.28 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 370.77 toks/s, output: 4745.28 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:00:25 [executor_base.py:205] It took 0.417756 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:03, 50.67it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:01<00:00, 88.52it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:01<00:00, 93.60it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 87.70it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:11<30:39, 11.21s/it, est. speed input: 41.82 toks/s, output: 24.97 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [00:01<00:00, 83.80it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.65it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:01<00:00, 87.65it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.25it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   4%|â–         | 7/165 [00:16<02:59,  1.14s/it, est. speed input: 191.39 toks/s, output: 168.16 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 21/165 [00:22<00:38,  3.73it/s, est. speed input: 445.79 toks/s, output: 456.83 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  20%|â–ˆâ–ˆ        | 33/165 [00:27<00:35,  3.73it/s, est. speed input: 574.08 toks/s, output: 661.05 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:32<00:40,  2.46it/s, est. speed input: 946.22 toks/s, output: 1220.25 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 83/165 [00:38<00:42,  1.92it/s, est. speed input: 1021.58 toks/s, output: 1487.56 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 78/165 [00:43<00:39,  2.20it/s, est. speed input: 845.46 toks/s, output: 1322.17 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 89/165 [00:48<00:35,  2.15it/s, est. speed input: 865.69 toks/s, output: 1461.60 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 105/165 [00:53<00:45,  1.32it/s, est. speed input: 933.30 toks/s, output: 1688.04 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 111/165 [00:59<00:46,  1.16it/s, est. speed input: 895.80 toks/s, output: 1744.52 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [01:04<00:00, 18.78it/s, est. speed input: 1089.54 toks/s, output: 2610.85 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 18.78it/s, est. speed input: 1225.59 toks/s, output: 3182.03 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.57it/s, est. speed input: 1225.59 toks/s, output: 3182.03 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 132/165 [01:04<00:04,  7.98it/s, est. speed input: 979.69 toks/s, output: 2136.38 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [01:07<00:00, 20.40it/s, est. speed input: 1093.10 toks/s, output: 2738.70 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 20.40it/s, est. speed input: 1180.44 toks/s, output: 3101.67 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1180.44 toks/s, output: 3101.67 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:01:35 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:00:25 [executor_base.py:205] It took 0.410082 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:01:35 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:01:36 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:01:36 [gpu_worker.py:117] Sleep mode freed 62.05 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:01:36 [executor_base.py:189] It took 0.443407 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:01:36 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 538/660 = 81.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:01:36 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:01:36 [executor_base.py:205] It took 0.354498 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:01, 78.71it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:07<00:58,  1.28s/it, est. speed input: 836.19 toks/s, output: 1750.46 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.28s/it, est. speed input: 1169.35 toks/s, output: 3133.62 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.43it/s, est. speed input: 1169.35 toks/s, output: 3133.62 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [01:07<00:24,  1.79it/s, est. speed input: 867.38 toks/s, output: 1801.57 toks/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 80.96it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 88.30it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.13it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/164 [00:01<00:00, 88.89it/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:12<33:55, 12.49s/it, est. speed input: 38.20 toks/s, output: 26.19 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 85.69it/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:12<34:52, 12.76s/it, est. speed input: 37.16 toks/s, output: 26.73 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   4%|â–         | 7/165 [00:17<02:37,  1.00it/s, est. speed input: 179.60 toks/s, output: 161.97 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–Š         | 14/164 [00:22<01:22,  1.81it/s, est. speed input: 283.99 toks/s, output: 306.92 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  26%|â–ˆâ–ˆâ–Œ       | 43/165 [00:28<00:25,  4.77it/s, est. speed input: 710.69 toks/s, output: 911.80 toks/s][32m [repeated 68x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 61/165 [00:33<00:20,  4.97it/s, est. speed input: 857.13 toks/s, output: 1176.42 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 66/165 [00:38<00:37,  2.67it/s, est. speed input: 810.45 toks/s, output: 1195.30 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 93/165 [00:43<01:02,  1.15it/s, est. speed input: 1012.57 toks/s, output: 1581.54 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 95/164 [00:49<00:38,  1.78it/s, est. speed input: 913.78 toks/s, output: 1555.48 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:54<00:49,  1.29it/s, est. speed input: 884.60 toks/s, output: 1633.16 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 112/165 [00:59<00:34,  1.53it/s, est. speed input: 901.26 toks/s, output: 1760.68 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [01:05<00:37,  1.37it/s, est. speed input: 837.99 toks/s, output: 1708.90 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [01:06<00:00, 19.66it/s, est. speed input: 1141.60 toks/s, output: 2866.66 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 19.66it/s, est. speed input: 1208.53 toks/s, output: 3144.35 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1208.53 toks/s, output: 3144.35 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 10.39it/s, est. speed input: 1190.02 toks/s, output: 3177.94 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.47it/s, est. speed input: 1190.02 toks/s, output: 3177.94 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 146/164 [01:07<00:00, 21.46it/s, est. speed input: 1034.58 toks/s, output: 2575.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00, 21.46it/s, est. speed input: 1166.45 toks/s, output: 3119.18 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:07<00:00,  2.42it/s, est. speed input: 1166.45 toks/s, output: 3119.18 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:01:36 [executor_base.py:205] It took 0.351190 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:02:46 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:01:36 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:01:36 [gpu_worker.py:117] Sleep mode freed 61.99 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:01:36 [executor_base.py:189] It took 0.512652 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:02:47 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1082/1319 = 82.0%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:02:47 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 18 å®Œæˆ: å‡†ç¡®çŽ‡ 82.0% (1082/1319), è€—æ—¶ 141.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:02:47 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_18.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:02:47 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  20%|â–ˆâ–ˆ        | 18/89 [3:55:26<15:46:26, 799.82s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:02:47 [executor_base.py:205] It took 0.345588 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  20%|â–ˆâ–ˆ        | 13/64 [00:00<00:00, 120.09it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:00<00:00, 86.42it/s] 
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 67.82it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 78.22it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:36<38:20,  9.13s/it, est. speed input: 12.59 toks/s, output: 69.90 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [01:07<00:00, 31.90it/s, est. speed input: 1097.11 toks/s, output: 2844.56 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 31.90it/s, est. speed input: 1176.82 toks/s, output: 3176.30 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.43it/s, est. speed input: 1176.82 toks/s, output: 3176.30 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:00<00:00, 75.86it/s] [32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 75.84it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:47<49:23, 11.76s/it, est. speed input: 6.72 toks/s, output: 72.17 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:03<20:40,  5.08s/it, est. speed input: 19.44 toks/s, output: 151.38 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:06<13:12,  3.30s/it, est. speed input: 25.53 toks/s, output: 215.87 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:06<08:23,  2.13s/it, est. speed input: 31.10 toks/s, output: 287.81 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:10<06:53,  1.78s/it, est. speed input: 35.30 toks/s, output: 337.40 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [01:11<1:15:09, 17.89s/it, est. speed input: 5.20 toks/s, output: 50.42 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:12<1:16:19, 18.17s/it, est. speed input: 5.17 toks/s, output: 60.44 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:18<39:07,  9.47s/it, est. speed input: 9.53 toks/s, output: 109.70 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:29<11:18,  2.87s/it, est. speed input: 20.41 toks/s, output: 258.32 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:34<09:07,  2.32s/it, est. speed input: 24.04 toks/s, output: 293.10 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:40<29:15,  7.19s/it, est. speed input: 13.29 toks/s, output: 150.96 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 148/256 [01:41<00:17,  6.24it/s, est. speed input: 187.87 toks/s, output: 2542.73 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00,  6.24it/s, est. speed input: 351.24 toks/s, output: 4662.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00,  2.52it/s, est. speed input: 351.24 toks/s, output: 4662.98 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:02:47 [executor_base.py:205] It took 0.328611 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:04:31 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:02:47 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:02:47 [gpu_worker.py:117] Sleep mode freed 62.11 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:02:47 [executor_base.py:189] It took 0.511607 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.26s/it, est. speed input: 359.51 toks/s, output: 4715.11 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 359.51 toks/s, output: 4715.11 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:04:33 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:04:33 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:04:47 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.254, å¹³å‡æƒé‡=0.746
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:04:31 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:04:33 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:04:33 [gpu_worker.py:117] Sleep mode freed 62.52 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:04:33 [executor_base.py:189] It took 2.140496 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:05:04 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:05:04 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:05:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:05:04 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:05:05 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:05:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 25x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:05:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 14/128 å®Œæˆ (28/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:05:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 23/128 å®Œæˆ (46/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:05:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 33/128 å®Œæˆ (66/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:05:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 39/128 å®Œæˆ (78/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:05:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:05:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 55/128 å®Œæˆ (110/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:05:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:05:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:05:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 79/128 å®Œæˆ (158/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:06:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 86/128 å®Œæˆ (172/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:06:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 43x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:06:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 107/128 å®Œæˆ (214/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:06:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 114/128 å®Œæˆ (228/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:06:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 122/128 å®Œæˆ (244/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:06:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:06:47 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:06:51 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:06:52 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:06:54 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:07:01 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 133.8s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:07:01 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:07:29 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:05 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4957)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3892)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3972)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3723)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3567)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3630)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:08:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3555)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:43 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.5521)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4058)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4010)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3786)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3644)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3685)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:08:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3686)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:34 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4685)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3750)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3913)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3740)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3628)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3671)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:09:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3677)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:23 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4679)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3429)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3545)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3445)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3385)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3412)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3434)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:10:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3640)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3471)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:10:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 10/64 å®Œæˆ (40/256 æ¡æ ·æœ¬, loss=0.3565)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:10:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 13/64 å®Œæˆ (52/256 æ¡æ ·æœ¬, loss=0.3319)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:10:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3258)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:11:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3205)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:11:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.3207)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:11:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3304)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:11:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3320)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:11:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 31/64 å®Œæˆ (124/256 æ¡æ ·æœ¬, loss=0.3276)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:11:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3356)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:11:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3309)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:11:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3321)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:11:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3248)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:11:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3271)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:12:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3256)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:12:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 50/64 å®Œæˆ (200/256 æ¡æ ·æœ¬, loss=0.3268)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:12:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3362)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:12:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3337)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:12:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3294)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:12:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3334)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:12:43 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.81e-06, è€—æ—¶ 277.7s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:12:54 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:12:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3413)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:12:43 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.81e-06, è€—æ—¶ 240.6s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:12:54 [executor_base.py:205] It took 0.356430 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:12:54 [executor_base.py:205] It took 0.358638 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:12:54 [executor_base.py:205] It took 0.357054 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:13:23 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:13:23 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:13:23 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:13:23 [executor_base.py:189] It took 0.429775 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:13:23 vtd_trainer_ray.py:1123] æ­¥éª¤ 19: {'vtd_loss': 0.33525624335743487, 'distill_loss': 0.33525624335743487, 'avg_se_weight': 0.745708203125, 'actor_lr': 2.8096385656371773e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.254291796875, 'step_time': 636.4311947822571, 'phase1_generate_time': 106.48118543624878, 'phase2_collect_time': 133.82680320739746, 'phase3_train_time': 352.38032388687134} [é‡‡æ ·=106.5s æ”¶é›†=133.8s è®­ç»ƒ=352.4s æ€»è®¡=636.4s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:13:23 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 19, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:13:23 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:13:24 [executor_base.py:205] It took 0.346588 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:42<08:34,  2.26s/it, est. speed input: 25.92 toks/s, output: 365.46 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 116/256 [01:42<00:42,  3.31it/s, est. speed input: 154.86 toks/s, output: 2130.58 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  3.31it/s, est. speed input: 343.83 toks/s, output: 4804.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.49it/s, est. speed input: 343.83 toks/s, output: 4804.43 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:13:24 [executor_base.py:205] It took 0.321008 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:02, 55.06it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 88.18it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:01<00:00, 83.92it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.91it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:21, 12.20s/it, est. speed input: 37.78 toks/s, output: 26.47 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:01<00:00, 89.76it/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:01<00:00, 83.64it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:01<00:00, 89.24it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.03it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:21, 12.21s/it, est. speed input: 36.54 toks/s, output: 25.40 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   4%|â–Ž         | 6/165 [00:17<04:38,  1.75s/it, est. speed input: 157.67 toks/s, output: 129.88 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–        | 19/165 [00:23<02:04,  1.17it/s, est. speed input: 378.45 toks/s, output: 372.59 toks/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–       | 40/165 [00:28<00:46,  2.67it/s, est. speed input: 669.91 toks/s, output: 787.27 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 72/165 [00:33<00:20,  4.51it/s, est. speed input: 1012.51 toks/s, output: 1377.96 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 80/165 [00:38<00:51,  1.67it/s, est. speed input: 979.75 toks/s, output: 1398.64 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 86/165 [00:43<00:29,  2.70it/s, est. speed input: 938.95 toks/s, output: 1524.38 toks/s][32m [repeated 35x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 99/165 [00:48<00:19,  3.31it/s, est. speed input: 965.63 toks/s, output: 1642.13 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 111/165 [00:53<00:32,  1.68it/s, est. speed input: 980.82 toks/s, output: 1797.62 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 110/165 [00:59<01:03,  1.15s/it, est. speed input: 880.49 toks/s, output: 1675.00 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [01:04<00:24,  1.52it/s, est. speed input: 944.39 toks/s, output: 1941.67 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [01:05<00:00, 16.95it/s, est. speed input: 1174.00 toks/s, output: 2930.44 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 16.95it/s, est. speed input: 1204.91 toks/s, output: 3055.74 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.52it/s, est. speed input: 1204.91 toks/s, output: 3055.74 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  5.62it/s, est. speed input: 1198.68 toks/s, output: 3146.17 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.48it/s, est. speed input: 1198.68 toks/s, output: 3146.17 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:14:33 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:13:23 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:13:23 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:13:23 [executor_base.py:189] It took 0.486623 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:13:24 [executor_base.py:205] It took 0.335377 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:14:34 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 545/660 = 82.6%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:14:34 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:14:34 [executor_base.py:205] It took 0.312427 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:02, 61.03it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:07<00:27,  1.68it/s, est. speed input: 842.60 toks/s, output: 1735.09 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  1.68it/s, est. speed input: 1179.94 toks/s, output: 3130.90 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.45it/s, est. speed input: 1179.94 toks/s, output: 3130.90 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 150/164 [00:03<00:00, 23.43it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:03<00:00, 21.93it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.92it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:03<00:00, 20.72it/s][32m [repeated 63x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:10<28:34, 10.52s/it, est. speed input: 45.34 toks/s, output: 29.75 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.53it/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/164 [00:03<00:00, 22.21it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 44.33it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:23, 11.49s/it, est. speed input: 41.26 toks/s, output: 30.55 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   7%|â–‹         | 12/165 [00:16<00:56,  2.72it/s, est. speed input: 341.81 toks/s, output: 294.43 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  11%|â–ˆ         | 18/165 [00:21<00:40,  3.62it/s, est. speed input: 382.39 toks/s, output: 412.48 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 45/164 [00:26<00:41,  2.84it/s, est. speed input: 785.00 toks/s, output: 992.81 toks/s][32m [repeated 54x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  35%|â–ˆâ–ˆâ–ˆâ–      | 57/165 [00:32<00:35,  3.06it/s, est. speed input: 836.38 toks/s, output: 1163.78 toks/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 71/165 [00:37<00:24,  3.83it/s, est. speed input: 908.43 toks/s, output: 1363.76 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 82/165 [00:42<00:39,  2.11it/s, est. speed input: 924.55 toks/s, output: 1480.46 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 98/165 [00:48<00:50,  1.32it/s, est. speed input: 960.90 toks/s, output: 1697.70 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 108/164 [00:53<00:36,  1.55it/s, est. speed input: 962.58 toks/s, output: 1768.95 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 116/165 [00:58<00:36,  1.35it/s, est. speed input: 951.13 toks/s, output: 1801.54 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [01:03<00:44,  1.06it/s, est. speed input: 883.26 toks/s, output: 1811.70 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [01:04<00:00, 27.46it/s, est. speed input: 1189.28 toks/s, output: 2979.96 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 27.46it/s, est. speed input: 1235.49 toks/s, output: 3168.03 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.55it/s, est. speed input: 1235.49 toks/s, output: 3168.03 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 145/164 [01:05<00:01, 18.13it/s, est. speed input: 1060.82 toks/s, output: 2550.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:05<00:00, 18.13it/s, est. speed input: 1206.12 toks/s, output: 3143.22 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:05<00:00,  2.50it/s, est. speed input: 1206.12 toks/s, output: 3143.22 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:15:44 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:14:34 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:14:34 [gpu_worker.py:117] Sleep mode freed 61.97 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:14:34 [executor_base.py:189] It took 0.482182 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:14:34 [executor_base.py:205] It took 0.325597 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:15:44 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1108/1319 = 84.0%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:15:44 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 19 å®Œæˆ: å‡†ç¡®çŽ‡ 84.0% (1108/1319), è€—æ—¶ 141.0s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:15:44 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_19.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:15:44 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  21%|â–ˆâ–ˆâ–       | 19/89 [4:08:24<15:25:17, 793.11s/it]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:15:45 [executor_base.py:205] It took 0.320546 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  22%|â–ˆâ–ˆâ–       | 14/64 [00:00<00:00, 108.18it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:01<00:00, 51.90it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:01<00:00, 62.26it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [01:00<1:03:59, 15.24s/it, est. speed input: 6.69 toks/s, output: 70.54 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.89it/s, est. speed input: 1211.92 toks/s, output: 3213.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.51it/s, est. speed input: 1211.92 toks/s, output: 3213.55 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:01<00:00, 35.95it/s][32m [repeated 16x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:01<00:00, 35.82it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:01<00:00, 44.76it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [01:08<1:11:52, 17.11s/it, est. speed input: 5.67 toks/s, output: 60.22 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:13<12:00,  3.00s/it, est. speed input: 24.01 toks/s, output: 229.21 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:22<21:19,  5.25s/it, est. speed input: 13.04 toks/s, output: 185.61 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:27<06:55,  1.79s/it, est. speed input: 30.33 toks/s, output: 322.78 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:33<10:52,  2.77s/it, est. speed input: 20.02 toks/s, output: 264.91 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:39<1:44:11, 24.81s/it, est. speed input: 3.63 toks/s, output: 66.78 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 176/256 [01:41<00:07, 10.61it/s, est. speed input: 224.28 toks/s, output: 3120.07 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00, 10.61it/s, est. speed input: 322.53 toks/s, output: 4632.57 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00,  2.52it/s, est. speed input: 322.53 toks/s, output: 4632.57 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  1.00s/it, est. speed input: 324.69 toks/s, output: 4706.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 324.69 toks/s, output: 4706.23 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:17:29 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:15:44 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:15:44 [gpu_worker.py:117] Sleep mode freed 61.99 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:15:44 [executor_base.py:189] It took 0.491401 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:15:45 [executor_base.py:205] It took 0.334617 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:17:31 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:17:31 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:17:45 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.240, å¹³å‡æƒé‡=0.760
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:17:29 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:17:31 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:17:31 [gpu_worker.py:117] Sleep mode freed 62.70 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:17:31 [executor_base.py:189] It took 2.099242 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:18:02 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:18:02 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:18:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:18:03 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:18:03 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:18:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 6/128 å®Œæˆ (12/256 æ¡åºåˆ—)[32m [repeated 25x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:18:13 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:18:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 23/128 å®Œæˆ (46/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:18:23 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 31/128 å®Œæˆ (62/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:18:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 38/128 å®Œæˆ (76/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:18:33 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 45/128 å®Œæˆ (90/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:18:39 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 54/128 å®Œæˆ (108/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:18:44 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:18:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 70/128 å®Œæˆ (140/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:18:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 77/128 å®Œæˆ (154/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:19:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 86/128 å®Œæˆ (172/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:19:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 96/128 å®Œæˆ (192/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:19:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 107/128 å®Œæˆ (214/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:19:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:19:22 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 121/128 å®Œæˆ (242/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:19:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:19:45 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:19:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:19:48 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:19:50 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:19:52 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:19:59 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 133.8s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:19:59 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:20:27 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:04 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4445)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4275)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3785)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3885)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3848)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3745)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:21:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3607)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:41 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4521)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4383)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3926)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3994)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3900)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3782)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:21:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3650)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:33 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4369)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4030)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3656)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3774)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3762)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3534)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:22:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3460)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:24 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4880)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4505)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3927)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3914)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3902)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3815)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3691)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:23:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3346)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3709)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:23:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3599)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:24:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3583)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:24:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3469)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:24:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3471)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:24:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3423)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:24:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3448)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:24:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3497)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:24:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3496)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:24:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3503)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:24:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3510)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:25:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3543)[32m [repeated 4x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:25:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3522)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:25:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3508)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:25:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3572)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:25:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3550)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:25:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3485)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:25:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 60/64 å®Œæˆ (240/256 æ¡æ ·æœ¬, loss=0.3497)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:25:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 63/64 å®Œæˆ (252/256 æ¡æ ·æœ¬, loss=0.3527)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:25:47 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.78e-06, è€—æ—¶ 282.6s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:25:57 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:25:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3612)[32m [repeated 7x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:25:47 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.78e-06, è€—æ—¶ 246.2s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:25:58 [executor_base.py:205] It took 0.344101 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:25:58 [executor_base.py:205] It took 0.359679 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:25:58 [executor_base.py:205] It took 0.331383 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 481x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:26:26 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:26:27 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:26:27 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:26:27 [executor_base.py:189] It took 0.504176 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:26:27 vtd_trainer_ray.py:1123] æ­¥éª¤ 20: {'vtd_loss': 0.3618437713012099, 'distill_loss': 0.3618437713012099, 'avg_se_weight': 0.76002265625, 'actor_lr': 2.783226250322913e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.23997734375, 'step_time': 642.4591269493103, 'phase1_generate_time': 106.74589037895203, 'phase2_collect_time': 133.81864070892334, 'phase3_train_time': 358.2588851451874} [é‡‡æ ·=106.7s æ”¶é›†=133.8s è®­ç»ƒ=358.3s æ€»è®¡=642.5s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:26:27 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 20, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:26:27 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:26:27 [executor_base.py:205] It took 0.340392 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:42<44:26, 10.75s/it, est. speed input: 7.04 toks/s, output: 131.55 toks/s] [32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 140/256 [01:41<00:16,  7.12it/s, est. speed input: 198.35 toks/s, output: 2505.27 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00,  7.12it/s, est. speed input: 380.42 toks/s, output: 4775.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00,  2.51it/s, est. speed input: 380.42 toks/s, output: 4775.87 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00, 10.75s/it, est. speed input: 342.64 toks/s, output: 4885.67 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.49it/s, est. speed input: 342.64 toks/s, output: 4885.67 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:26:27 [executor_base.py:205] It took 0.324375 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   6%|â–Œ         | 10/165 [00:00<00:02, 75.51it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:01<00:00, 83.59it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 88.54it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.70it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:11<30:57, 11.33s/it, est. speed input: 39.37 toks/s, output: 25.42 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:01<00:00, 84.23it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.80it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:01<00:00, 85.55it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.16it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:49, 11.64s/it, est. speed input: 39.68 toks/s, output: 25.34 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:16<05:30,  2.06s/it, est. speed input: 136.69 toks/s, output: 112.03 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 28/165 [00:22<00:46,  2.92it/s, est. speed input: 586.51 toks/s, output: 596.32 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  32%|â–ˆâ–ˆâ–ˆâ–      | 53/165 [00:27<00:16,  6.99it/s, est. speed input: 904.02 toks/s, output: 1089.84 toks/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  35%|â–ˆâ–ˆâ–ˆâ–      | 57/165 [00:32<00:40,  2.67it/s, est. speed input: 819.25 toks/s, output: 1022.43 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 88/165 [00:37<00:31,  2.43it/s, est. speed input: 1102.13 toks/s, output: 1595.78 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 98/165 [00:42<00:20,  3.29it/s, est. speed input: 1091.16 toks/s, output: 1776.56 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:47<00:50,  1.22it/s, est. speed input: 1023.52 toks/s, output: 1717.97 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [00:52<00:18,  2.83it/s, est. speed input: 1028.62 toks/s, output: 1860.13 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 107/165 [00:58<01:04,  1.10s/it, est. speed input: 876.24 toks/s, output: 1592.67 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 126/165 [01:04<01:14,  1.91s/it, est. speed input: 922.80 toks/s, output: 1751.24 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 141/165 [01:04<00:05,  4.62it/s, est. speed input: 1033.29 toks/s, output: 2217.72 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  4.62it/s, est. speed input: 1211.27 toks/s, output: 2970.51 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.54it/s, est. speed input: 1211.27 toks/s, output: 2970.51 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [01:05<00:01,  7.67it/s, est. speed input: 1149.33 toks/s, output: 2752.64 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  7.67it/s, est. speed input: 1216.18 toks/s, output: 3032.65 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.52it/s, est. speed input: 1216.18 toks/s, output: 3032.65 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:27:36 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:26:27 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:26:27 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:26:27 [executor_base.py:189] It took 0.475423 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:26:27 [executor_base.py:205] It took 0.324275 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:27:37 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 546/660 = 82.7%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:27:37 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:27:37 [executor_base.py:205] It took 0.351829 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:02, 56.67it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  11%|â–ˆ         | 18/165 [00:00<00:01, 79.65it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [01:06<00:50,  1.08s/it, est. speed input: 847.11 toks/s, output: 1690.18 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:06<00:38,  1.20it/s, est. speed input: 851.25 toks/s, output: 1714.84 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  1.20it/s, est. speed input: 1192.87 toks/s, output: 3126.09 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.47it/s, est. speed input: 1192.87 toks/s, output: 3126.09 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:02<00:00, 31.32it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 20.35it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 47.80it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 148/164 [00:02<00:00, 29.77it/s][32m [repeated 59x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:10<28:11, 10.38s/it, est. speed input: 43.65 toks/s, output: 29.39 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/164 [00:03<00:00, 20.06it/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 19.24it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 45.80it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:10<11:52,  4.40s/it, est. speed input: 87.81 toks/s, output: 58.26 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/165 [00:15<06:08,  2.29s/it, est. speed input: 117.69 toks/s, output: 104.52 toks/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 13/165 [00:21<01:57,  1.29it/s, est. speed input: 286.61 toks/s, output: 295.96 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  28%|â–ˆâ–ˆâ–Š       | 47/165 [00:26<00:33,  3.49it/s, est. speed input: 826.20 toks/s, output: 999.98 toks/s] [32m [repeated 67x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 62/165 [00:31<00:26,  3.93it/s, est. speed input: 916.50 toks/s, output: 1282.46 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 87/165 [00:36<00:37,  2.09it/s, est. speed input: 1117.25 toks/s, output: 1661.75 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 81/165 [00:42<00:38,  2.17it/s, est. speed input: 911.95 toks/s, output: 1462.86 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:47<00:28,  2.17it/s, est. speed input: 1055.38 toks/s, output: 1762.22 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 105/165 [00:52<00:39,  1.50it/s, est. speed input: 958.17 toks/s, output: 1759.96 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/164 [00:57<00:21,  2.14it/s, est. speed input: 981.04 toks/s, output: 1887.23 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 126/165 [01:02<00:24,  1.57it/s, est. speed input: 960.07 toks/s, output: 2030.58 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/164 [01:04<00:00, 16.52it/s, est. speed input: 1163.89 toks/s, output: 2850.52 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:04<00:00, 16.52it/s, est. speed input: 1233.52 toks/s, output: 3137.66 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:04<00:00,  2.56it/s, est. speed input: 1233.52 toks/s, output: 3137.66 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 142/165 [01:04<00:02,  7.67it/s, est. speed input: 1057.22 toks/s, output: 2436.12 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  7.67it/s, est. speed input: 1232.43 toks/s, output: 3161.80 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.55it/s, est. speed input: 1232.43 toks/s, output: 3161.80 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:28:46 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:27:36 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:27:36 [gpu_worker.py:117] Sleep mode freed 61.78 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:27:36 [executor_base.py:189] It took 0.441710 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:27:37 [executor_base.py:205] It took 0.327926 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.65it/s, est. speed input: 1218.98 toks/s, output: 3160.10 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.52it/s, est. speed input: 1218.98 toks/s, output: 3160.10 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:28:47 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1097/1319 = 83.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:28:47 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 20 å®Œæˆ: å‡†ç¡®çŽ‡ 83.2% (1097/1319), è€—æ—¶ 139.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:28:47 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_20.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:28:47 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  22%|â–ˆâ–ˆâ–       | 20/89 [4:21:26<15:08:22, 789.89s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:28:47 [executor_base.py:205] It took 0.348785 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  20%|â–ˆâ–ˆ        | 13/64 [00:00<00:00, 115.51it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [00:00<00:00, 142.89it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 180.83it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:41<43:45, 10.42s/it, est. speed input: 7.39 toks/s, output: 64.68 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [01:04<00:01, 16.50it/s, est. speed input: 1102.58 toks/s, output: 2577.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 16.50it/s, est. speed input: 1234.96 toks/s, output: 3113.12 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.55it/s, est. speed input: 1234.96 toks/s, output: 3113.12 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [00:00<00:00, 144.10it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:00<00:00, 147.28it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 160.89it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:58<28:02,  6.78s/it, est. speed input: 13.17 toks/s, output: 114.80 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [00:59<15:24,  3.79s/it, est. speed input: 19.08 toks/s, output: 168.27 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [01:08<1:11:25, 17.01s/it, est. speed input: 7.76 toks/s, output: 61.32 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:15<18:17,  4.50s/it, est. speed input: 15.60 toks/s, output: 186.57 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:20<17:25,  4.36s/it, est. speed input: 19.35 toks/s, output: 179.03 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:25<08:23,  2.17s/it, est. speed input: 26.19 toks/s, output: 316.83 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:34<06:38,  1.75s/it, est. speed input: 27.43 toks/s, output: 384.65 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  16%|â–ˆâ–Œ        | 40/256 [01:40<05:35,  1.55s/it, est. speed input: 38.16 toks/s, output: 499.07 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  2.62it/s, est. speed input: 321.36 toks/s, output: 4695.89 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  2.54it/s, est. speed input: 321.36 toks/s, output: 4695.89 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:30:31 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:28:46 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:28:46 [gpu_worker.py:117] Sleep mode freed 62.46 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:28:46 [executor_base.py:189] It took 0.465968 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:28:47 [executor_base.py:205] It took 0.353268 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:30:31 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:30:31 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:30:45 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.241, å¹³å‡æƒé‡=0.759
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:30:31 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:30:31 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:30:31 [gpu_worker.py:117] Sleep mode freed 62.40 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:30:31 [executor_base.py:189] It took 0.477121 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:31:03 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:31:03 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:31:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:31:04 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:31:04 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:31:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 25x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:31:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 13/128 å®Œæˆ (26/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:31:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 23/128 å®Œæˆ (46/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:31:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:31:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 39/128 å®Œæˆ (78/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:31:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:31:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:31:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:31:51 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:31:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 79/128 å®Œæˆ (158/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:32:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 88/128 å®Œæˆ (176/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:32:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 98/128 å®Œæˆ (196/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:32:13 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 108/128 å®Œæˆ (216/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:32:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 114/128 å®Œæˆ (228/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:32:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 121/128 å®Œæˆ (242/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:32:46 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:32:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:32:50 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:32:52 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:32:54 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:33:04 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 138.2s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:33:04 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:33:31 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:07 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4608)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4298)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3777)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3555)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3412)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3456)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:34:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3666)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:43 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3927)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3999)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3569)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3417)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3260)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3371)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:34:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3499)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:35 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4835)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4599)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3983)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3641)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3454)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3576)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:35:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3750)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:30 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4105)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4025)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3495)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3398)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3243)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3351)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3495)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:36:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3571)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:36:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3655)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:36:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3550)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:36:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 13/64 å®Œæˆ (52/256 æ¡æ ·æœ¬, loss=0.3528)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:37:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3395)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:37:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3458)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:37:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.3526)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:37:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 26/64 å®Œæˆ (104/256 æ¡æ ·æœ¬, loss=0.3573)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:37:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3485)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:37:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3456)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:37:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3491)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:37:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3525)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:38:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3473)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:38:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 45/64 å®Œæˆ (180/256 æ¡æ ·æœ¬, loss=0.3558)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:38:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.3549)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:38:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3639)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:38:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 54/64 å®Œæˆ (216/256 æ¡æ ·æœ¬, loss=0.3666)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:38:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3609)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:38:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3588)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:38:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3696)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:38:48 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.76e-06, è€—æ—¶ 281.6s
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:38:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3604)[32m [repeated 11x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:38:57 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:38:48 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.76e-06, è€—æ—¶ 245.2s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:38:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3664)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:38:58 [executor_base.py:205] It took 0.327541 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:38:58 [executor_base.py:205] It took 0.364494 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:38:58 [executor_base.py:205] It took 0.358491 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 480x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:39:26 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:39:27 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:39:27 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:39:27 [executor_base.py:189] It took 0.480222 seconds to fall asleep.
[36m(VtDStudentActor pid=843942)[0m Deleted oldest ckpt /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints/_actor/global_step12
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:39:27 vtd_trainer_ray.py:1123] æ­¥éª¤ 21: {'vtd_loss': 0.36037450144067407, 'distill_loss': 0.36037450144067407, 'avg_se_weight': 0.759465625, 'actor_lr': 2.755256939977621e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.240534375, 'step_time': 639.787202835083, 'phase1_generate_time': 104.30770230293274, 'phase2_collect_time': 138.22630214691162, 'phase3_train_time': 353.81285858154297} [é‡‡æ ·=104.3s æ”¶é›†=138.2s è®­ç»ƒ=353.8s æ€»è®¡=639.8s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:40:21 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 21, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:40:21 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:39:26 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:39:27 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:39:27 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:39:27 [executor_base.py:189] It took 0.486941 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:40:21 [executor_base.py:205] It took 0.329738 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:42<19:40,  4.92s/it, est. speed input: 18.00 toks/s, output: 242.69 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  4.92s/it, est. speed input: 349.20 toks/s, output: 4798.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.49it/s, est. speed input: 349.20 toks/s, output: 4798.43 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:40:21 [executor_base.py:205] It took 0.328544 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 63.77it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 157/165 [00:03<00:00, 73.05it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:03<00:00, 72.30it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.69it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:10<27:43, 10.14s/it, est. speed input: 45.56 toks/s, output: 29.49 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 148/165 [00:03<00:00, 68.68it/s][32m [repeated 73x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.16it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:03<00:00, 77.22it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.53it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:10<28:07, 10.29s/it, est. speed input: 45.57 toks/s, output: 29.34 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 8/165 [00:15<02:10,  1.20it/s, est. speed input: 238.80 toks/s, output: 202.30 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  14%|â–ˆâ–        | 23/165 [00:20<01:11,  1.97it/s, est. speed input: 518.81 toks/s, output: 511.69 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 35/165 [00:25<01:08,  1.89it/s, est. speed input: 624.90 toks/s, output: 667.34 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:31<00:24,  4.11it/s, est. speed input: 981.75 toks/s, output: 1306.64 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 75/165 [00:36<00:32,  2.74it/s, est. speed input: 975.17 toks/s, output: 1390.02 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 76/165 [00:41<01:19,  1.11it/s, est. speed input: 866.72 toks/s, output: 1293.71 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:46<00:27,  2.23it/s, est. speed input: 1066.38 toks/s, output: 1909.46 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 100/165 [00:51<00:29,  2.18it/s, est. speed input: 916.47 toks/s, output: 1620.29 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 107/165 [00:56<00:37,  1.57it/s, est. speed input: 893.09 toks/s, output: 1664.64 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 125/165 [01:01<01:05,  1.64s/it, est. speed input: 966.37 toks/s, output: 1871.15 toks/s] [32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [01:03<00:00, 10.98it/s, est. speed input: 1206.43 toks/s, output: 3054.46 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00, 10.98it/s, est. speed input: 1237.45 toks/s, output: 3183.15 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00,  2.59it/s, est. speed input: 1237.45 toks/s, output: 3183.15 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [01:04<00:01, 10.47it/s, est. speed input: 1098.49 toks/s, output: 2494.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 10.47it/s, est. speed input: 1235.85 toks/s, output: 3063.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.56it/s, est. speed input: 1235.85 toks/s, output: 3063.23 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  8.55it/s, est. speed input: 1233.06 toks/s, output: 3216.13 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.55it/s, est. speed input: 1233.06 toks/s, output: 3216.13 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:41:31 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:40:21 [executor_base.py:205] It took 0.330099 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:41:31 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:41:31 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:41:31 [gpu_worker.py:117] Sleep mode freed 61.95 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:41:31 [executor_base.py:189] It took 0.451744 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:41:31 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 548/660 = 83.0%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:41:31 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 120/165 [01:05<00:20,  2.19it/s, est. speed input: 872.46 toks/s, output: 1810.82 toks/s][32m [repeated 15x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:41:33 [executor_base.py:205] It took 2.037664 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:03, 46.12it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.19it/s, est. speed input: 1211.45 toks/s, output: 3211.96 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.51it/s, est. speed input: 1211.45 toks/s, output: 3211.96 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:01<00:00, 80.23it/s]
Adding requests:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [00:01<00:00, 90.32it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 83.03it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:01<00:00, 88.72it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 82.86it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:09<27:00,  9.88s/it, est. speed input: 46.14 toks/s, output: 29.44 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [00:01<00:00, 89.77it/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.34it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/164 [00:01<00:00, 84.01it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 86.09it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:12<32:37, 12.01s/it, est. speed input: 39.71 toks/s, output: 26.22 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:17<07:14,  2.71s/it, est. speed input: 128.24 toks/s, output: 114.28 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  14%|â–ˆâ–        | 23/165 [00:22<00:26,  5.29it/s, est. speed input: 469.85 toks/s, output: 531.10 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–Œ       | 42/165 [00:27<00:18,  6.59it/s, est. speed input: 706.79 toks/s, output: 908.30 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 55/165 [00:32<01:18,  1.40it/s, est. speed input: 787.19 toks/s, output: 1086.79 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 74/164 [00:39<01:04,  1.39it/s, est. speed input: 890.30 toks/s, output: 1366.17 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 88/164 [00:44<00:25,  3.00it/s, est. speed input: 943.66 toks/s, output: 1573.82 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 96/165 [00:49<00:37,  1.84it/s, est. speed input: 925.63 toks/s, output: 1631.90 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:54<00:24,  2.50it/s, est. speed input: 901.59 toks/s, output: 1767.45 toks/s][32m [repeated 36x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [01:00<00:55,  1.08s/it, est. speed input: 898.85 toks/s, output: 1735.29 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 10.88it/s, est. speed input: 1222.82 toks/s, output: 3253.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.53it/s, est. speed input: 1222.82 toks/s, output: 3253.77 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/164 [01:05<00:10,  3.45it/s, est. speed input: 930.31 toks/s, output: 2032.04 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 150/164 [01:06<00:01, 12.04it/s, est. speed input: 1078.63 toks/s, output: 2690.12 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 158/164 [01:06<00:00, 19.28it/s, est. speed input: 1136.99 toks/s, output: 2928.07 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00, 19.28it/s, est. speed input: 1180.82 toks/s, output: 3110.07 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00,  2.45it/s, est. speed input: 1180.82 toks/s, output: 3110.07 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [01:07<00:21,  2.02it/s, est. speed input: 859.18 toks/s, output: 1907.13 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.02it/s, est. speed input: 1171.92 toks/s, output: 3198.77 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.42it/s, est. speed input: 1171.92 toks/s, output: 3198.77 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:41:33 [executor_base.py:205] It took 2.023855 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:42:43 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:41:31 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:41:31 [gpu_worker.py:117] Sleep mode freed 61.94 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:41:31 [executor_base.py:189] It took 0.438906 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:42:44 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1118/1319 = 84.8%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:42:44 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 21 å®Œæˆ: å‡†ç¡®çŽ‡ 84.8% (1118/1319), è€—æ—¶ 143.5s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:42:44 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_21.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:42:44 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  24%|â–ˆâ–ˆâ–Ž       | 21/89 [4:35:23<15:11:23, 804.17s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:42:45 [executor_base.py:205] It took 0.369934 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  28%|â–ˆâ–ˆâ–Š       | 18/64 [00:00<00:00, 119.45it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:00<00:00, 149.15it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 157.87it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:00<00:00, 146.59it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 157.18it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 11.76it/s, est. speed input: 1185.51 toks/s, output: 3107.59 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1185.51 toks/s, output: 3107.59 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:39<41:31,  9.89s/it, est. speed input: 9.51 toks/s, output: 65.78 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:00<00:00, 147.90it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:00<00:00, 145.57it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 157.59it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:46<48:43, 11.60s/it, est. speed input: 8.28 toks/s, output: 59.68 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [01:04<1:08:07, 16.22s/it, est. speed input: 5.61 toks/s, output: 68.81 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:11<34:45,  8.41s/it, est. speed input: 10.07 toks/s, output: 81.36 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:22<38:27,  9.31s/it, est. speed input: 10.01 toks/s, output: 124.21 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:27<12:37,  3.21s/it, est. speed input: 20.64 toks/s, output: 231.35 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:35<09:35,  2.48s/it, est. speed input: 24.59 toks/s, output: 278.33 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:42<06:30,  1.75s/it, est. speed input: 29.85 toks/s, output: 393.01 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 132/256 [01:42<00:20,  5.97it/s, est. speed input: 161.31 toks/s, output: 2323.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  5.97it/s, est. speed input: 331.47 toks/s, output: 4738.79 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.50it/s, est. speed input: 331.47 toks/s, output: 4738.79 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  1.40s/it, est. speed input: 336.44 toks/s, output: 4614.61 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 336.44 toks/s, output: 4614.61 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:42:45 [executor_base.py:205] It took 0.351971 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:44:29 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:42:44 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:42:44 [gpu_worker.py:117] Sleep mode freed 62.23 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:42:44 [executor_base.py:189] It took 0.470657 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:44:30 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:44:30 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:44:44 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.273, å¹³å‡æƒé‡=0.727
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:44:30 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:44:30 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:44:30 [gpu_worker.py:117] Sleep mode freed 62.45 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 01:44:30 [executor_base.py:189] It took 0.501161 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:45:03 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:45:03 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:45:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:45:04 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:45:04 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:45:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:45:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:45:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:45:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:45:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 39/128 å®Œæˆ (78/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:45:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 47/128 å®Œæˆ (94/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:45:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:45:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:45:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 70/128 å®Œæˆ (140/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:45:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 78/128 å®Œæˆ (156/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:46:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 88/128 å®Œæˆ (176/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:46:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:46:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 103/128 å®Œæˆ (206/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:46:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 111/128 å®Œæˆ (222/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:46:23 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 121/128 å®Œæˆ (242/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:46:46 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:46:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:46:48 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:46:52 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:46:54 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:47:01 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 136.8s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:47:01 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:47:29 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:07 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3071)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3800)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3707)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3762)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3344)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3401)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:48:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3568)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:42 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3018)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3776)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3913)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3920)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3442)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3433)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:48:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3648)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:33 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2994)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3742)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3675)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3774)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3324)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3405)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:49:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3584)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:26 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3342)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3924)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3770)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3713)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3292)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3327)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:50:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3496)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:50:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3461)[32m [repeated 4x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:50:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3385)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:50:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3104)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:51:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3116)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:51:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3229)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:51:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3238)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:51:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3216)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:51:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3371)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:51:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3414)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:51:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3410)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:51:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3398)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:51:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3356)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:51:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3398)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:52:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3364)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 01:52:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3445)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:52:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 50/64 å®Œæˆ (200/256 æ¡æ ·æœ¬, loss=0.3467)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:52:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3426)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:52:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3360)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:52:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3376)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 01:52:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3386)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 01:52:46 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.73e-06, è€—æ—¶ 243.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:52:57 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:52:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3454)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 01:52:46 vtd_actor.py:330] [è®­ç»ƒ rank=2] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.73e-06, è€—æ—¶ 193.4s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:52:57 [executor_base.py:205] It took 0.365401 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:52:57 [executor_base.py:205] It took 0.350294 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:52:57 [executor_base.py:205] It took 0.353929 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 481x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:53:25 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:53:26 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:53:26 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:53:26 [executor_base.py:189] It took 0.453656 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:53:26 vtd_trainer_ray.py:1123] æ­¥éª¤ 22: {'vtd_loss': 0.340692225843668, 'distill_loss': 0.340692225843668, 'avg_se_weight': 0.72705078125, 'actor_lr': 2.7257690630062354e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.27294921875, 'step_time': 641.6569430828094, 'phase1_generate_time': 105.79274725914001, 'phase2_collect_time': 136.76135802268982, 'phase3_train_time': 355.5085291862488} [é‡‡æ ·=105.8s æ”¶é›†=136.8s è®­ç»ƒ=355.5s æ€»è®¡=641.7s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:53:26 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 22, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:53:26 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:53:26 [executor_base.py:205] It took 0.340584 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:53:26 [executor_base.py:205] It took 0.343292 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842167)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:44<20:38,  5.16s/it, est. speed input: 17.64 toks/s, output: 236.02 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  31%|â–ˆâ–ˆâ–ˆâ–      | 80/256 [01:43<02:00,  1.46it/s, est. speed input: 102.35 toks/s, output: 1419.83 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  1.46it/s, est. speed input: 344.18 toks/s, output: 4785.88 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 344.18 toks/s, output: 4785.88 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  5.16s/it, est. speed input: 352.54 toks/s, output: 4834.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.45it/s, est. speed input: 352.54 toks/s, output: 4834.63 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   7%|â–‹         | 11/165 [00:00<00:01, 77.61it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:02<00:00, 42.17it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:02<00:00, 27.24it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:02<00:00, 56.82it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:10<28:14, 10.33s/it, est. speed input: 44.72 toks/s, output: 27.49 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:02<00:00, 37.11it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 51.74it/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:10<29:51, 10.92s/it, est. speed input: 42.93 toks/s, output: 27.10 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   4%|â–Ž         | 6/165 [00:15<04:38,  1.75s/it, est. speed input: 175.91 toks/s, output: 132.30 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  12%|â–ˆâ–        | 19/165 [00:21<01:34,  1.55it/s, est. speed input: 419.19 toks/s, output: 422.65 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  28%|â–ˆâ–ˆâ–Š       | 46/165 [00:26<00:17,  6.67it/s, est. speed input: 816.13 toks/s, output: 999.23 toks/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 66/165 [00:31<00:13,  7.21it/s, est. speed input: 985.41 toks/s, output: 1342.06 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 78/165 [00:36<00:31,  2.80it/s, est. speed input: 1007.27 toks/s, output: 1463.72 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 80/165 [00:41<00:47,  1.80it/s, est. speed input: 910.76 toks/s, output: 1441.24 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 95/165 [00:46<00:34,  2.01it/s, est. speed input: 970.08 toks/s, output: 1628.09 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 95/165 [00:51<00:22,  3.06it/s, est. speed input: 868.98 toks/s, output: 1539.06 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 115/165 [00:56<00:43,  1.14it/s, est. speed input: 956.94 toks/s, output: 1774.79 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 116/165 [01:02<00:50,  1.04s/it, est. speed input: 880.87 toks/s, output: 1805.58 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [01:04<00:00, 14.27it/s, est. speed input: 1147.35 toks/s, output: 2823.85 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 14.27it/s, est. speed input: 1214.64 toks/s, output: 3107.69 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.54it/s, est. speed input: 1214.64 toks/s, output: 3107.69 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  6.98it/s, est. speed input: 1221.91 toks/s, output: 3149.45 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.53it/s, est. speed input: 1221.91 toks/s, output: 3149.45 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [01:06<00:00, 17.65it/s, est. speed input: 1079.06 toks/s, output: 2747.36 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 17.65it/s, est. speed input: 1195.94 toks/s, output: 3238.75 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.48it/s, est. speed input: 1195.94 toks/s, output: 3238.75 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:54:36 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:53:26 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:53:26 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:53:26 [executor_base.py:189] It took 0.475642 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:53:26 [executor_base.py:205] It took 0.325128 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:54:37 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 546/660 = 82.7%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:54:37 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:54:37 [executor_base.py:205] It took 0.340740 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 67.51it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:06<00:48,  1.05s/it, est. speed input: 855.75 toks/s, output: 1798.36 toks/s][32m [repeated 15x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  1.05s/it, est. speed input: 1195.95 toks/s, output: 3212.90 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.48it/s, est. speed input: 1195.95 toks/s, output: 3212.90 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:03<00:00, 81.78it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:03<00:00, 80.83it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.75it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 142/164 [00:03<00:00, 73.48it/s][32m [repeated 72x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:10<27:51, 10.19s/it, est. speed input: 46.32 toks/s, output: 30.23 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 152/164 [00:03<00:00, 76.72it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 82.36it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 43.32it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:10<28:40, 10.56s/it, est. speed input: 45.18 toks/s, output: 30.88 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   4%|â–Ž         | 6/165 [00:15<03:13,  1.22s/it, est. speed input: 175.83 toks/s, output: 150.49 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  10%|â–‰         | 16/165 [00:20<00:42,  3.53it/s, est. speed input: 355.65 toks/s, output: 370.54 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  23%|â–ˆâ–ˆâ–Ž       | 38/165 [00:26<01:14,  1.69it/s, est. speed input: 671.95 toks/s, output: 787.90 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–       | 41/165 [00:32<00:48,  2.57it/s, est. speed input: 597.97 toks/s, output: 802.69 toks/s][32m [repeated 60x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 61/165 [00:37<00:19,  5.43it/s, est. speed input: 772.28 toks/s, output: 1184.91 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 88/165 [00:42<00:25,  3.08it/s, est. speed input: 986.66 toks/s, output: 1599.84 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 92/165 [00:47<01:22,  1.13s/it, est. speed input: 921.72 toks/s, output: 1535.47 toks/s][32m [repeated 30x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 100/165 [00:52<00:23,  2.81it/s, est. speed input: 907.85 toks/s, output: 1746.64 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:57<00:58,  1.04it/s, est. speed input: 861.18 toks/s, output: 1699.84 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [01:02<00:47,  1.07it/s, est. speed input: 868.18 toks/s, output: 1741.92 toks/s][32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:05<00:00, 19.90it/s, est. speed input: 1113.85 toks/s, output: 2817.85 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 19.90it/s, est. speed input: 1211.40 toks/s, output: 3221.52 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.51it/s, est. speed input: 1211.40 toks/s, output: 3221.52 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 12.47it/s, est. speed input: 1213.41 toks/s, output: 3237.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.50it/s, est. speed input: 1213.41 toks/s, output: 3237.31 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 121/165 [01:08<00:32,  1.36it/s, est. speed input: 849.05 toks/s, output: 1887.78 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:55:49 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:54:36 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:54:36 [gpu_worker.py:117] Sleep mode freed 62.53 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:54:36 [executor_base.py:189] It took 0.470250 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:54:37 [executor_base.py:205] It took 0.350375 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:55:50 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1101/1319 = 83.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:55:50 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 22 å®Œæˆ: å‡†ç¡®çŽ‡ 83.5% (1101/1319), è€—æ—¶ 144.2s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:55:50 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_22.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:55:50 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  25%|â–ˆâ–ˆâ–       | 22/89 [4:48:29<14:51:52, 798.69s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:55:51 [executor_base.py:205] It took 0.342735 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  28%|â–ˆâ–ˆâ–Š       | 18/64 [00:00<00:00, 131.58it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:00<00:00, 144.19it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 149.66it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 182.45it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  1.50it/s, est. speed input: 1162.38 toks/s, output: 3186.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:08<00:00,  2.40it/s, est. speed input: 1162.38 toks/s, output: 3186.63 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [01:01<1:04:36, 15.38s/it, est. speed input: 4.16 toks/s, output: 76.49 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:00<00:00, 160.20it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [00:00<00:00, 158.95it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 164.51it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [01:07<1:10:57, 16.89s/it, est. speed input: 3.79 toks/s, output: 61.92 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [01:10<1:13:48, 17.57s/it, est. speed input: 4.04 toks/s, output: 70.93 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:10<30:04,  7.28s/it, est. speed input: 9.07 toks/s, output: 136.49 toks/s] 
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:23<38:38,  9.35s/it, est. speed input: 8.49 toks/s, output: 112.32 toks/s] [32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:31<1:35:58, 22.85s/it, est. speed input: 4.86 toks/s, output: 62.40 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:38<18:38,  4.66s/it, est. speed input: 13.05 toks/s, output: 203.88 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:43<13:35,  3.45s/it, est. speed input: 15.68 toks/s, output: 260.51 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00, 12.29it/s, est. speed input: 346.02 toks/s, output: 4781.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00, 12.29it/s, est. speed input: 346.02 toks/s, output: 4781.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 346.02 toks/s, output: 4781.55 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 156/256 [01:43<00:25,  3.97it/s, est. speed input: 189.99 toks/s, output: 2897.83 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  3.97it/s, est. speed input: 323.80 toks/s, output: 4833.91 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.46it/s, est. speed input: 323.80 toks/s, output: 4833.91 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 01:57:36 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:55:50 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:55:50 [gpu_worker.py:117] Sleep mode freed 62.25 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:55:50 [executor_base.py:189] It took 0.489402 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:55:51 [executor_base.py:205] It took 0.351252 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  5.20s/it, est. speed input: 322.96 toks/s, output: 4809.47 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.44it/s, est. speed input: 322.96 toks/s, output: 4809.47 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:57:36 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:57:36 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:57:51 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.253, å¹³å‡æƒé‡=0.747
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:57:36 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 01:57:36 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:57:36 [gpu_worker.py:117] Sleep mode freed 62.30 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 01:57:36 [executor_base.py:189] It took 0.529706 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:58:09 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:58:10 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:58:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:58:10 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:58:10 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:58:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:58:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:58:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:58:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 30/128 å®Œæˆ (60/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:58:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 38/128 å®Œæˆ (76/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:58:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 45/128 å®Œæˆ (90/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:58:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:58:51 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 62/128 å®Œæˆ (124/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:58:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 70/128 å®Œæˆ (140/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:59:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 78/128 å®Œæˆ (156/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:59:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 87/128 å®Œæˆ (174/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:59:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 94/128 å®Œæˆ (188/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 01:59:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 101/128 å®Œæˆ (202/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 01:59:23 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 109/128 å®Œæˆ (218/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 01:59:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 119/128 å®Œæˆ (238/256 æ¡åºåˆ—)[32m [repeated 41x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:59:53 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 01:59:34 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:59:55 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 01:59:59 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:00:01 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:00:08 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 137.6s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:00:08 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:00:36 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:13 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3283)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3417)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3192)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3414)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3429)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3367)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:01:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3287)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:01:53 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:01:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3049)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:01:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3348)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:01:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3437)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:02:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3577)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:02:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3596)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:02:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3531)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:02:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3367)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:44 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3445)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3687)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3494)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3751)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3740)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3687)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:02:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3534)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:37 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2873)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3295)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3156)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3438)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3486)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3470)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3285)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:03:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3427)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3385)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:03:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 10/64 å®Œæˆ (40/256 æ¡æ ·æœ¬, loss=0.3490)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 13/64 å®Œæˆ (52/256 æ¡æ ·æœ¬, loss=0.3367)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.3321)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:04:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3400)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3392)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3461)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 26/64 å®Œæˆ (104/256 æ¡æ ·æœ¬, loss=0.3472)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3551)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3637)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:04:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3756)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:04:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 38/64 å®Œæˆ (152/256 æ¡æ ·æœ¬, loss=0.3695)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:05:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3740)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:05:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 45/64 å®Œæˆ (180/256 æ¡æ ·æœ¬, loss=0.3664)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:05:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 48/64 å®Œæˆ (192/256 æ¡æ ·æœ¬, loss=0.3618)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:05:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 51/64 å®Œæˆ (204/256 æ¡æ ·æœ¬, loss=0.3628)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:05:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 54/64 å®Œæˆ (216/256 æ¡æ ·æœ¬, loss=0.3640)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:05:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3580)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:05:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3538)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:05:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3594)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:05:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 63/64 å®Œæˆ (252/256 æ¡æ ·æœ¬, loss=0.3572)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:05:56 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.69e-06, è€—æ—¶ 282.7s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:06:05 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:05:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3584)[32m [repeated 4x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:05:56 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.69e-06, è€—æ—¶ 242.8s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:06:05 [executor_base.py:205] It took 0.331157 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:06:05 [executor_base.py:205] It took 0.349516 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:06:05 [executor_base.py:205] It took 0.337526 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 480x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:06:34 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:06:35 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:06:35 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:06:35 [executor_base.py:189] It took 1.129270 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:06:35 vtd_trainer_ray.py:1123] æ­¥éª¤ 23: {'vtd_loss': 0.35790032567456365, 'distill_loss': 0.35790032567456365, 'avg_se_weight': 0.7472703125, 'actor_lr': 2.6948031342467294e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.2527296875, 'step_time': 644.7543144226074, 'phase1_generate_time': 106.10491800308228, 'phase2_collect_time': 137.6228380203247, 'phase3_train_time': 356.9370365142822} [é‡‡æ ·=106.1s æ”¶é›†=137.6s è®­ç»ƒ=356.9s æ€»è®¡=644.8s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:06:35 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 23, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:06:35 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:06:36 [executor_base.py:205] It took 1.001810 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:44<20:49,  5.20s/it, est. speed input: 15.55 toks/s, output: 200.22 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 216/256 [01:44<00:06,  5.89it/s, est. speed input: 285.25 toks/s, output: 4075.54 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  5.89it/s, est. speed input: 333.20 toks/s, output: 4829.60 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 333.20 toks/s, output: 4829.60 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:06:36 [executor_base.py:205] It took 0.872351 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 64.54it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  27%|â–ˆâ–ˆâ–‹       | 44/165 [00:00<00:01, 76.05it/s]
Adding requests:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 58/165 [00:00<00:01, 93.38it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:01<00:00, 82.55it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:01<00:00, 88.08it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.86it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:08<22:54,  8.38s/it, est. speed input: 53.23 toks/s, output: 30.07 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 150/165 [00:01<00:00, 84.38it/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.36it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:09<25:59,  9.51s/it, est. speed input: 49.54 toks/s, output: 30.92 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:14<05:00,  1.88s/it, est. speed input: 158.42 toks/s, output: 120.91 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  13%|â–ˆâ–Ž        | 22/165 [00:19<00:30,  4.66it/s, est. speed input: 515.88 toks/s, output: 508.79 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 35/165 [00:24<01:22,  1.58it/s, est. speed input: 652.06 toks/s, output: 709.65 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 44/165 [00:30<00:46,  2.61it/s, est. speed input: 691.64 toks/s, output: 880.48 toks/s][32m [repeated 60x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:35<00:17,  5.86it/s, est. speed input: 877.91 toks/s, output: 1287.17 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 85/165 [00:40<00:22,  3.52it/s, est. speed input: 1004.29 toks/s, output: 1630.06 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 98/165 [00:45<00:35,  1.88it/s, est. speed input: 1021.68 toks/s, output: 1694.96 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [00:50<00:22,  2.52it/s, est. speed input: 1021.44 toks/s, output: 1833.74 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [00:55<00:44,  1.15it/s, est. speed input: 965.73 toks/s, output: 1799.95 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [01:00<00:37,  1.15it/s, est. speed input: 951.51 toks/s, output: 1882.57 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  6.58it/s, est. speed input: 1227.92 toks/s, output: 3152.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.57it/s, est. speed input: 1227.92 toks/s, output: 3152.05 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [01:04<00:00, 17.93it/s, est. speed input: 1141.56 toks/s, output: 2864.17 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 17.93it/s, est. speed input: 1224.77 toks/s, output: 3209.95 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.54it/s, est. speed input: 1224.77 toks/s, output: 3209.95 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 123/165 [01:07<00:53,  1.27s/it, est. speed input: 874.01 toks/s, output: 1779.71 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  1.27s/it, est. speed input: 1184.62 toks/s, output: 3059.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.46it/s, est. speed input: 1184.62 toks/s, output: 3059.23 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [01:05<00:42,  1.02it/s, est. speed input: 892.98 toks/s, output: 1801.49 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:07:45 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:06:35 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:06:35 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:06:35 [executor_base.py:189] It took 1.111342 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:06:36 [executor_base.py:205] It took 0.857945 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:07:46 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 555/660 = 84.1%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:07:46 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:07:46 [executor_base.py:205] It took 0.335274 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 62.40it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 13.69it/s, est. speed input: 1238.13 toks/s, output: 3165.65 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.56it/s, est. speed input: 1238.13 toks/s, output: 3165.65 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [00:01<00:00, 93.56it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:01<00:00, 90.58it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.37it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:11<32:08, 11.83s/it, est. speed input: 40.31 toks/s, output: 26.28 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/164 [00:01<00:00, 88.64it/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 84.70it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 163/165 [00:01<00:00, 87.69it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.84it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:56, 12.42s/it, est. speed input: 36.64 toks/s, output: 26.25 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 5/164 [00:17<06:28,  2.44s/it, est. speed input: 130.65 toks/s, output: 110.80 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  10%|â–‰         | 16/165 [00:22<00:53,  2.79it/s, est. speed input: 322.72 toks/s, output: 362.34 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 34/165 [00:27<00:27,  4.85it/s, est. speed input: 569.90 toks/s, output: 723.04 toks/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:33<00:27,  3.60it/s, est. speed input: 928.21 toks/s, output: 1251.40 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 80/165 [00:38<00:39,  2.13it/s, est. speed input: 997.07 toks/s, output: 1469.65 toks/s] [32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 89/165 [00:43<00:19,  3.85it/s, est. speed input: 977.03 toks/s, output: 1602.09 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 101/164 [00:48<00:24,  2.53it/s, est. speed input: 994.88 toks/s, output: 1742.87 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 111/165 [00:53<00:44,  1.21it/s, est. speed input: 993.79 toks/s, output: 1762.19 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 120/165 [00:58<00:30,  1.48it/s, est. speed input: 980.35 toks/s, output: 1867.19 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 130/165 [01:03<00:20,  1.70it/s, est. speed input: 980.64 toks/s, output: 2018.09 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [01:03<00:00, 26.61it/s, est. speed input: 1226.93 toks/s, output: 3035.29 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00, 26.61it/s, est. speed input: 1250.77 toks/s, output: 3131.05 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:03<00:00,  2.58it/s, est. speed input: 1250.77 toks/s, output: 3131.05 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 140/164 [01:06<00:03,  6.62it/s, est. speed input: 1013.12 toks/s, output: 2366.41 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00,  6.62it/s, est. speed input: 1193.57 toks/s, output: 3106.11 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00,  2.48it/s, est. speed input: 1193.57 toks/s, output: 3106.11 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:08:56 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:07:46 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:07:46 [gpu_worker.py:117] Sleep mode freed 62.11 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:07:46 [executor_base.py:189] It took 0.477007 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:07:46 [executor_base.py:205] It took 0.348748 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:08:56 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1119/1319 = 84.8%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:08:56 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 23 å®Œæˆ: å‡†ç¡®çŽ‡ 84.8% (1119/1319), è€—æ—¶ 141.2s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:08:56 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_23.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:08:56 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  26%|â–ˆâ–ˆâ–Œ       | 23/89 [5:01:36<14:34:26, 794.95s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:08:57 [executor_base.py:205] It took 0.322510 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  30%|â–ˆâ–ˆâ–‰       | 19/64 [00:00<00:00, 153.17it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 123/165 [01:07<00:40,  1.03it/s, est. speed input: 874.74 toks/s, output: 1896.93 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:00<00:00, 146.12it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 163.35it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:00<00:00, 152.47it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 154.89it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [01:07<00:00, 12.72it/s, est. speed input: 1121.13 toks/s, output: 2899.76 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 12.72it/s, est. speed input: 1186.90 toks/s, output: 3173.84 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.46it/s, est. speed input: 1186.90 toks/s, output: 3173.84 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 147/165 [01:06<00:03,  5.82it/s, est. speed input: 1059.99 toks/s, output: 2542.79 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  5.82it/s, est. speed input: 1192.67 toks/s, output: 3093.88 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.47it/s, est. speed input: 1192.67 toks/s, output: 3093.88 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [00:00<00:00, 156.12it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:49<51:59, 12.38s/it, est. speed input: 8.40 toks/s, output: 79.75 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:00<00:00, 159.37it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 170.62it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:50<53:18, 12.69s/it, est. speed input: 5.75 toks/s, output: 45.80 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:52<22:24,  5.42s/it, est. speed input: 14.21 toks/s, output: 107.23 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:56<24:15,  5.87s/it, est. speed input: 13.94 toks/s, output: 132.37 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:06<30:12,  7.31s/it, est. speed input: 11.57 toks/s, output: 124.30 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   5%|â–         | 12/256 [01:09<20:08,  4.95s/it, est. speed input: 16.07 toks/s, output: 152.03 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:15<12:55,  3.23s/it, est. speed input: 18.09 toks/s, output: 229.99 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   5%|â–         | 12/256 [01:23<26:04,  6.41s/it, est. speed input: 15.22 toks/s, output: 159.84 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:28<27:47,  6.83s/it, est. speed input: 12.43 toks/s, output: 152.91 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:34<07:46,  2.04s/it, est. speed input: 25.65 toks/s, output: 352.26 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:40<15:28,  3.94s/it, est. speed input: 22.94 toks/s, output: 243.32 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  8.42it/s, est. speed input: 318.36 toks/s, output: 4729.32 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.50it/s, est. speed input: 318.36 toks/s, output: 4729.32 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 132/256 [01:43<00:24,  4.98it/s, est. speed input: 163.01 toks/s, output: 2330.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  4.98it/s, est. speed input: 323.28 toks/s, output: 4676.83 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 323.28 toks/s, output: 4676.83 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:10:41 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:08:56 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:08:56 [gpu_worker.py:117] Sleep mode freed 62.26 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:08:56 [executor_base.py:189] It took 0.479813 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:08:57 [executor_base.py:205] It took 0.341832 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:10:42 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:10:42 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:10:56 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.261, å¹³å‡æƒé‡=0.739
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:10:41 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:10:42 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:10:42 [gpu_worker.py:117] Sleep mode freed 62.41 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:10:42 [executor_base.py:189] It took 0.500139 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:11:14 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:11:14 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:11:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:11:15 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:11:15 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:11:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 6/128 å®Œæˆ (12/256 æ¡åºåˆ—)[32m [repeated 25x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:11:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 17/128 å®Œæˆ (34/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:11:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:11:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:11:40 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 40/128 å®Œæˆ (80/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:11:47 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 48/128 å®Œæˆ (96/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 02:11:52 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 58/128 å®Œæˆ (116/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:11:57 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:12:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:12:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 80/128 å®Œæˆ (160/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:12:13 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 90/128 å®Œæˆ (180/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:12:18 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 98/128 å®Œæˆ (196/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:12:23 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 106/128 å®Œæˆ (212/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:12:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 112/128 å®Œæˆ (224/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:12:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 122/128 å®Œæˆ (244/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:12:57 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:12:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 24x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:12:59 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:13:03 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:13:04 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:13:12 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 135.9s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:13:12 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:13:40 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:15 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:18 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3681)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2982)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3080)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3100)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3532)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3223)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:14:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3223)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:14:55 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:14:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3570)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:14:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2865)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:15:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3012)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:15:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3098)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:15:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3441)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:15:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3083)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:15:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3144)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:43 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3767)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3000)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3140)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3193)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3514)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3200)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:15:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3173)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:33 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3496)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2974)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3052)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3110)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3452)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3103)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3019)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:16:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3267)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3077)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:16:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3261)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:17:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3315)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:17:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.3275)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:17:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3205)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:17:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.3296)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:17:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3251)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:17:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3335)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:17:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 31/64 å®Œæˆ (124/256 æ¡æ ·æœ¬, loss=0.3322)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:17:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3305)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:17:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3286)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:17:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3265)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:18:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3282)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:18:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3259)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:18:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3272)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:18:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3355)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:18:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3364)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:18:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3411)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:18:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3426)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:18:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3411)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:18:53 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.66e-06, è€—æ—¶ 278.3s
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:18:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3405)[32m [repeated 10x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:19:02 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:18:53 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.66e-06, è€—æ—¶ 238.9s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:18:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3399)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:19:03 [executor_base.py:205] It took 0.368040 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:19:03 [executor_base.py:205] It took 0.367850 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:19:03 [executor_base.py:205] It took 0.347199 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:19:32 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:19:32 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:19:32 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:19:32 [executor_base.py:189] It took 0.482128 seconds to fall asleep.
[36m(VtDStudentActor pid=843942)[0m Deleted oldest ckpt /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints/_actor/global_step15
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:19:32 vtd_trainer_ray.py:1123] æ­¥éª¤ 24: {'vtd_loss': 0.3405477700289339, 'distill_loss': 0.3405477700289339, 'avg_se_weight': 0.738542578125, 'actor_lr': 2.662401699304799e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.261457421875, 'step_time': 635.6541359424591, 'phase1_generate_time': 105.47747850418091, 'phase2_collect_time': 135.88184809684753, 'phase3_train_time': 350.3948771953583} [é‡‡æ ·=105.5s æ”¶é›†=135.9s è®­ç»ƒ=350.4s æ€»è®¡=635.7s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:20:25 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 24, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:20:25 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:19:32 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:19:32 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:19:32 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:19:32 [executor_base.py:189] It took 0.451910 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:20:26 [executor_base.py:205] It took 0.395528 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [01:43<03:42,  1.05s/it, est. speed input: 43.05 toks/s, output: 545.26 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:44<15:53,  4.04s/it, est. speed input: 22.82 toks/s, output: 261.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  4.04s/it, est. speed input: 339.92 toks/s, output: 4841.02 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:44<00:00,  2.46it/s, est. speed input: 339.92 toks/s, output: 4841.02 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:20:26 [executor_base.py:205] It took 0.377661 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–         | 8/165 [00:00<00:02, 57.64it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:01<00:00, 85.93it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:01<00:00, 87.90it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 88.60it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:48, 11.64s/it, est. speed input: 40.48 toks/s, output: 26.04 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 145/165 [00:01<00:00, 79.33it/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:01<00:00, 81.68it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [00:01<00:00, 80.87it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.49it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:11<32:19, 11.83s/it, est. speed input: 37.71 toks/s, output: 26.04 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   4%|â–Ž         | 6/165 [00:16<03:39,  1.38s/it, est. speed input: 165.35 toks/s, output: 137.84 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  16%|â–ˆâ–Œ        | 26/165 [00:22<01:20,  1.73it/s, est. speed input: 540.76 toks/s, output: 522.03 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  25%|â–ˆâ–ˆâ–       | 41/165 [00:27<00:24,  5.11it/s, est. speed input: 698.84 toks/s, output: 789.17 toks/s][32m [repeated 57x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 74/165 [00:32<00:16,  5.43it/s, est. speed input: 1067.29 toks/s, output: 1422.38 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 89/165 [00:37<00:20,  3.63it/s, est. speed input: 1112.61 toks/s, output: 1620.98 toks/s][32m [repeated 40x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 90/165 [00:42<00:30,  2.44it/s, est. speed input: 991.92 toks/s, output: 1551.32 toks/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 99/165 [00:48<00:25,  2.61it/s, est. speed input: 984.28 toks/s, output: 1674.54 toks/s][32m [repeated 32x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [00:53<00:12,  3.95it/s, est. speed input: 1054.29 toks/s, output: 1912.32 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [00:58<00:56,  1.32s/it, est. speed input: 1000.25 toks/s, output: 1879.28 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [01:01<00:02,  4.80it/s, est. speed input: 1172.85 toks/s, output: 2555.39 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:01<00:00,  4.80it/s, est. speed input: 1282.28 toks/s, output: 3019.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:01<00:00,  2.69it/s, est. speed input: 1282.28 toks/s, output: 3019.55 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [01:04<01:03,  1.31s/it, est. speed input: 876.25 toks/s, output: 1713.11 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [01:05<00:00, 12.10it/s, est. speed input: 1200.16 toks/s, output: 2927.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 12.10it/s, est. speed input: 1222.74 toks/s, output: 3021.42 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.53it/s, est. speed input: 1222.74 toks/s, output: 3021.42 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 146/165 [01:05<00:01, 13.27it/s, est. speed input: 1068.15 toks/s, output: 2566.12 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 13.27it/s, est. speed input: 1208.51 toks/s, output: 3154.99 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.50it/s, est. speed input: 1208.51 toks/s, output: 3154.99 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:21:34 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:20:26 [executor_base.py:205] It took 0.367319 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:21:34 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:21:34 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:21:34 [gpu_worker.py:117] Sleep mode freed 61.86 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:21:34 [executor_base.py:189] It took 0.459470 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:21:35 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 553/660 = 83.8%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:21:35 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:21:35 [executor_base.py:205] It took 0.358869 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  1.89it/s, est. speed input: 1199.91 toks/s, output: 3062.83 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1199.91 toks/s, output: 3062.83 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 66.31it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 125/165 [01:06<00:21,  1.89it/s, est. speed input: 903.24 toks/s, output: 1829.10 toks/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:01<00:00, 99.43it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:01<00:00, 91.56it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.88it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 142/164 [00:01<00:00, 80.68it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:11<32:02, 11.72s/it, est. speed input: 38.56 toks/s, output: 25.93 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 84.33it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.99it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.92it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:17, 12.18s/it, est. speed input: 38.02 toks/s, output: 25.54 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:17<05:18,  1.99s/it, est. speed input: 131.99 toks/s, output: 112.78 toks/s][32m [repeated 13x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  14%|â–ˆâ–        | 23/165 [00:22<01:00,  2.35it/s, est. speed input: 483.24 toks/s, output: 495.83 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–Ž       | 39/165 [00:27<00:25,  4.96it/s, est. speed input: 668.21 toks/s, output: 817.42 toks/s][32m [repeated 58x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  35%|â–ˆâ–ˆâ–ˆâ–      | 57/165 [00:32<00:24,  4.33it/s, est. speed input: 829.98 toks/s, output: 1125.87 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 74/165 [00:37<00:45,  2.00it/s, est. speed input: 935.73 toks/s, output: 1386.73 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 81/165 [00:43<00:41,  2.03it/s, est. speed input: 888.79 toks/s, output: 1408.14 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:48<00:25,  2.48it/s, est. speed input: 994.98 toks/s, output: 1745.09 toks/s][32m [repeated 44x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 107/165 [00:53<00:34,  1.69it/s, est. speed input: 954.03 toks/s, output: 1743.19 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 115/165 [00:58<00:26,  1.90it/s, est. speed input: 939.42 toks/s, output: 1820.63 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 125/165 [01:04<00:31,  1.29it/s, est. speed input: 928.72 toks/s, output: 1942.50 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:06<00:01, 11.82it/s, est. speed input: 1108.09 toks/s, output: 2649.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 11.82it/s, est. speed input: 1205.44 toks/s, output: 3049.16 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1205.44 toks/s, output: 3049.16 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00,  9.83it/s, est. speed input: 1184.33 toks/s, output: 3096.65 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00,  2.46it/s, est. speed input: 1184.33 toks/s, output: 3096.65 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:21:35 [executor_base.py:205] It took 0.365043 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:22:45 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:21:34 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:21:34 [gpu_worker.py:117] Sleep mode freed 62.02 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:21:34 [executor_base.py:189] It took 0.488056 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:22:46 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1114/1319 = 84.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:22:46 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 24 å®Œæˆ: å‡†ç¡®çŽ‡ 84.5% (1114/1319), è€—æ—¶ 140.4s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:22:46 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_24.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:22:46 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  27%|â–ˆâ–ˆâ–‹       | 24/89 [5:15:25<14:32:20, 805.24s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:22:46 [executor_base.py:205] It took 0.334027 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  17%|â–ˆâ–‹        | 11/64 [00:00<00:00, 108.25it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [00:00<00:00, 146.26it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:00<00:00, 147.81it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 163.59it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:00<00:00, 166.51it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 157.97it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 177.61it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:38<40:30,  9.65s/it, est. speed input: 9.33 toks/s, output: 72.58 toks/s][32m [repeated 17x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [01:06<00:00, 14.47it/s, est. speed input: 1174.47 toks/s, output: 3024.97 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 14.47it/s, est. speed input: 1197.51 toks/s, output: 3117.03 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.48it/s, est. speed input: 1197.51 toks/s, output: 3117.03 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.69it/s, est. speed input: 1181.01 toks/s, output: 3075.07 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1181.01 toks/s, output: 3075.07 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:00<00:00, 166.78it/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:00<00:00, 172.07it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 177.53it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:44<46:51, 11.16s/it, est. speed input: 10.13 toks/s, output: 72.54 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:44<20:17,  4.91s/it, est. speed input: 15.39 toks/s, output: 116.34 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:52<23:42,  5.74s/it, est. speed input: 16.57 toks/s, output: 141.89 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:58<1:01:29, 14.64s/it, est. speed input: 6.69 toks/s, output: 73.19 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:59<25:37,  6.20s/it, est. speed input: 12.26 toks/s, output: 132.77 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–         | 12/256 [01:05<20:09,  4.96s/it, est. speed input: 18.45 toks/s, output: 121.22 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:09<1:12:38, 17.30s/it, est. speed input: 6.53 toks/s, output: 65.27 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:15<33:04,  8.00s/it, est. speed input: 12.40 toks/s, output: 124.66 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:26<22:53,  5.63s/it, est. speed input: 16.48 toks/s, output: 178.31 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:33<10:52,  2.76s/it, est. speed input: 22.31 toks/s, output: 294.73 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:38<07:15,  1.95s/it, est. speed input: 33.15 toks/s, output: 377.32 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  9.13it/s, est. speed input: 325.83 toks/s, output: 4750.57 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.50it/s, est. speed input: 325.83 toks/s, output: 4750.57 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 148/256 [01:42<00:13,  8.02it/s, est. speed input: 179.49 toks/s, output: 2593.25 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  8.02it/s, est. speed input: 336.87 toks/s, output: 4720.81 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.49it/s, est. speed input: 336.87 toks/s, output: 4720.81 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:43<11:21,  2.94s/it, est. speed input: 25.22 toks/s, output: 318.51 toks/s][32m [repeated 8x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:22:46 [executor_base.py:205] It took 0.340923 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:24:30 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:22:45 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:22:45 [gpu_worker.py:117] Sleep mode freed 62.35 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:22:45 [executor_base.py:189] It took 0.458531 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:24:32 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:24:32 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:24:47 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.248, å¹³å‡æƒé‡=0.752
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:24:30 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:24:32 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:24:32 [gpu_worker.py:117] Sleep mode freed 62.53 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:24:32 [executor_base.py:189] It took 2.138234 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:25:03 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:25:03 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:25:04 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:25:04 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:25:04 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:25:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:25:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 15/128 å®Œæˆ (30/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 02:25:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 23/128 å®Œæˆ (46/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:25:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 34/128 å®Œæˆ (68/256 æ¡åºåˆ—)[32m [repeated 43x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:25:30 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 40/128 å®Œæˆ (80/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:25:35 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 48/128 å®Œæˆ (96/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:25:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 55/128 å®Œæˆ (110/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:25:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:25:51 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:25:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 80/128 å®Œæˆ (160/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:26:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 88/128 å®Œæˆ (176/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:26:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:26:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 109/128 å®Œæˆ (218/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:26:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 117/128 å®Œæˆ (234/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:26:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 124/128 å®Œæˆ (248/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:26:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 22x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:26:46 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:26:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:26:50 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:26:51 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:26:53 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:27:01 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 134.2s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:27:01 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:27:28 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:05 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4258)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4187)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3660)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3778)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3948)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3842)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:28:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3761)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:43 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3964)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4073)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3549)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3688)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3860)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3776)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:28:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3723)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:37 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3763)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3919)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3554)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3705)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3865)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3734)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:29:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3697)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:25 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4273)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4329)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3797)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3906)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4026)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3917)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3852)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3546)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:50 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3554)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:30:56 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3500)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:31:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3456)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:31:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3545)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:31:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3462)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:31:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3566)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:31:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3520)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:31:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3427)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:31:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3486)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:31:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3556)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:31:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3477)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:31:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3566)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:32:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3599)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:32:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3560)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:32:20 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 53/64 å®Œæˆ (212/256 æ¡æ ·æœ¬, loss=0.3516)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:32:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 56/64 å®Œæˆ (224/256 æ¡æ ·æœ¬, loss=0.3512)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:32:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3510)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:32:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3503)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:32:45 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.63e-06, è€—æ—¶ 279.5s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:32:55 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:32:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3616)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:32:45 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.63e-06, è€—æ—¶ 241.7s[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:32:56 [executor_base.py:205] It took 0.362963 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:32:56 [executor_base.py:205] It took 0.355903 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:32:56 [executor_base.py:205] It took 0.343502 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 481x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:33:24 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:33:24 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:33:24 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:33:24 [executor_base.py:189] It took 0.479844 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:33:24 vtd_trainer_ray.py:1123] æ­¥éª¤ 25: {'vtd_loss': 0.3524712648941204, 'distill_loss': 0.3524712648941204, 'avg_se_weight': 0.752455078125, 'actor_lr': 2.6286092760983696e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.247544921875, 'step_time': 638.5634651184082, 'phase1_generate_time': 106.73623323440552, 'phase2_collect_time': 134.20002436637878, 'phase3_train_time': 354.43378162384033} [é‡‡æ ·=106.7s æ”¶é›†=134.2s è®­ç»ƒ=354.4s æ€»è®¡=638.6s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:33:24 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 25, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:33:24 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:33:25 [executor_base.py:205] It took 0.321763 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.94s/it, est. speed input: 337.59 toks/s, output: 4789.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 337.59 toks/s, output: 4789.43 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:43<14:55,  3.80s/it, est. speed input: 19.68 toks/s, output: 252.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  3.80s/it, est. speed input: 331.10 toks/s, output: 4713.43 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 331.10 toks/s, output: 4713.43 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:33:25 [executor_base.py:205] It took 0.311046 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 57.22it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [00:01<00:00, 92.97it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:01<00:00, 89.80it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.52it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:10<28:44, 10.51s/it, est. speed input: 44.61 toks/s, output: 25.02 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [00:01<00:00, 85.75it/s][32m [repeated 54x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 87.33it/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:01<00:00, 90.60it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 87.45it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/165 [00:16<07:48,  2.91s/it, est. speed input: 112.89 toks/s, output: 90.10 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   8%|â–Š         | 14/165 [00:21<01:35,  1.57it/s, est. speed input: 305.28 toks/s, output: 304.15 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 35/165 [00:26<00:43,  3.01it/s, est. speed input: 620.49 toks/s, output: 692.64 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  30%|â–ˆâ–ˆâ–ˆ       | 50/165 [00:31<00:37,  3.07it/s, est. speed input: 751.00 toks/s, output: 966.03 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 58/165 [00:36<01:37,  1.10it/s, est. speed input: 737.37 toks/s, output: 993.41 toks/s] [32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 97/165 [00:42<00:39,  1.74it/s, est. speed input: 1075.83 toks/s, output: 1669.53 toks/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 108/165 [00:47<00:21,  2.59it/s, est. speed input: 1070.44 toks/s, output: 1794.81 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 97/165 [00:53<00:25,  2.70it/s, est. speed input: 867.52 toks/s, output: 1575.15 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 112/165 [00:58<00:35,  1.49it/s, est. speed input: 920.70 toks/s, output: 1744.83 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 106/165 [01:03<00:59,  1.00s/it, est. speed input: 799.80 toks/s, output: 1568.82 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 154/165 [01:05<00:01,  9.68it/s, est. speed input: 1118.66 toks/s, output: 2627.83 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  9.68it/s, est. speed input: 1199.44 toks/s, output: 2968.12 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.51it/s, est. speed input: 1199.44 toks/s, output: 2968.12 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:34:34 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:33:24 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:33:24 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:33:24 [executor_base.py:189] It took 0.461825 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:33:25 [executor_base.py:205] It took 0.320933 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:34:35 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 552/660 = 83.6%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:34:35 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 113/165 [01:07<00:20,  2.51it/s, est. speed input: 797.60 toks/s, output: 1672.36 toks/s][32m [repeated 16x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:34:35 [executor_base.py:205] It took 0.349571 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:01, 89.68it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.51it/s, est. speed input: 1177.85 toks/s, output: 3247.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1177.85 toks/s, output: 3247.78 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:03<00:00, 68.61it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 162/165 [00:03<00:00, 72.28it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.14it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:34, 12.28s/it, est. speed input: 38.42 toks/s, output: 28.17 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 142/164 [00:03<00:00, 63.57it/s][32m [repeated 71x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/164 [00:03<00:00, 70.84it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 75.82it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 43.64it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:12<33:37, 12.30s/it, est. speed input: 37.06 toks/s, output: 26.99 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   5%|â–Œ         | 9/165 [00:17<01:42,  1.52it/s, est. speed input: 238.46 toks/s, output: 224.64 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  14%|â–ˆâ–        | 23/165 [00:22<00:32,  4.35it/s, est. speed input: 473.30 toks/s, output: 526.83 toks/s][32m [repeated 34x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–Ž       | 39/165 [00:27<00:26,  4.81it/s, est. speed input: 664.24 toks/s, output: 838.78 toks/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 60/164 [00:33<00:58,  1.77it/s, est. speed input: 838.53 toks/s, output: 1182.49 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 81/165 [00:38<00:24,  3.39it/s, est. speed input: 988.77 toks/s, output: 1470.95 toks/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 90/164 [00:44<00:22,  3.36it/s, est. speed input: 965.07 toks/s, output: 1619.64 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 102/165 [00:49<00:34,  1.80it/s, est. speed input: 988.52 toks/s, output: 1762.27 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:54<00:47,  1.34it/s, est. speed input: 883.90 toks/s, output: 1632.65 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 110/165 [01:01<01:10,  1.28s/it, est. speed input: 861.62 toks/s, output: 1599.22 toks/s][32m [repeated 33x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 20.79it/s, est. speed input: 1226.58 toks/s, output: 3193.19 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 20.79it/s, est. speed input: 1226.58 toks/s, output: 3193.19 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.54it/s, est. speed input: 1226.58 toks/s, output: 3193.19 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 11.60it/s, est. speed input: 1226.39 toks/s, output: 3217.56 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.53it/s, est. speed input: 1226.39 toks/s, output: 3217.56 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 121/165 [01:06<00:22,  1.92it/s, est. speed input: 875.28 toks/s, output: 1880.14 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:35:45 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:34:35 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:34:35 [gpu_worker.py:117] Sleep mode freed 62.10 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:34:35 [executor_base.py:189] It took 0.495347 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:34:35 [executor_base.py:205] It took 0.349236 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:35:48 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1099/1319 = 83.3%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:35:48 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 25 å®Œæˆ: å‡†ç¡®çŽ‡ 83.3% (1099/1319), è€—æ—¶ 143.8s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:35:48 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_25.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:35:48 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  28%|â–ˆâ–ˆâ–Š       | 25/89 [5:28:27<14:11:37, 798.39s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:35:48 [executor_base.py:205] It took 0.367682 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  19%|â–ˆâ–‰        | 12/64 [00:00<00:00, 95.02it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 183.43it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:00<00:00, 149.43it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 158.35it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 172.79it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 167.53it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  1.92it/s, est. speed input: 1205.49 toks/s, output: 3239.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1205.49 toks/s, output: 3239.78 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:30<31:42,  7.55s/it, est. speed input: 12.45 toks/s, output: 68.15 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:00<00:00, 153.86it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:00<00:00, 168.21it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 170.27it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:30<31:51,  7.59s/it, est. speed input: 9.89 toks/s, output: 73.97 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:46<48:39, 11.58s/it, est. speed input: 6.82 toks/s, output: 62.97 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:46<48:49, 11.63s/it, est. speed input: 7.31 toks/s, output: 68.92 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:57<29:35,  7.16s/it, est. speed input: 9.62 toks/s, output: 115.93 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:03<30:12,  7.31s/it, est. speed input: 11.88 toks/s, output: 116.92 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:11<14:16,  3.57s/it, est. speed input: 19.26 toks/s, output: 218.55 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:16<07:09,  1.85s/it, est. speed input: 28.34 toks/s, output: 332.61 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:22<07:44,  2.00s/it, est. speed input: 29.30 toks/s, output: 317.83 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:31<17:58,  4.49s/it, est. speed input: 17.20 toks/s, output: 212.68 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:37<09:01,  2.37s/it, est. speed input: 29.33 toks/s, output: 361.87 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 140/256 [01:39<00:12,  9.37it/s, est. speed input: 169.77 toks/s, output: 2491.26 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:39<00:00,  9.37it/s, est. speed input: 323.72 toks/s, output: 4792.70 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:39<00:00,  2.58it/s, est. speed input: 323.72 toks/s, output: 4792.70 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 244/256 [01:40<00:01, 10.59it/s, est. speed input: 336.21 toks/s, output: 4655.63 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00, 10.59it/s, est. speed input: 349.83 toks/s, output: 4851.35 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  2.55it/s, est. speed input: 349.83 toks/s, output: 4851.35 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:42<07:43,  2.07s/it, est. speed input: 34.41 toks/s, output: 421.68 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:37:32 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:35:47 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:35:47 [gpu_worker.py:117] Sleep mode freed 62.42 GiB memory, 11.88 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:35:47 [executor_base.py:189] It took 2.119660 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:35:48 [executor_base.py:205] It took 0.343676 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.07s/it, est. speed input: 363.82 toks/s, output: 4691.38 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.49it/s, est. speed input: 363.82 toks/s, output: 4691.38 toks/s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:37:32 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:37:32 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:37:47 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.256, å¹³å‡æƒé‡=0.744
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:37:32 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:37:32 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:37:32 [gpu_worker.py:117] Sleep mode freed 62.46 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:37:32 [executor_base.py:189] It took 0.575102 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:38:03 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:38:05 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:38:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:38:06 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:38:06 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:38:11 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 10/128 å®Œæˆ (20/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:38:16 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 18/128 å®Œæˆ (36/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:38:21 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 25/128 å®Œæˆ (50/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:38:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:38:31 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 40/128 å®Œæˆ (80/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:38:36 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 49/128 å®Œæˆ (98/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:38:41 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:38:46 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:38:53 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 73/128 å®Œæˆ (146/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:38:58 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 83/128 å®Œæˆ (166/256 æ¡åºåˆ—)[32m [repeated 42x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:39:03 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 91/128 å®Œæˆ (182/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:39:08 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 98/128 å®Œæˆ (196/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:39:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 104/128 å®Œæˆ (208/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:39:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 114/128 å®Œæˆ (228/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:39:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 123/128 å®Œæˆ (246/256 æ¡åºåˆ—)[32m [repeated 37x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:39:46 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:39:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 19x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:39:50 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:39:51 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:39:55 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:40:02 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 135.5s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:40:02 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:40:30 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:05 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2349)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2952)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2994)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:10 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2923)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3073)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2952)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:41:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2834)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:42 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2816)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2999)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2922)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2812)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3119)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2999)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:41:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2872)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:34 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2683)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2997)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3030)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2893)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3162)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2988)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:42:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2859)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:25 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3019)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3367)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3208)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3128)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3261)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3095)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2986)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:43:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.2996)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3062)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:43:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3215)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:43:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3347)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:43:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.3338)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:44:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.3301)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:44:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.3240)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:44:16 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3333)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:44:23 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3342)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:44:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3438)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:44:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3471)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:44:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 35/64 å®Œæˆ (140/256 æ¡æ ·æœ¬, loss=0.3438)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:44:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3407)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:44:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 40/64 å®Œæˆ (160/256 æ¡æ ·æœ¬, loss=0.3422)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:44:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 43/64 å®Œæˆ (172/256 æ¡æ ·æœ¬, loss=0.3433)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:45:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3405)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:45:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3460)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:45:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3482)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:45:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3452)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:45:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3489)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:45:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3495)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:45:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3518)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:45:44 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.59e-06, è€—æ—¶ 279.3s
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:45:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3493)[32m [repeated 10x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:45:54 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:45:44 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.59e-06, è€—æ—¶ 241.9s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:45:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3462)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:45:54 [executor_base.py:205] It took 0.380643 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:45:54 [executor_base.py:205] It took 0.370725 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:45:54 [executor_base.py:205] It took 0.377717 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:46:23 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:46:23 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:46:23 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:46:23 [executor_base.py:189] It took 0.447154 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:46:23 vtd_trainer_ray.py:1123] æ­¥éª¤ 26: {'vtd_loss': 0.34930396149866283, 'distill_loss': 0.34930396149866283, 'avg_se_weight': 0.743899609375, 'actor_lr': 2.593472293692249e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.256100390625, 'step_time': 635.1721346378326, 'phase1_generate_time': 104.24356961250305, 'phase2_collect_time': 135.50747084617615, 'phase3_train_time': 351.7574369907379} [é‡‡æ ·=104.2s æ”¶é›†=135.5s è®­ç»ƒ=351.8s æ€»è®¡=635.2s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:46:23 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 26, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:46:23 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:46:24 [executor_base.py:205] It took 0.328910 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 160/256 [01:40<00:12,  7.81it/s, est. speed input: 220.18 toks/s, output: 2943.80 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  7.81it/s, est. speed input: 341.36 toks/s, output: 4793.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:40<00:00,  2.55it/s, est. speed input: 341.36 toks/s, output: 4793.87 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:46:24 [executor_base.py:205] It took 0.354752 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   5%|â–Œ         | 9/165 [00:00<00:02, 61.65it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:03<00:00, 34.33it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:03<00:00, 44.69it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.54it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:08<21:55,  8.02s/it, est. speed input: 55.59 toks/s, output: 28.79 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 146/165 [00:03<00:00, 33.11it/s][32m [repeated 71x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.02it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:03<00:00, 47.97it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 44.47it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:12<04:29,  1.68s/it, est. speed input: 176.05 toks/s, output: 124.55 toks/s][32m [repeated 10x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–        | 19/165 [00:18<00:38,  3.78it/s, est. speed input: 479.39 toks/s, output: 440.76 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  20%|â–ˆâ–ˆ        | 33/165 [00:23<00:37,  3.50it/s, est. speed input: 657.17 toks/s, output: 683.02 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 70/165 [00:28<00:15,  6.08it/s, est. speed input: 1159.07 toks/s, output: 1448.58 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 69/165 [00:33<00:34,  2.78it/s, est. speed input: 973.36 toks/s, output: 1376.67 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 88/165 [00:38<00:22,  3.48it/s, est. speed input: 1079.58 toks/s, output: 1692.97 toks/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 104/165 [00:43<00:28,  2.16it/s, est. speed input: 1129.29 toks/s, output: 1822.70 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:49<00:42,  1.48it/s, est. speed input: 996.75 toks/s, output: 1664.67 toks/s] [32m [repeated 27x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [00:54<00:27,  1.55it/s, est. speed input: 1079.15 toks/s, output: 1967.18 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [00:59<00:33,  1.12it/s, est. speed input: 1028.09 toks/s, output: 1947.98 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [01:02<00:01,  6.73it/s, est. speed input: 1189.63 toks/s, output: 2685.40 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:02<00:00,  6.73it/s, est. speed input: 1267.58 toks/s, output: 3013.37 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:02<00:00,  2.66it/s, est. speed input: 1267.58 toks/s, output: 3013.37 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [01:03<00:01,  8.38it/s, est. speed input: 1135.63 toks/s, output: 2750.62 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  8.38it/s, est. speed input: 1243.89 toks/s, output: 3197.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.58it/s, est. speed input: 1243.89 toks/s, output: 3197.31 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [01:04<00:20,  1.85it/s, est. speed input: 943.88 toks/s, output: 1909.57 toks/s][32m [repeated 14x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:47:32 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:46:23 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:46:23 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:46:23 [executor_base.py:189] It took 0.482927 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:46:24 [executor_base.py:205] It took 0.346729 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:47:33 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 549/660 = 83.2%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:47:33 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:47:33 [executor_base.py:205] It took 0.313977 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–         | 7/165 [00:00<00:02, 54.99it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  1.85it/s, est. speed input: 1234.09 toks/s, output: 3114.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.56it/s, est. speed input: 1234.09 toks/s, output: 3114.31 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/165 [00:03<00:00, 52.48it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 55.54it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:03<00:00, 43.60it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:09<25:46,  9.49s/it, est. speed input: 50.28 toks/s, output: 29.73 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 146/164 [00:03<00:00, 43.08it/s][32m [repeated 75x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:03<00:00, 43.66it/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 3/165 [00:14<09:24,  3.49s/it, est. speed input: 94.51 toks/s, output: 79.54 toks/s][32m [repeated 12x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  10%|â–‰         | 16/164 [00:20<01:30,  1.64it/s, est. speed input: 367.19 toks/s, output: 369.77 toks/s][32m [repeated 42x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–       | 40/165 [00:25<00:17,  7.14it/s, est. speed input: 748.95 toks/s, output: 916.09 toks/s][32m [repeated 65x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 63/165 [00:30<00:18,  5.46it/s, est. speed input: 982.30 toks/s, output: 1326.89 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 82/165 [00:35<00:16,  5.08it/s, est. speed input: 1101.26 toks/s, output: 1652.68 toks/s][32m [repeated 50x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 92/165 [00:40<01:03,  1.16it/s, est. speed input: 1070.68 toks/s, output: 1634.18 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 108/165 [00:45<00:25,  2.25it/s, est. speed input: 1119.93 toks/s, output: 1931.57 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 115/165 [00:51<00:32,  1.56it/s, est. speed input: 1071.12 toks/s, output: 1931.03 toks/s][32m [repeated 21x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 123/164 [00:56<00:18,  2.23it/s, est. speed input: 1040.09 toks/s, output: 2005.40 toks/s][32m [repeated 28x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 130/164 [01:01<00:42,  1.24s/it, est. speed input: 1005.45 toks/s, output: 2036.29 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:03<00:00,  6.88it/s, est. speed input: 1245.55 toks/s, output: 3079.30 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:03<00:00,  2.58it/s, est. speed input: 1245.55 toks/s, output: 3079.30 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 129/165 [01:04<00:15,  2.36it/s, est. speed input: 960.90 toks/s, output: 2019.97 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.36it/s, est. speed input: 1239.23 toks/s, output: 3163.37 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.56it/s, est. speed input: 1239.23 toks/s, output: 3163.37 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:48:41 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:47:32 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:47:32 [gpu_worker.py:117] Sleep mode freed 61.97 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:47:32 [executor_base.py:189] It took 0.490903 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:47:33 [executor_base.py:205] It took 0.317377 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:48:42 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1112/1319 = 84.3%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:48:42 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 26 å®Œæˆ: å‡†ç¡®çŽ‡ 84.3% (1112/1319), è€—æ—¶ 138.7s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:48:42 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_26.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:48:42 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  29%|â–ˆâ–ˆâ–‰       | 26/89 [5:41:21<13:50:36, 791.05s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:48:42 [executor_base.py:205] It took 0.342799 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  17%|â–ˆâ–‹        | 11/64 [00:00<00:00, 105.39it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [00:00<00:00, 131.66it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  30%|â–ˆâ–ˆâ–‰       | 19/64 [00:00<00:00, 128.45it/s]
Adding requests:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:00<00:00, 148.22it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:00<00:00, 160.56it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 163.18it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 150.55it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [00:32<33:51,  8.06s/it, est. speed input: 11.91 toks/s, output: 58.70 toks/s][32m [repeated 18x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  6.50it/s, est. speed input: 1246.60 toks/s, output: 3098.50 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.57it/s, est. speed input: 1246.60 toks/s, output: 3098.50 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:00<00:00, 158.34it/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:00<00:00, 162.27it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 169.46it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:38<40:42,  9.69s/it, est. speed input: 8.67 toks/s, output: 72.74 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [00:46<21:08,  5.11s/it, est. speed input: 14.31 toks/s, output: 118.98 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [00:51<04:52,  1.26s/it, est. speed input: 50.59 toks/s, output: 402.18 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [01:00<1:03:50, 15.20s/it, est. speed input: 7.50 toks/s, output: 61.96 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:08<31:53,  7.72s/it, est. speed input: 10.49 toks/s, output: 102.55 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   8%|â–Š         | 20/256 [01:14<09:39,  2.45s/it, est. speed input: 25.96 toks/s, output: 264.76 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 44/256 [01:21<05:21,  1.52s/it, est. speed input: 55.92 toks/s, output: 547.96 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:27<16:06,  4.03s/it, est. speed input: 20.87 toks/s, output: 201.70 toks/s][32m [repeated 5x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:34<09:30,  2.50s/it, est. speed input: 28.67 toks/s, output: 315.03 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 216/256 [01:37<00:04,  9.91it/s, est. speed input: 278.66 toks/s, output: 3791.27 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:37<00:00,  9.91it/s, est. speed input: 343.99 toks/s, output: 4572.04 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:37<00:00,  2.63it/s, est. speed input: 343.99 toks/s, output: 4572.04 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [01:40<05:53,  1.61s/it, est. speed input: 36.09 toks/s, output: 424.29 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  14%|â–ˆâ–        | 36/256 [01:42<04:05,  1.12s/it, est. speed input: 42.34 toks/s, output: 500.75 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  1.12s/it, est. speed input: 357.67 toks/s, output: 4725.27 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.50it/s, est. speed input: 357.67 toks/s, output: 4725.27 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:50:25 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:48:42 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:48:42 [gpu_worker.py:117] Sleep mode freed 62.23 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:48:42 [executor_base.py:189] It took 0.504641 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:48:42 [executor_base.py:205] It took 0.328677 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:50:26 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:50:26 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:50:40 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.262, å¹³å‡æƒé‡=0.738
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:50:25 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:50:26 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:50:26 [gpu_worker.py:117] Sleep mode freed 62.39 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:50:26 [executor_base.py:189] It took 0.482658 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:50:58 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:50:58 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:50:58 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:50:58 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:50:59 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:51:03 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 8/128 å®Œæˆ (16/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:51:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 16/128 å®Œæˆ (32/256 æ¡åºåˆ—)[32m [repeated 38x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:51:14 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 24/128 å®Œæˆ (48/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:51:19 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:51:24 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 38/128 å®Œæˆ (76/256 æ¡åºåˆ—)[32m [repeated 30x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:51:29 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 48/128 å®Œæˆ (96/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:51:34 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 57/128 å®Œæˆ (114/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:51:39 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 62/128 å®Œæˆ (124/256 æ¡åºåˆ—)[32m [repeated 25x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 02:51:45 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:51:50 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 80/128 å®Œæˆ (160/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:51:55 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 90/128 å®Œæˆ (180/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 02:52:00 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:52:06 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 103/128 å®Œæˆ (206/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 02:52:11 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 113/128 å®Œæˆ (226/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 02:52:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 123/128 å®Œæˆ (246/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 02:52:22 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:52:38 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:52:42 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:52:44 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:52:47 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:52:54 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 134.3s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:52:54 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:53:22 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:53:57 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:53:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4587)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:53:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4307)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:53:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4195)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:54:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4505)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:54:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4188)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:54:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4076)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:54:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4038)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:34 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4352)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3918)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3814)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4180)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3955)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3979)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:54:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3902)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:30 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.4190)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.4103)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.4035)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4353)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4125)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4082)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:55:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.4051)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:21 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3743)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3730)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3807)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.4196)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.4102)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.4022)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:56:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3893)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:56:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 9/64 å®Œæˆ (36/256 æ¡æ ·æœ¬, loss=0.3559)[32m [repeated 5x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:56:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 12/64 å®Œæˆ (48/256 æ¡æ ·æœ¬, loss=0.3264)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:56:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 15/64 å®Œæˆ (60/256 æ¡æ ·æœ¬, loss=0.3388)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:57:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 18/64 å®Œæˆ (72/256 æ¡æ ·æœ¬, loss=0.3445)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:57:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 21/64 å®Œæˆ (84/256 æ¡æ ·æœ¬, loss=0.3426)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:57:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.3368)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:57:17 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 26/64 å®Œæˆ (104/256 æ¡æ ·æœ¬, loss=0.3287)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:57:22 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3320)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:57:29 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 31/64 å®Œæˆ (124/256 æ¡æ ·æœ¬, loss=0.3287)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:57:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 34/64 å®Œæˆ (136/256 æ¡æ ·æœ¬, loss=0.3286)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:57:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 37/64 å®Œæˆ (148/256 æ¡æ ·æœ¬, loss=0.3328)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:57:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 39/64 å®Œæˆ (156/256 æ¡æ ·æœ¬, loss=0.3270)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:57:54 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 42/64 å®Œæˆ (168/256 æ¡æ ·æœ¬, loss=0.3321)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:58:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 46/64 å®Œæˆ (184/256 æ¡æ ·æœ¬, loss=0.3357)[32m [repeated 16x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:58:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3335)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:58:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3368)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 02:58:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 55/64 å®Œæˆ (220/256 æ¡æ ·æœ¬, loss=0.3416)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:58:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 58/64 å®Œæˆ (232/256 æ¡æ ·æœ¬, loss=0.3337)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:58:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 60/64 å®Œæˆ (240/256 æ¡æ ·æœ¬, loss=0.3312)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 02:58:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 62/64 å®Œæˆ (248/256 æ¡æ ·æœ¬, loss=0.3280)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:58:42 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.56e-06, è€—æ—¶ 285.8s
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 02:58:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3305)[32m [repeated 6x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:58:51 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:58:42 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.56e-06, è€—æ—¶ 248.8s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 02:58:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3299)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:58:52 [executor_base.py:205] It took 0.369520 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:58:52 [executor_base.py:205] It took 0.341007 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:58:52 [executor_base.py:205] It took 0.360640 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 483x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:59:20 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 02:59:21 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:59:21 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 02:59:21 [executor_base.py:189] It took 0.449217 seconds to fall asleep.
[36m(VtDStudentActor pid=843942)[0m Deleted oldest ckpt /anvil/scratch/x-qlan1/moule/checkpoint/qwen3-1.7b-vtd-ray-evolved/checkpoints/_actor/global_step18
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 02:59:21 vtd_trainer_ray.py:1123] æ­¥éª¤ 27: {'vtd_loss': 0.33048507128842175, 'distill_loss': 0.33048507128842175, 'avg_se_weight': 0.738337890625, 'actor_lr': 2.5570390285069644e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.261662109375, 'step_time': 638.6049189567566, 'phase1_generate_time': 103.74719953536987, 'phase2_collect_time': 134.27074074745178, 'phase3_train_time': 357.1392090320587} [é‡‡æ ·=103.7s æ”¶é›†=134.3s è®­ç»ƒ=357.1s æ€»è®¡=638.6s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:00:13 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 27, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:00:13 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 212x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 02:59:20 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:59:21 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:59:21 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 02:59:21 [executor_base.py:189] It took 0.495598 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:00:13 [executor_base.py:205] It took 0.294141 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:41<05:47,  1.55s/it, est. speed input: 34.54 toks/s, output: 423.29 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:00:13 [executor_base.py:205] It took 0.330852 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   6%|â–Œ         | 10/165 [00:00<00:01, 99.64it/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 151/165 [00:01<00:00, 89.71it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [00:01<00:00, 84.89it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 87.85it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:10<29:18, 10.72s/it, est. speed input: 43.09 toks/s, output: 25.18 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 143/165 [00:01<00:00, 86.52it/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.44it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 164/165 [00:01<00:00, 90.17it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.05it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:11<30:49, 11.27s/it, est. speed input: 39.56 toks/s, output: 25.72 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 5/165 [00:16<05:35,  2.10s/it, est. speed input: 142.11 toks/s, output: 113.22 toks/s][32m [repeated 19x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  19%|â–ˆâ–‰        | 31/165 [00:21<00:35,  3.73it/s, est. speed input: 676.84 toks/s, output: 686.06 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–Ž       | 39/165 [00:26<00:20,  6.04it/s, est. speed input: 692.01 toks/s, output: 819.14 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  31%|â–ˆâ–ˆâ–ˆ       | 51/165 [00:31<00:33,  3.36it/s, est. speed input: 764.06 toks/s, output: 983.50 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 72/165 [00:36<00:41,  2.23it/s, est. speed input: 931.91 toks/s, output: 1363.93 toks/s][32m [repeated 47x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 87/165 [00:41<00:21,  3.59it/s, est. speed input: 987.32 toks/s, output: 1537.46 toks/s][32m [repeated 52x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 98/165 [00:46<00:29,  2.24it/s, est. speed input: 997.91 toks/s, output: 1682.98 toks/s] [32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 112/165 [00:52<00:38,  1.39it/s, est. speed input: 1019.99 toks/s, output: 1787.74 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [00:58<00:45,  1.12it/s, est. speed input: 937.05 toks/s, output: 1767.16 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 127/165 [01:03<00:24,  1.56it/s, est. speed input: 954.06 toks/s, output: 1898.47 toks/s][32m [repeated 31x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 11.21it/s, est. speed input: 1215.23 toks/s, output: 3056.07 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.55it/s, est. speed input: 1215.23 toks/s, output: 3056.07 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:05<00:00, 16.19it/s, est. speed input: 1113.03 toks/s, output: 2699.93 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00, 16.19it/s, est. speed input: 1210.64 toks/s, output: 3103.91 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:05<00:00,  2.51it/s, est. speed input: 1210.64 toks/s, output: 3103.91 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:01:22 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 03:00:13 [executor_base.py:205] It took 0.349443 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:01:22 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:01:22 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:01:22 [gpu_worker.py:117] Sleep mode freed 62.18 GiB memory, 11.89 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:01:22 [executor_base.py:189] It took 0.460758 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:01:23 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 548/660 = 83.0%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:01:23 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:01:23 [executor_base.py:205] It took 0.344376 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842167)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:02, 56.25it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 125/165 [01:06<00:34,  1.16it/s, est. speed input: 898.99 toks/s, output: 1850.89 toks/s][32m [repeated 16x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 88.00it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 156/165 [00:01<00:00, 80.86it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.09it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  1.16it/s, est. speed input: 1197.26 toks/s, output: 3081.98 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.48it/s, est. speed input: 1197.26 toks/s, output: 3081.98 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 153/165 [01:06<00:01, 11.74it/s, est. speed input: 1116.81 toks/s, output: 2729.06 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 11.74it/s, est. speed input: 1205.55 toks/s, output: 3099.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1205.55 toks/s, output: 3099.87 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 148/164 [00:01<00:00, 82.02it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/164 [00:11<29:57, 11.03s/it, est. speed input: 43.25 toks/s, output: 25.39 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.93it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 159/164 [00:01<00:00, 84.65it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 84.28it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:17, 11.45s/it, est. speed input: 39.74 toks/s, output: 26.03 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/165 [00:16<06:49,  2.54s/it, est. speed input: 111.77 toks/s, output: 95.88 toks/s][32m [repeated 9x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   9%|â–‰         | 15/164 [00:21<01:01,  2.43it/s, est. speed input: 319.79 toks/s, output: 345.69 toks/s][32m [repeated 38x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  21%|â–ˆâ–ˆ        | 35/165 [00:26<00:24,  5.33it/s, est. speed input: 611.39 toks/s, output: 749.32 toks/s][32m [repeated 54x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  27%|â–ˆâ–ˆâ–‹       | 45/165 [00:31<00:51,  2.34it/s, est. speed input: 664.20 toks/s, output: 860.85 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 66/165 [00:36<00:50,  1.94it/s, est. speed input: 844.70 toks/s, output: 1245.03 toks/s][32m [repeated 45x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 82/165 [00:43<01:06,  1.25it/s, est. speed input: 900.22 toks/s, output: 1458.60 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 96/165 [00:48<00:22,  3.10it/s, est. speed input: 949.39 toks/s, output: 1679.27 toks/s][32m [repeated 43x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 103/165 [00:53<00:33,  1.86it/s, est. speed input: 918.94 toks/s, output: 1705.05 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 117/165 [00:58<00:25,  1.86it/s, est. speed input: 954.59 toks/s, output: 1797.41 toks/s][32m [repeated 29x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 122/165 [01:04<00:48,  1.14s/it, est. speed input: 913.09 toks/s, output: 1792.97 toks/s][32m [repeated 22x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 155/165 [01:06<00:00, 17.68it/s, est. speed input: 1131.95 toks/s, output: 2751.96 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 17.68it/s, est. speed input: 1207.97 toks/s, output: 3059.80 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1207.97 toks/s, output: 3059.80 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 144/165 [01:06<00:01, 16.06it/s, est. speed input: 1043.86 toks/s, output: 2560.94 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00, 16.06it/s, est. speed input: 1199.07 toks/s, output: 3206.88 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.49it/s, est. speed input: 1199.07 toks/s, output: 3206.88 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:01:23 [executor_base.py:205] It took 0.329531 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:02:32 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m INFO 02-22 03:01:22 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:01:22 [gpu_worker.py:117] Sleep mode freed 61.82 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:01:22 [executor_base.py:189] It took 0.481244 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:02:33 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1102/1319 = 83.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:02:33 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 27 å®Œæˆ: å‡†ç¡®çŽ‡ 83.5% (1102/1319), è€—æ—¶ 139.7s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:02:33 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_27.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:02:33 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  30%|â–ˆâ–ˆâ–ˆ       | 27/89 [5:55:12<13:49:44, 802.98s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:02:33 [executor_base.py:205] It took 0.296636 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [00:00<00:00, 136.50it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:00<00:00, 155.12it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 166.24it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:00<00:00, 164.33it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 162.32it/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 170.88it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:51<53:50, 12.82s/it, est. speed input: 7.49 toks/s, output: 68.60 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  1.96it/s, est. speed input: 1188.20 toks/s, output: 3178.67 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.46it/s, est. speed input: 1188.20 toks/s, output: 3178.67 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:00<00:00, 161.23it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:00<00:00, 168.67it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 167.12it/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   2%|â–         | 4/256 [00:57<1:00:04, 14.31s/it, est. speed input: 7.48 toks/s, output: 62.77 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:05<28:59,  7.01s/it, est. speed input: 16.06 toks/s, output: 131.48 toks/s] [32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:12<18:27,  4.54s/it, est. speed input: 16.71 toks/s, output: 173.80 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:19<13:48,  3.45s/it, est. speed input: 19.59 toks/s, output: 230.43 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:20<38:20,  9.28s/it, est. speed input: 16.98 toks/s, output: 126.18 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:26<17:13,  4.31s/it, est. speed input: 20.70 toks/s, output: 232.62 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:27<20:50,  5.21s/it, est. speed input: 17.47 toks/s, output: 192.66 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  12%|â–ˆâ–Ž        | 32/256 [01:33<04:50,  1.30s/it, est. speed input: 33.25 toks/s, output: 457.43 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:39<07:49,  2.02s/it, est. speed input: 31.72 toks/s, output: 354.66 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00,  6.22it/s, est. speed input: 316.85 toks/s, output: 4796.28 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:41<00:00,  2.51it/s, est. speed input: 316.85 toks/s, output: 4796.28 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 164/256 [01:43<00:09,  9.89it/s, est. speed input: 222.02 toks/s, output: 3067.03 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  9.89it/s, est. speed input: 341.54 toks/s, output: 4870.78 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 341.54 toks/s, output: 4870.78 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:02:33 [executor_base.py:205] It took 0.324474 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:04:17 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:02:32 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:02:32 [gpu_worker.py:117] Sleep mode freed 61.83 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:02:32 [executor_base.py:189] It took 0.448082 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:04:19 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:04:19 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:04:34 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.237, å¹³å‡æƒé‡=0.763
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:04:17 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:04:19 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:04:19 [gpu_worker.py:117] Sleep mode freed 62.64 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:04:19 [executor_base.py:189] It took 1.991985 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:04:50 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:04:50 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:04:51 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:04:51 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:04:52 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:04:56 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 25x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:05:01 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 13/128 å®Œæˆ (26/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:05:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 23/128 å®Œæˆ (46/256 æ¡åºåˆ—)[32m [repeated 34x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:05:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 33/128 å®Œæˆ (66/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:05:17 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 40/128 å®Œæˆ (80/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:05:22 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 47/128 å®Œæˆ (94/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:05:27 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 53/128 å®Œæˆ (106/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:05:33 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 63/128 å®Œæˆ (126/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:05:38 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 71/128 å®Œæˆ (142/256 æ¡åºåˆ—)[32m [repeated 31x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 03:05:43 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 77/128 å®Œæˆ (154/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:05:48 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 85/128 å®Œæˆ (170/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:05:53 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 95/128 å®Œæˆ (190/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:05:58 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 103/128 å®Œæˆ (206/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 03:06:03 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 109/128 å®Œæˆ (218/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:06:09 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 117/128 å®Œæˆ (234/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:06:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 127/128 å®Œæˆ (254/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:06:36 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:06:16 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 9x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:06:38 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:06:40 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:06:44 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:06:52 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 138.4s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:06:52 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:07:19 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:07:57 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:07:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3240)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:07:59 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3364)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:08:00 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3480)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:08:01 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3672)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:08:02 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3696)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:08:05 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3649)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:08:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3425)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:35 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3202)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3408)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3434)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3776)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3722)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3771)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:08:47 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3523)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:28 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3318)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3452)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3647)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3817)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3879)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3912)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:09:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3708)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:23 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:24 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.3749)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:26 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3598)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:27 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3566)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3866)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3902)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3979)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3715)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:10:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3486)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3705)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:10:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.3729)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:10:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.3614)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:10:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 17/64 å®Œæˆ (68/256 æ¡æ ·æœ¬, loss=0.3616)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:11:04 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 20/64 å®Œæˆ (80/256 æ¡æ ·æœ¬, loss=0.3459)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:11:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 23/64 å®Œæˆ (92/256 æ¡æ ·æœ¬, loss=0.3474)[32m [repeated 13x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:11:15 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 25/64 å®Œæˆ (100/256 æ¡æ ·æœ¬, loss=0.3417)[32m [repeated 7x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:11:21 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 28/64 å®Œæˆ (112/256 æ¡æ ·æœ¬, loss=0.3587)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:11:28 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 30/64 å®Œæˆ (120/256 æ¡æ ·æœ¬, loss=0.3467)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:11:34 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 33/64 å®Œæˆ (132/256 æ¡æ ·æœ¬, loss=0.3432)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:11:40 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 36/64 å®Œæˆ (144/256 æ¡æ ·æœ¬, loss=0.3435)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:11:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 38/64 å®Œæˆ (152/256 æ¡æ ·æœ¬, loss=0.3370)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:11:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 41/64 å®Œæˆ (164/256 æ¡æ ·æœ¬, loss=0.3394)[32m [repeated 9x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:11:57 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 44/64 å®Œæˆ (176/256 æ¡æ ·æœ¬, loss=0.3321)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:12:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 47/64 å®Œæˆ (188/256 æ¡æ ·æœ¬, loss=0.3447)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:12:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 49/64 å®Œæˆ (196/256 æ¡æ ·æœ¬, loss=0.3520)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:12:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 52/64 å®Œæˆ (208/256 æ¡æ ·æœ¬, loss=0.3470)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:12:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 54/64 å®Œæˆ (216/256 æ¡æ ·æœ¬, loss=0.3474)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:12:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 57/64 å®Œæˆ (228/256 æ¡æ ·æœ¬, loss=0.3566)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:12:30 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 59/64 å®Œæˆ (236/256 æ¡æ ·æœ¬, loss=0.3574)[32m [repeated 6x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:12:35 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 61/64 å®Œæˆ (244/256 æ¡æ ·æœ¬, loss=0.3510)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:12:42 vtd_actor.py:330] [è®­ç»ƒ rank=0] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.52e-06, è€—æ—¶ 285.1s
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:12:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3552)[32m [repeated 10x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:12:51 vtd_trainer_ray.py:1101] ========== é˜¶æ®µ4: åŒæ­¥æƒé‡åˆ° vLLM ==========
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:12:42 vtd_actor.py:330] [è®­ç»ƒ rank=1] å®Œæˆ: å…± 64 æ­¥, 8 æ¬¡æƒé‡æ›´æ–° (ç´¯ç§¯=8), lr=2.52e-06, è€—æ—¶ 247.0s[32m [repeated 3x across cluster][0m
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:12:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 64/64 å®Œæˆ (256/256 æ¡æ ·æœ¬, loss=0.3518)[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:12:51 [executor_base.py:205] It took 0.360498 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:12:51 [executor_base.py:205] It took 0.329441 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.0.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.1.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.2.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.3.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.q_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.self_attn.k_norm.weight, dtype: torch.bfloat16, shape: [128]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.gate_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.up_proj.weight, dtype: torch.bfloat16, shape: [6144, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.4.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.q_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.k_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.v_proj.weight, dtype: torch.bfloat16, shape: [1024, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.5.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:12:51 [executor_base.py:205] It took 0.350392 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m 
[36m(LLMRayActor pid=842167)[0m [1;36m(EngineCore_DP0 pid=842697)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m 
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.embed_tokens.weight, dtype: torch.bfloat16, shape: [151936, 2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.10.input_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 238x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.16.self_attn.o_proj.weight, dtype: torch.bfloat16, shape: [2048, 2048][32m [repeated 243x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.21.mlp.down_proj.weight, dtype: torch.bfloat16, shape: [2048, 6144][32m [repeated 240x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:13:21 [block_pool.py:378] Successfully reset prefix cache
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 428x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
[36m(LLMRayActor pid=842167)[0m 
[36m(LLMRayActor pid=842166)[0m 
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:13:22 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:13:22 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.89 GiB memory is still in use.
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:13:22 [executor_base.py:189] It took 0.963680 seconds to fall asleep.
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:13:22 vtd_trainer_ray.py:1123] æ­¥éª¤ 28: {'vtd_loss': 0.3552368644159287, 'distill_loss': 0.3552368644159287, 'avg_se_weight': 0.76290078125, 'actor_lr': 2.5193595379894205e-06, 'n_distill_steps': 64, 'n_weight_updates': 8, 'accuracy': 0.0, 'num_responses': 1024, 'num_distill_items': 1024, 'avg_semantic_entropy': 0.23709921875, 'step_time': 649.3905920982361, 'phase1_generate_time': 106.60046148300171, 'phase2_collect_time': 138.35976839065552, 'phase3_train_time': 359.12154150009155} [é‡‡æ ·=106.6s æ”¶é›†=138.4s è®­ç»ƒ=359.1s æ€»è®¡=649.4s]
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:13:22 vtd_trainer_ray.py:1190] ========== å¼€å§‹è´ªå¿ƒè¯„ä¼° [gsm8k] (æ­¥éª¤ 28, å…± 2 ä¸ªæ‰¹æ¬¡, max_tokens=2048) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:13:22 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 â€” æ­£åœ¨ç”Ÿæˆ 660 ä¸ªæç¤º...
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:13:23 [executor_base.py:205] It took 0.370968 seconds to wake up tags {'kv_cache', 'weights'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  11%|â–ˆ         | 28/256 [01:43<08:57,  2.36s/it, est. speed input: 27.57 toks/s, output: 317.70 toks/s][32m [repeated 6x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.36s/it, est. speed input: 333.02 toks/s, output: 4654.11 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.47it/s, est. speed input: 333.02 toks/s, output: 4654.11 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 160/256 [01:43<00:16,  5.75it/s, est. speed input: 204.75 toks/s, output: 2975.23 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  5.75it/s, est. speed input: 340.19 toks/s, output: 4814.31 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 340.19 toks/s, output: 4814.31 toks/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:13:23 [executor_base.py:205] It took 0.351176 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   4%|â–Ž         | 6/165 [00:00<00:03, 45.03it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  22%|â–ˆâ–ˆâ–       | 37/165 [00:00<00:01, 77.28it/s]
Adding requests:  30%|â–ˆâ–ˆâ–‰       | 49/165 [00:00<00:01, 90.51it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:01<00:00, 90.53it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:01<00:00, 90.43it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 86.97it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:22, 11.48s/it, est. speed input: 38.86 toks/s, output: 25.45 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [00:01<00:00, 84.00it/s][32m [repeated 55x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.18it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 158/165 [00:01<00:00, 83.70it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 83.54it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:40, 11.59s/it, est. speed input: 39.86 toks/s, output: 25.80 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  10%|â–‰         | 16/165 [00:16<01:04,  2.30it/s, est. speed input: 443.39 toks/s, output: 372.81 toks/s][32m [repeated 39x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  17%|â–ˆâ–‹        | 28/165 [00:22<00:41,  3.31it/s, est. speed input: 593.62 toks/s, output: 596.93 toks/s][32m [repeated 51x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  24%|â–ˆâ–ˆâ–Ž       | 39/165 [00:27<00:46,  2.69it/s, est. speed input: 664.39 toks/s, output: 733.08 toks/s][32m [repeated 41x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 71/165 [00:32<00:54,  1.74it/s, est. speed input: 1027.88 toks/s, output: 1321.51 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 85/165 [00:37<00:28,  2.81it/s, est. speed input: 1062.18 toks/s, output: 1506.24 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 92/165 [00:42<00:22,  3.29it/s, est. speed input: 1029.77 toks/s, output: 1639.26 toks/s][32m [repeated 48x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 101/165 [00:47<00:41,  1.55it/s, est. speed input: 1012.93 toks/s, output: 1705.04 toks/s][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 109/165 [00:53<00:55,  1.01it/s, est. speed input: 984.11 toks/s, output: 1758.26 toks/s] [32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [00:58<00:30,  1.49it/s, est. speed input: 976.62 toks/s, output: 1877.39 toks/s][32m [repeated 25x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 114/165 [01:03<00:43,  1.17it/s, est. speed input: 855.85 toks/s, output: 1645.48 toks/s][32m [repeated 20x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  7.71it/s, est. speed input: 1243.78 toks/s, output: 3079.22 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.57it/s, est. speed input: 1243.78 toks/s, output: 3079.22 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [01:04<00:00, 23.40it/s, est. speed input: 1195.91 toks/s, output: 2949.47 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00, 23.40it/s, est. speed input: 1225.64 toks/s, output: 3076.72 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.57it/s, est. speed input: 1225.64 toks/s, output: 3076.72 toks/s]
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.norm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:14:32 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m update weight: model.layers.27.post_attention_layernorm.weight, dtype: torch.bfloat16, shape: [2048][32m [repeated 24x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:13:22 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:13:22 [gpu_worker.py:117] Sleep mode freed 61.20 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:13:22 [executor_base.py:189] It took 0.942146 seconds to fall asleep.[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:13:23 [executor_base.py:205] It took 0.357587 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 2x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:14:33 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 1/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 547/660 = 82.9%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:14:33 vtd_trainer_ray.py:1196] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 â€” æ­£åœ¨ç”Ÿæˆ 659 ä¸ªæç¤º...
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:14:33 [executor_base.py:205] It took 0.337018 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/165 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   3%|â–Ž         | 5/165 [00:00<00:03, 49.67it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 119/165 [01:06<00:43,  1.05it/s, est. speed input: 848.98 toks/s, output: 1706.57 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  8.23it/s, est. speed input: 1232.75 toks/s, output: 3148.74 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:04<00:00,  2.55it/s, est. speed input: 1232.75 toks/s, output: 3148.74 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [01:07<00:00, 13.36it/s, est. speed input: 1091.42 toks/s, output: 2711.55 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00, 13.36it/s, est. speed input: 1185.42 toks/s, output: 3107.87 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.46it/s, est. speed input: 1185.42 toks/s, output: 3107.87 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 152/165 [00:01<00:00, 86.37it/s]
[36m(LLMRayActor pid=842168)[0m 
Adding requests:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 160/165 [00:01<00:00, 86.70it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 85.84it/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   0%|          | 0/165 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/164 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 146/164 [00:01<00:00, 88.81it/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   1%|          | 1/165 [00:11<31:40, 11.59s/it, est. speed input: 39.36 toks/s, output: 25.12 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [00:01<00:00, 83.54it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 161/165 [00:01<00:00, 84.66it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [00:01<00:00, 84.87it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/164 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   1%|          | 1/165 [00:11<32:22, 11.85s/it, est. speed input: 38.41 toks/s, output: 25.16 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   1%|          | 2/164 [00:16<20:57,  7.77s/it, est. speed input: 55.15 toks/s, output: 44.71 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  15%|â–ˆâ–        | 24/165 [00:21<00:54,  2.59it/s, est. speed input: 512.02 toks/s, output: 507.55 toks/s][32m [repeated 53x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  22%|â–ˆâ–ˆâ–       | 36/165 [00:27<00:21,  6.03it/s, est. speed input: 623.88 toks/s, output: 724.24 toks/s][32m [repeated 56x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 65/165 [00:32<00:27,  3.62it/s, est. speed input: 960.09 toks/s, output: 1236.36 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 74/165 [00:37<00:58,  1.55it/s, est. speed input: 924.33 toks/s, output: 1348.43 toks/s][32m [repeated 49x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 96/164 [00:43<00:23,  2.84it/s, est. speed input: 1055.44 toks/s, output: 1755.74 toks/s][32m [repeated 46x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 102/165 [00:48<00:36,  1.75it/s, est. speed input: 1004.86 toks/s, output: 1735.42 toks/s][32m [repeated 37x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 107/165 [00:53<00:39,  1.45it/s, est. speed input: 956.69 toks/s, output: 1622.37 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 108/165 [00:58<00:55,  1.03it/s, est. speed input: 875.29 toks/s, output: 1638.56 toks/s][32m [repeated 23x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 115/165 [01:05<01:04,  1.29s/it, est. speed input: 836.17 toks/s, output: 1658.37 toks/s][32m [repeated 26x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 149/165 [01:06<00:01,  8.86it/s, est. speed input: 1090.12 toks/s, output: 2537.74 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  8.86it/s, est. speed input: 1210.50 toks/s, output: 3031.44 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:06<00:00,  2.50it/s, est. speed input: 1210.50 toks/s, output: 3031.44 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 152/164 [01:06<00:00, 13.36it/s, est. speed input: 1104.71 toks/s, output: 2680.48 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00, 13.36it/s, est. speed input: 1195.89 toks/s, output: 3050.18 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 164/164 [01:06<00:00,  2.48it/s, est. speed input: 1195.89 toks/s, output: 3050.18 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:15:42 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:14:32 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:14:32 [gpu_worker.py:117] Sleep mode freed 62.06 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:14:32 [executor_base.py:189] It took 0.474591 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:14:33 [executor_base.py:205] It took 0.320968 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:15:43 vtd_trainer_ray.py:1212] [è¯„ä¼°-gsm8k] æ‰¹æ¬¡ 2/2 å®Œæˆ â€” å½“å‰å‡†ç¡®çŽ‡: 1101/1319 = 83.5%
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:15:43 vtd_trainer_ray.py:1217] [è¯„ä¼°-gsm8k] æ­¥éª¤ 28 å®Œæˆ: å‡†ç¡®çŽ‡ 83.5% (1101/1319), è€—æ—¶ 140.9s
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:15:43 vtd_trainer_ray.py:1244] [è¯„ä¼°-gsm8k] ç»“æžœå·²ä¿å­˜åˆ° /home/x-qlan1/code/moule2/eval_results/gsm8k/eval_step_28.txt
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:15:43 vtd_trainer_ray.py:848] ========== é˜¶æ®µ1: å­¦ç”Ÿæ¨¡åž‹é‡‡æ ·ç”Ÿæˆ ==========
[36m(VtDRayTrainer pid=845750)[0m 
Episode [1/1]:  31%|â–ˆâ–ˆâ–ˆâ–      | 28/89 [6:08:22<13:32:29, 799.17s/it]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s]
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:15:43 [executor_base.py:205] It took 0.364881 seconds to wake up tags {'weights', 'kv_cache'}.
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  16%|â–ˆâ–Œ        | 10/64 [00:00<00:00, 98.19it/s]
[36m(LLMRayActor pid=842165)[0m 
Adding requests:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:00<00:00, 170.16it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 165.62it/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]
[36m(LLMRayActor pid=842166)[0m 
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 189.37it/s]
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   2%|â–         | 4/256 [00:40<42:01, 10.01s/it, est. speed input: 7.59 toks/s, output: 73.27 toks/s][32m [repeated 11x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 118/165 [01:07<00:40,  1.16it/s, est. speed input: 834.13 toks/s, output: 1698.96 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  1.16it/s, est. speed input: 1180.48 toks/s, output: 3121.53 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 165/165 [01:07<00:00,  2.44it/s, est. speed input: 1180.48 toks/s, output: 3121.53 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:   0%|          | 0/64 [00:00<?, ?it/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Adding requests:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [00:00<00:00, 170.47it/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Adding requests:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:00<00:00, 162.68it/s]
Adding requests: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:00<00:00, 162.56it/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   2%|â–         | 4/256 [00:52<54:58, 13.09s/it, est. speed input: 6.42 toks/s, output: 62.33 toks/s]
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:00<27:15,  6.60s/it, est. speed input: 15.52 toks/s, output: 115.71 toks/s]
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   2%|â–         | 4/256 [01:05<1:09:13, 16.48s/it, est. speed input: 5.58 toks/s, output: 65.13 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842166)[0m 
Processed prompts:   3%|â–Ž         | 8/256 [01:13<37:19,  9.03s/it, est. speed input: 8.94 toks/s, output: 105.69 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842168)[0m 
Processed prompts:   6%|â–‹         | 16/256 [01:19<15:13,  3.81s/it, est. speed input: 21.50 toks/s, output: 215.12 toks/s][32m [repeated 2x across cluster][0m
[36m(LLMRayActor pid=842167)[0m 
Processed prompts:   5%|â–         | 12/256 [01:26<22:53,  5.63s/it, est. speed input: 15.20 toks/s, output: 169.63 toks/s][32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:   9%|â–‰         | 24/256 [01:40<10:04,  2.60s/it, est. speed input: 23.22 toks/s, output: 317.17 toks/s][32m [repeated 7x across cluster][0m
[36m(LLMRayActor pid=842165)[0m 
Processed prompts:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 136/256 [01:42<00:17,  6.87it/s, est. speed input: 176.04 toks/s, output: 2468.32 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  6.87it/s, est. speed input: 332.03 toks/s, output: 4756.34 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:42<00:00,  2.49it/s, est. speed input: 332.03 toks/s, output: 4756.34 toks/s]
[36m(LLMRayActor pid=842167)[0m 
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  3.65it/s, est. speed input: 361.75 toks/s, output: 4760.14 toks/s]
Processed prompts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 256/256 [01:43<00:00,  2.48it/s, est. speed input: 361.75 toks/s, output: 4760.14 toks/s]
[36m(LLMRayActor pid=842165)[0m [1;36m(EngineCore_DP0 pid=842698)[0;0m INFO 02-22 03:17:28 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:15:43 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:15:43 [gpu_worker.py:117] Sleep mode freed 62.26 GiB memory, 12.19 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842168)[0m [1;36m(EngineCore_DP0 pid=842699)[0;0m INFO 02-22 03:15:43 [executor_base.py:189] It took 0.486249 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:15:43 [executor_base.py:205] It took 0.354904 seconds to wake up tags {'kv_cache', 'weights'}.[32m [repeated 3x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:17:29 vtd_trainer_ray.py:860] [é‡‡æ ·] 256 ä¸ªæç¤º, å…± 1024 æ¡å›žå¤ (è·³è¿‡éªŒè¯, å…¨éƒ¨è’¸é¦)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:17:29 vtd_trainer_ray.py:878] ========== é˜¶æ®µ2: æ•™å¸ˆè¯­ä¹‰ç†µé‡‡æ · + logitsæ”¶é›† ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:17:43 vtd_trainer_ray.py:893] [é˜¶æ®µ2] è¯­ä¹‰ç†µ (é¢„è®¡ç®—): å¹³å‡ SE=0.281, å¹³å‡æƒé‡=0.719
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:17:28 [block_pool.py:378] Successfully reset prefix cache[32m [repeated 3x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:17:29 [cumem.py:228] CuMemAllocator: sleep freed 61.20 GiB memory in total, of which 3.29 GiB is backed up in CPU and the rest 57.92 GiB is discarded directly.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:17:29 [gpu_worker.py:117] Sleep mode freed 62.48 GiB memory, 11.89 GiB memory is still in use.[32m [repeated 4x across cluster][0m
[36m(LLMRayActor pid=842166)[0m [1;36m(EngineCore_DP0 pid=842704)[0;0m INFO 02-22 03:17:29 [executor_base.py:189] It took 0.482135 seconds to fall asleep.[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:18:01 vtd_trainer_ray.py:965] [é˜¶æ®µ2] æ”¶é›†åˆ° 1024 æ¡åºåˆ—, å‡†å¤‡æ‰¹é‡æ•™å¸ˆå‰å‘ (answer-aware)
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:18:01 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:18:02 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 1/128 å®Œæˆ (2/256 æ¡åºåˆ—)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:18:02 vtd_trainer_ray.py:991] [é˜¶æ®µ2] æ•™å¸ˆæ‰¹é‡å‰å‘: 1024 æ¡åºåˆ—, åˆ†å‘åˆ° 4/4 ä¸ªGPU
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:18:02 vtd_actor.py:665] [æ•™å¸ˆå‰å‘] å…± 256 æ¡åºåˆ—, micro_batch_size=2, topk=512, å…± 128 ä¸ªå¾®æ‰¹æ¬¡[32m [repeated 3x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 03:18:07 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 7/128 å®Œæˆ (14/256 æ¡åºåˆ—)[32m [repeated 26x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 03:18:12 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 14/128 å®Œæˆ (28/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:18:18 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 24/128 å®Œæˆ (48/256 æ¡åºåˆ—)[32m [repeated 39x across cluster][0m
[36m(VtDTeacherActor pid=845748)[0m INFO 02-22 03:18:23 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 32/128 å®Œæˆ (64/256 æ¡åºåˆ—)[32m [repeated 32x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:18:28 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 39/128 å®Œæˆ (78/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:18:33 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 46/128 å®Œæˆ (92/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:18:39 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 56/128 å®Œæˆ (112/256 æ¡åºåˆ—)[32m [repeated 40x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:18:44 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 65/128 å®Œæˆ (130/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:18:49 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 72/128 å®Œæˆ (144/256 æ¡åºåˆ—)[32m [repeated 27x across cluster][0m
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:18:54 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 78/128 å®Œæˆ (156/256 æ¡åºåˆ—)[32m [repeated 29x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:18:59 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 88/128 å®Œæˆ (176/256 æ¡åºåˆ—)[32m [repeated 36x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:19:05 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 97/128 å®Œæˆ (194/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:19:10 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 104/128 å®Œæˆ (208/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=845751)[0m INFO 02-22 03:19:15 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 111/128 å®Œæˆ (222/256 æ¡åºåˆ—)[32m [repeated 28x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:19:20 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 119/128 å®Œæˆ (238/256 æ¡åºåˆ—)[32m [repeated 33x across cluster][0m
[36m(VtDTeacherActor pid=844393)[0m INFO 02-22 03:19:25 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 35x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:19:45 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 0 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDTeacherActor pid=845749)[0m INFO 02-22 03:19:26 vtd_actor.py:702] [æ•™å¸ˆå‰å‘] å¾®æ‰¹æ¬¡ 128/128 å®Œæˆ (256/256 æ¡åºåˆ—)[32m [repeated 4x across cluster][0m
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:19:48 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 1 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:19:50 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 2 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:19:52 vtd_trainer_ray.py:1001] [é˜¶æ®µ2] æ•™å¸ˆGPU 3 å®Œæˆ: 256 æ¡åºåˆ—
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:20:00 vtd_trainer_ray.py:1055] [é˜¶æ®µ2] å®Œæˆ: 1024 æ¡è’¸é¦æ ·æœ¬ (SEåŠ æƒ), å…± 256 ä¸ªæç¤º (è€—æ—¶ 136.9s)
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:20:00 vtd_trainer_ray.py:1061] ========== é˜¶æ®µ3: å­¦ç”Ÿæ¨¡åž‹è®­ç»ƒ (SEåŠ æƒè’¸é¦) ==========
[36m(VtDRayTrainer pid=845750)[0m INFO 02-22 03:20:28 vtd_trainer_ray.py:1083] [é˜¶æ®µ3] è’¸é¦æ ·æœ¬=1024 (æœ‰æ•ˆ 1024), world_size=4
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:05 vtd_actor.py:235] [vtd_train rank=0/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:06 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.1733)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:07 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2282)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2354)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:09 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2694)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:11 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2545)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:12 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2873)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:21:13 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2857)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:42 vtd_actor.py:235] [vtd_train rank=1/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2390)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:46 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.3231)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.3124)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3319)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:52 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.3039)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:53 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.3234)
[36m(VtDStudentActor pid=844394)[0m INFO 02-22 03:21:55 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=1] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3209)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:35 vtd_actor.py:235] [vtd_train rank=2/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.2043)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:38 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2380)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:41 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2541)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:43 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.2826)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2644)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:48 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2889)
[36m(VtDStudentActor pid=844392)[0m INFO 02-22 03:22:49 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=2] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.2927)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:30 vtd_actor.py:235] [vtd_train rank=3/4] distill=256/256 micro_bs=4 accum_steps=8
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:31 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 1/64 å®Œæˆ (4/256 æ¡æ ·æœ¬, loss=0.1976)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:33 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 2/64 å®Œæˆ (8/256 æ¡æ ·æœ¬, loss=0.2578)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:36 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 3/64 å®Œæˆ (12/256 æ¡æ ·æœ¬, loss=0.2719)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:37 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 4/64 å®Œæˆ (16/256 æ¡æ ·æœ¬, loss=0.3013)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 5/64 å®Œæˆ (20/256 æ¡æ ·æœ¬, loss=0.2768)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:42 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 6/64 å®Œæˆ (24/256 æ¡æ ·æœ¬, loss=0.2996)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:44 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 7/64 å®Œæˆ (28/256 æ¡æ ·æœ¬, loss=0.3023)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:23:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3002)
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:23:45 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 8/64 å®Œæˆ (32/256 æ¡æ ·æœ¬, loss=0.3141)
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:23:51 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 11/64 å®Œæˆ (44/256 æ¡æ ·æœ¬, loss=0.2918)[32m [repeated 11x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:23:58 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 14/64 å®Œæˆ (56/256 æ¡æ ·æœ¬, loss=0.2919)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:24:03 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 16/64 å®Œæˆ (64/256 æ¡æ ·æœ¬, loss=0.2841)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:24:08 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 19/64 å®Œæˆ (76/256 æ¡æ ·æœ¬, loss=0.2898)[32m [repeated 14x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:24:14 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 22/64 å®Œæˆ (88/256 æ¡æ ·æœ¬, loss=0.2901)[32m [repeated 10x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:24:19 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 24/64 å®Œæˆ (96/256 æ¡æ ·æœ¬, loss=0.2931)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:24:25 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 27/64 å®Œæˆ (108/256 æ¡æ ·æœ¬, loss=0.3080)[32m [repeated 12x across cluster][0m
[36m(VtDStudentActor pid=844391)[0m INFO 02-22 03:24:32 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=3] å¾®æ‰¹æ¬¡ 29/64 å®Œæˆ (116/256 æ¡æ ·æœ¬, loss=0.3105)[32m [repeated 8x across cluster][0m
[36m(VtDStudentActor pid=843942)[0m INFO 02-22 03:24:39 vtd_actor.py:315] [è’¸é¦è®­ç»ƒ rank=0] å¾®æ‰¹æ¬¡ 32/64 å®Œæˆ (128/256 æ¡æ ·æœ¬, loss=0.3047)[32m [repeated 12x across cluster][0m
[2026-02-22T03:54:40.009] error: *** JOB 15374522 ON h010 CANCELLED AT 2026-02-22T03:54:40 DUE TO TIME LIMIT ***
